<!doctype html><html><head><title>aemp dev</title><link rel="stylesheet" href="/css/ct.css"><link rel="stylesheet" href="/css/aemp.css"> <script>var CT={"_":{"extReqs":{},"scriptImportCb":{},"onImport":function(a){CT._.scriptImportCb[a].forEach(function(a){a();});},"triggerOnload":function(a){(a||window)._ct_onload.forEach(function(a){a();});}},"info":{"page":location.pathname.slice(1,-5),"userAgent":navigator.userAgent||navigator.vendor||window.opera},"net":{"_path":"","_mode":"ct","_cache":false,"_encode":true,"_spinner":false,"_encoder":function(a){return a;},"_decoder":function(a){return a;},"_silentFail":true,"setMode":function(a){if(a!="ct"&&a!="basic"&&a!="passthrough"){CT.log("CT.net.setMode() - illegal mode specified: "+a);CT.log("mode must be one of: 'ct', 'basic', 'passthrough'");}else CT.net._mode=a;},"setSilentFail":function(a){CT.net._silentFail=a;},"setSpinner":function(a){CT.net._spinner=a;},"setCache":function(a){CT.net._cache=a;},"setEncoder":function(a){CT.net._encoder=a;},"setDecoder":function(a){CT.net._decoder=a;},"fullPath":function(a){if(!CT.net._path){var b=document.getElementsByTagName("script");for(var c=0;c<b.length;c++)if(b[c].src.slice(-8)=="CT/ct.js"){CT.net._path=b[c].src.replace("CT/ct.js","");break;}}return CT.net._path+a;},"xhr":function(a,b,c,d,e,f){var g=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");g.open(b,a,d);if(!(f&&"Content-Type" in f))g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var h in f)g.setRequestHeader(h,f[h]);g.onreadystatechange=e&&function(){e(g);};if(c){if(CT.net._mode!="passthrough"){if(CT.net._mode=="ct")c=CT.net._rd(c,true);c=JSON.stringify(c);}if(CT.net._encode)c=CT.net._encoder(c);}g.send(c);if(!d)return g.responseText;},"_fallback_error":function(a){if(CT.net._silentFail)CT.log(a);else alert(a);},"_u2l":function(a){return encodeURIComponent(a);},"_l2u":function(a){return decodeURIComponent(a);},"_rd":function(a,b){if(a){if(typeof a=="string")return CT.net[(b?"_u2l":"_l2u")](a);if(typeof a=="object"){var c,d=Array.isArray(a)?[]:{};for(c in a)d[c]=CT.net._rd(a[c],b);return d;}}return a;},"_ctsuccess":function(a,b,c){var d=JSON.parse(a);if(c)d=CT.net._rd(d);if(CT.net._cache)CT.storage.set(b,d);return d;},"_ctresponse":function(a,b){if(CT.net._encode)a=CT.net._decoder(a);var c=a.charAt(0),d={success:!!(c%2)};a=a.slice(1);if(c=="2")d.data=atob(a);else d.data=CT.net._ctsuccess(a,b,c=="3");return d;},"post":function(a,b,c,d,e,f,g,h){var i=a+JSON.stringify(b);if(CT.net._cache){var j=CT.storage.get(i);if(j)return d(j,g);}d=d||function(){};e=e||function(a){CT.net._fallback_error((c||"error")+": "+a);};if(CT.net._spinner){CT.net._spinner_node=CT.net._spinner_node||CT.dom.spinner();document.body.appendChild(CT.net._spinner_node);}CT.net.xhr(a,"POST",b,true,function(b){if(b.readyState==4)if(b.status==200){if(CT.net._spinner)CT.dom.remove(CT.net._spinner_node);var c=b.responseText.trim();if(CT.net._mode=="ct"){var f=CT.net._ctresponse(c,i);if(f.success)d(f.data,g);else e(f.data,h);}else d(CT.net._ctsuccess(c,i),g);}else e("request to "+a+" failed! ("+b.status+" - "+b.responseText+")",h);},f);},"put":function(a,b,c,d){CT.net.xhr(a,"PUT",b,true,c,d);},"del":function(a,b,c,d){CT.net.xhr(a,"DELETE",b,true,c,d);},"qs":function(a,b){a=a||"";if(b){var c=[];for(var d in b)c.push(d+"="+escape(b[d]));a+="?"+c.join("&");}return a;},"get":function(a,b,c,d){var e,f,g=CT.net._cache&&(c||d);a=CT.net.qs(a,b);if(g){f=CT.storage.get(a);if(f)return f;}e=CT.net.xhr(a,"GET");if(d)e=CT.net._ctresponse(e,a).data;else{if(c)e=JSON.parse(e);if(g)CT.storage.set(a,e);}return e;}},"scriptImport":function(a,b,c){var d=document.getElementsByTagName("head")[0],e=(a.slice(0,4)=="http")&&a||(CT.net.fullPath(a.replace(/\./g,"/")+".js")),f=!(e in CT._.scriptImportCb);if(f)CT._.scriptImportCb[e]=[];if(b)CT._.scriptImportCb[e].push(b);if(f){d.appendChild(CT.dom.script(e));d.appendChild(CT.dom.script(null,"CT._.onImport('"+e+"');",c));}},"require":function(a,b){if(a.slice(0,4)=="http"){if(!(a in CT._.extReqs)){CT._.extReqs[a]=true;eval(CT.net.get(a));}}else{var c=a.split("."),d,e=window;while(e&&c.length){d=c.shift();if(d in e)e=e[d];else{c.unshift(d);c.forEach(function(a,b){e=e[a]={};});c.length=0;e=null;}}if(!e)eval(CT.net.get(CT.net.fullPath(a.replace(/\./g,"/")+".js")));}},"onload":function(a,b){b=b||window;if(!b._ct_onload){b._ct_onload=[];b.addEventListener('load',function(){CT._.triggerOnload(b);});}b._ct_onload.push(a);},"dmerge":function(){var a,b,c,d={};for(a=arguments.length-1;a>-1;a--)if(arguments[a])for(b in arguments[a]){c=arguments[a][b];if(typeof c=="object")d[b]=Array.isArray(c)?c.slice():CT.dmerge(c);else d[b]=c;}return d;},"merge":function(){var a,b,c={};for(a=arguments.length-1;a>-1;a--)if(arguments[a])for(b in arguments[a])c[b]=arguments[a][b];return c;},"bind":function(a,b){for(var c in b)if(typeof b[c]=="function")b[c]=b[c].bind(a);else if(typeof b[c]=="object")CT.bind(a,b[c]);},"Class":function(a,b){a.fullInit=function(){if(b)b.prototype.fullInit.apply(this,arguments);if(a.init)a.init.apply(this,arguments);};var c=function(){var b=CT.dmerge(c.prototype);CT.bind(b,b);if(!b.CLASSNAME){b.CLASSNAME="CT Class";CT.log("Class missing CLASSNAME property -- falling back to 'CT Class'");}if(!b.log)b.log=CT.log.getLogger(b.CLASSNAME);a.fullInit.apply(b,arguments);return b;};c.prototype=CT.merge(a,b&&b.prototype);return c;}};CT.info.android=/Android/.test(CT.info.userAgent);CT.info.iOs=/iPhone|iPad/.test(CT.info.userAgent);CT.info.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(CT.info.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(CT.info.userAgent.substr(0,4));CT.info.isStockAndroid=(CT.info.userAgent.indexOf("Mozilla/5.0")!=-1)&&(CT.info.userAgent.indexOf("Android ")!=-1)&&(CT.info.userAgent.indexOf("AppleWebKit")!=-1)&&(CT.info.userAgent.indexOf("Chrome")==-1);CT.info.isMac=/Macintosh/.test(CT.info.userAgent);CT.log=function(a,b){if(CT.log._silent)return;a=CT.log._fix(a);for(var c=0;c<CT.log.grep._ins.length;c++)if(a.indexOf(CT.log.grep._ins[c])==-1)return;for(var c=0;c<CT.log.grep._outs.length;c++)if(a.indexOf(CT.log.grep._outs[c])!=-1)return;var d=Date()+" ::";if(b)for(var c=0;c<b;c++)d+="  ";console.log(d,a);};CT.log.grep=function(a,b){CT.log.grep._ins=a||[];CT.log.grep._outs=b||[];};CT.log.grep._ins=[];CT.log.grep._outs=[];CT.log._fix=function(a){return(typeof a=="object")?JSON.stringify(a):a;};CT.log._silent=true;CT.log.set=function(a){CT.log._silent=a;};CT.log._loggerCounts={};CT.log.getLogger=function(a){var b=CT.log._loggerCounts;if(!(a in b))b[a]=0;var c=a+" {"+b[a]+"}";b[a]+=1;var d=function(){var a=[];for(var b=0;b<d.arguments.length;b++)a.push(CT.log._fix(d.arguments[b]));CT.log("["+c+"] "+a.join(" "));};return d;};CT.log._tcbs={};CT.log._timer=CT.log.getLogger("timer");CT.log.startTimer=function(a){CT.log._tcbs[a]=Date.now();};CT.log.endTimer=function(a,b){var c=(Date.now()-CT.log._tcbs[a])/1000;CT.log._timer("Completed in",c,"seconds:",a,b);};if(!window.JSON)CT.require("CT.lib.shims.JSON",true);if(!window.sessionStorage)CT.require("CT.lib.shims.sessionStorage",true);if(!document.createElement("div").classList)CT.require("CT.lib.shims.classList",true);if(!window.requestAnimationFrame)CT.require("CT.lib.shims.requestAnimationFrame",true);if(!Object.values)CT.require("CT.lib.shims.ObjectValues",true);if(!window.addEventListener)window.addEventListener=window.attachEvent;;window.CT.all=window.CT.all||{};window.CT.Drop=window.CT.Drop||{};CT.Drop=CT.Class({CLASSNAME:"CT.Drop",_position:function(){var a=CT.align.offset(this.opts.anchor);this.node.style.width=(this.opts.anchor.clientWidth+2)+"px";this.node.style.top=(a.top+this.opts.anchor.clientHeight)+"px";this.node.style.left=(a.left+2)+"px";},_hide:function(){this.node.className="drop hider";},expand:function(a){var b=this.node;this._position();this.viewing=true;b.className="drop drop-open";CT.trans.trans({node:b,cb:function(){b.className+=" drop-auto-over";a&&a();}});},retract:function(){if(!this.viewing)return;this.viewing=false;this.node.className="drop";CT.trans.trans({node:this.node,cb:this._hide});},slide:function(){if(this.viewing)this.retract();else this.expand();},_setAnchor:function(){if(this.opts.setClick)this.opts.anchor.onclick=this.slide;},init:function(a){this.opts=a=CT.merge(a,{content:CT.dom.node(),setClick:true});this.node=CT.dom.node(a.content,null,"drop hider");this.node.onclick=this.slide;document.body.appendChild(this.node);CT.drag.makeDraggable(this.node,{constraint:"horizontal"});setTimeout(this._setAnchor);}});;window.CT.Pager=window.CT.Pager||{};CT.Pager=CT.Class({"CLASSNAME":"CT.Pager","offset":0,"limit":20,"data":[],"init":function(a,b,c,d,e){this.id=CT.Pager._id;CT.Pager._id+=1;this._renderCb=a;this._requestCb=b;if(c)this.limit=c;this._build(d,e);},"remove":function(a){CT.data.remove(this.data,a);this._load();},"_build":function(a,b){this.content=CT.dom.node();this.next=CT.dom.button("next",this._next);this.previous=CT.dom.button("previous",this._previous);this.node=CT.dom.node([this.content,this.previous,this.next],null,a,b);this.node.pager=this;this._load();},"_next":function(){this.offset+=this.limit;this._load();},"_previous":function(){this.offset-=this.limit;this._load();},"_updateButtons":function(){if(this.offset==0)CT.dom.hide(this.previous);else if(this.offset==this.limit)CT.dom.show(this.previous,"inline");if(this.max)CT.dom[((this.offset+this.limit)>=this.max)?"hide":"show"](this.next,"inline");},"_render":function(){CT.dom.setContent(this.content,this._renderCb(this.data.slice(this.offset,this.offset+this.limit)));},"_refill":function(a){CT.data.addSet(a);this.data=this.data.concat(a);if(a.length<this.limit){this.max=this.data.length;this.full=true;}this._load();},"_load":function(){if(this.full||(this.offset+this.limit)<=this.data.length){this._render();this._updateButtons();}else this._requestCb({"limit":this.limit,"offset":this.offset},this._refill);}});CT.Pager._id=0;;window.CT.align=window.CT.align||{};CT.align={"absers":[],"fullscreeners":[],"centerscreeners":[],"_setLeft":function(a,b){return a.style.left=(8+b)+"px";},"absed":function(a,b,c,d,e){a.style.position="absolute";CT.align._setLeft(a,b);if(c!=null)a.style.top=c+"px";if(d!=null)a.style.right=d+"px";if(e!=null)a.style.bottom=e+"px";CT.align.absers.push([a,b,c,d,e]);return a;},"centernode":function(a){if(a.scrollHeight){a.origScrollHeight=a.origScrollHeight||a.scrollHeight;var b=CT.align.height();var c=b-100;var d=parseInt(a.style.height)||a.origScrollHeight;if(d>c||d<a.origScrollHeight){d=Math.min(a.origScrollHeight,c);a.style.height=d+"px";}a.style.top=(b-d)/2+"px";a.style.left=(CT.align.width()/2)-(a.clientWidth/2)+"px";}},"centerall":function(){for(var a=0;a<CT.align.centerscreeners.length;a++)CT.align.centernode(CT.align.centerscreeners[a]);},"centered":function(a){a.style.position="fixed";CT.align.centernode(a);if(CT.align.centerscreeners.indexOf(a)==-1)CT.align.centerscreeners.push(a);return a;},"resize":function(){var a=CT.align.absers;for(var b=0;b<a.length;b++)CT.align._setLeft(a[b][0],a[b][1]);CT.align.centerall();},"position":function(a){var b=curtop=0;if(a.offsetParent)do{b+=a.offsetLeft;curtop+=a.offsetTop;}while(a=a.offsetParent);return [b,curtop];},"offset":function(a){var b={"top":0,"left":0};while(a){if(a==(CT.dom.ALLNODE||document.body))break;b.top+=a.offsetTop;b.left+=a.offsetLeft;a=a.offsetParent;}return b;},"height":function(a){return a?a.clientHeight:window.innerHeight;},"width":function(a){return a?a.clientWidth:window.innerWidth;}};;window.CT.autocomplete=window.CT.autocomplete||{};CT.autocomplete.Guesser=CT.Class({CLASSNAME:"CT.autocomplete.Guesser",_doNothing:function(){},_returnTrue:function(){return true;},tapTag:function(a){this.opts.tapCb(a);this.retract();},addTag:function(a){var b=a.label;var c=CT.dom.node(b,"div","tagline","ac"+b);var d=b.toLowerCase();for(var e=1;e<=d.length;e++)c.className+=" "+d.slice(0,e);this.node.firstChild.appendChild(c);c.onclick=function(){this.tapTag(a);}.bind(this);},_hide:function(){this.node.className="drop hider";this.input.blur();},_upOne:function(a){if(!CT.dom.id("ac"+a.label))this.addTag(a);},_update:function(a){a.forEach(this._upOne);},_onUp:function(a){if(!this.viewing){this.opts.expandCb();CT.dom.mod({className:"tagline",show:true});this.expand(function(){this.input.active=true;this.input.focus();}.bind(this));return true;}},_onKeyUp:function(a){a=a||window.event;var b=a.keyCode||a.which;if(b==13||b==3){this.input.blur();this.opts.enterCb(this.input.value);}else if(this.input.value){var c=this.input.value.toLowerCase(),d=CT.dom.className(c,this.node);CT.dom.mod({className:"tagline",hide:true});if(d.length)CT.dom.mod({className:c,show:true});else this.opts.guessCb(c,this._update);if(!this.viewing)this.expand();}else CT.dom.mod({className:"tagline",hide:true});this.opts.keyUpCb();},_onTap:function(a){this.input.value=a.label;},_waitRetract:function(){setTimeout(this.retract,500);},init:function(a){a=this.opts=CT.merge(a,{enterCb:this._doNothing,keyUpCb:this._doNothing,expandCb:this._doNothing,tapCb:this._onTap,guessCb:this.guesser,anchor:a.input});CT.autocomplete.Guesser.id+=1;this.id=CT.autocomplete.Guesser.id;this.input=a.input;CT.gesture.listen("down",this.input,this._returnTrue);CT.gesture.listen("up",this.input,this._onUp);this.input.onkeyup=this._onKeyUp;this.input.addEventListener("blur",this._waitRetract);}},CT.Drop);CT.autocomplete.Guesser.id=0;CT.autocomplete.DBGuesser=CT.Class({CLASSNAME:"CT.autocomplete.DBGuesser",guesser:function(a){var b=CT.merge(this.opts.filters);b[this.opts.property]={comparator:"like",value:a+"%"};CT.db.get(this.opts.modelName,this._update,null,null,null,b);}},CT.autocomplete.Guesser);;window.CT.canvas=window.CT.canvas||{};window.CT.canvas.Canvas=window.CT.canvas.Canvas||{};CT.canvas.Canvas=CT.Class({"CLASSNAME":"CT.canvas.Canvas","_":{"controllers":{},"propagate":function(a,b){var c=this._.vars.controllers,d,e,f;for(d in c){e=c[d];f=e[a].apply(e,b)||f;}return f;},"on":{"up":function(){this._.propagate("up");},"hover":function(a){this._.propagate("hover",[this._.where(a)]);},"down":function(a){this.canvas.noDrag=this._.propagate("down",[this._.where(a)]);},"drag":function(a,b,c,d,e){this._.propagate("drag",[a,b,c,d,e]);}},"where":function(a){var b=this.canvas.offsetLeft+this.view.offsetLeft,c=this.canvas.offsetTop+this.view.offsetTop;return{x:a.x+this.view.scrollLeft-b,y:a.y+this.view.scrollTop-c};}},"draw":function(a){this._.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var b in this._.controllers)this._.controllers[b].draw(this._.ctx);},"render":function(){if(!this.canvas)return;requestAnimationFrame(this.render);var a=new Date().getTime(),b=a-(this.startTime||a);this.startTime=a;this.draw(b);},"dismantle":function(){if(this.canvas){CT.gesture.unlisten('hover',this.canvas);CT.gesture.unlisten('drag',this.canvas);CT.gesture.unlisten('down',this.canvas);CT.gesture.unlisten('up',this.canvas);CT.dom.remove(this.canvas);this.canvas=null;}},"build":function(){this.canvas=CT.dom.node("","canvas","","",{"width":this._.vars.width,"height":this._.vars.height});this._.ctx=this.canvas.getContext('2d');CT.gesture.listen('hover',this.canvas,this._.on.hover);CT.gesture.listen('drag',this.canvas,this._.on.drag);CT.gesture.listen('down',this.canvas,this._.on.down);CT.gesture.listen('up',this.canvas,this._.on.up);this._.vars.zoom&&CT.gesture.pinch2zoom(this.canvas);},"register":function(a,b){var c=this._.vars,d=this._.controllers,e=b.getDimensions();d[a]=b;c.width=Math.max(c.width,e.width);c.height=Math.max(c.height,e.height);if(this.canvas){this.canvas.width=c.width;this.canvas.height=c.height;}},"init":function(a){this._.vars=CT.merge(a,{"width":CT.align.width(a.view),"height":CT.align.height(a.view),"controllers":{},"zoom":false});for(var b in this._.vars.controllers)this.register(b,this._.vars.controllers[b]);this.view=this._.vars.view;this.build();}});;window.CT.canvas.Controller=window.CT.canvas.Controller||{};CT.canvas.Controller=CT.Class({"CLASSNAME":"CT.canvas.Controller","nodes":[],"nodesByName":{},"_":{"on":{"up":function(a){},"hover":function(a){},"down":function(a){},"drag":function(a){}},"propagate":function(a,b){var c;if(this._.vars.input)this.nodes.forEach(function(d){c=d[a].apply(d,b)&&d||c;});if(c)this._.on[a](c);return c;},bounds:function(a){var b,c=this._.vars.padding,d,e,f=maxY=minX=minY=0;this.nodes.forEach(function(a){b=a._.vars;d=b.x+b.width;e=b.y+b.height;if(f<d+c)f=d+c;if(maxY<e+c)maxY=e+c;if(minX==0||(b.x-c)<minX)minX=b.x-c;if(minY==0||(b.y-c)<minY)minY=b.y-c;});a&&this.nodes.forEach(function(a){a.move(-minX,-minY);});this._.vars.width=f-minX;this._.vars.height=maxY-minY;}},"getDimensions":function(){return{"width":this._.vars.width,"height":this._.vars.height};},"on":function(a,b){this._.on[a]=b;},"up":function(){this.selected=null;return this._.propagate("up");},"hover":function(a){return this._.propagate("hover",[a]);},"down":function(a){this.selected=this._.propagate("down",[a]);return this.selected;},"drag":function(a,b,c,d,e){if(this.selected&&this._.vars.draggable){this.selected.move(c,d);return true;}},"get":function(a){return this.nodesByName[a];},"draw":function(a){this.nodes.forEach(function(b){b.draw(a);});},"addNode":function(a){this.nodes.push(a);this.nodesByName[a._.vars.name]=a;},"rmNode":function(a){CT.data.remove(this.nodes,a);delete this.nodesByName[a.name];},"init":function(a){var b=this._.vars=CT.merge(a,{"input":true,"draggable":true,"normalize":true,"padding":5});b.nodes.forEach(this.addNode);if(b.dimensions){b.width=b.dimensions.width;b.height=b.dimensions.height;delete b.dimensions;}else this._.bounds(b.normalize);}});;window.CT.canvas.Node=window.CT.canvas.Node||{};CT.canvas.Node=CT.Class({"CLASSNAME":"CT.canvas.Node","_":{"mids":function(){var a=this._.vars;a.mids={};a.mids.x=a.x+(a.width/2);a.mids.y=a.y+(a.height/2);},"draw_box":function(a){var b=this._.vars,c,d=b.x,e=b.y,f=b.radius,g=b.width,h=b.height,i=b.over?(2*b.border):b.border,j={tl:f,tr:f,br:f,bl:f};a.strokeStyle=b.selected?b.color_selected:b.color_unselected;a.lineWidth=b.selected?(2*i):i;a.beginPath();a.moveTo(d+j.tl,e);a.lineTo(d+g-j.tr,e);a.quadraticCurveTo(d+g,e,d+g,e+j.tr);a.lineTo(d+g,e+h-j.br);a.quadraticCurveTo(d+g,e+h,d+g-j.br,e+h);a.lineTo(d+j.bl,e+h);a.quadraticCurveTo(d,e+h,d,e+h-j.bl);a.lineTo(d,e+j.tl);a.quadraticCurveTo(d,e,d+j.tl,e);a.closePath();c=a.createLinearGradient(d,e,d,e+h);c.addColorStop(0,"white");c.addColorStop(1,b.color);a.fillStyle=c;a.shadowColor=b.shadowColor;a.shadowBlur=b.shadowBlur;a.shadowOffsetX=b.shadowOffsetX;a.shadowOffsetY=b.shadowOffsetY;a.fill();a.stroke();}},"components":{},"move":function(a,b){this._.vars.x+=a;this._.vars.y+=b;this._.mids();},"contains":function(a){var b=this._.vars.x,c=this._.vars.y,d=this._.vars.width,e=this._.vars.height;return((a.x>=b)&&(a.x<=b+d)&&(a.y>=c)&&(a.y<=c+e));},"hover":function(a){this._.vars.over=this.contains(a);},"up":function(a){},"down":function(a){this._.vars.selected=this.contains(a);return this._.vars.selected&&this;},"build":function(){},"draw":function(a){var b=this._.vars,c=this.components;this.build();b.box&&this._.draw_box(a);b.drawOrder.forEach(function(b){c[b](a);});},"init":function(a){this.id=CT.canvas.Node.id;CT.canvas.Node.id+=1;this._.vars=CT.merge(a,{"inputPadding":5,"border":1,"radius":5,"box":true,"over":false,"selected":false,"color_selected":"red","color_unselected":"#0023AA","shadowColor":"99AAAA","shadowBlur":10,"shadowOffsetX":4,"shadowOffsetY":4,"drawOrder":Object.keys(this.components)});this._.mids();}});CT.canvas.Node.id=0;;window.CT.canvas.Text=window.CT.canvas.Text||{};CT.canvas.Text=CT.Class({"CLASSNAME":"CT.canvas.Text","components":{"text":function(a){var b=this._.vars,c=0,d='',e=[],f=b.x+b.padding,g=b.y+b.padding,h=b.width-b.padding*2,i=b.height-b.padding*2,j=b.lineHeight,k=b.label.split(' '),l,m,n,o,p,q;a.shadowColor=b.textShadowColor;a.shadowBlur=b.textShadowBlur;a.shadowOffsetX=b.textShadowOffsetX;a.shadowOffsetY=b.textShadowOffsetY;a.fillStyle=b.fillStyle;a.textBaseline=b.textBaseline;for(;c<k.length;++c){o=!d?k[c]:d+' '+k[c];p=a.measureText(o);n=n||p;q=p.width;if(q>h&&c>0){m=f+(h-n.width)/2;e.push({"line":d,"xStart":m});d=k[c];n=a.measureText(d);}else{n=p;d=o;}if(c==k.length-1){n=a.measureText(d);m=f+(h-n.width)/2;e.push({"line":d,"xStart":m});}}l=g+(i-j*e.length)/2;a.font=b.font;e.forEach(function(b){a.fillText(b.line,b.xStart,l);l+=j;});}},"init":function(){this._.vars=CT.merge(this._.vars,{"padding":7,"lineHeight":12,"fillStyle":"black","textBaseline":"top","textShadowColor":"none","textShadowBlur":0,"textShadowOffsetX":0,"textShadowOffsetY":0,"font":"Bold 8pt Sans-Serif"});this._.vars.label=this._.vars.label.replace(/(?:\r\n|\r|\n)/g,' ');}},CT.canvas.Node);;;window.CT.data=window.CT.data||{};CT.data={map:{},"sameList":function(a,b){if(a.length!=b.length)return false;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return false;return true;},"copyList":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b;},"diff":function(a,b,c,d,e,f){var g=c||{};d=d||[];f=f||[];e=e||{};for(var h in b)if(d.indexOf(h)!=-1){for(var i in b[h])if(b[h][i]!=a[h][i]){g[h]=b[h];break;}}else if(f.indexOf(h)!=-1){if(!CT.data.sameList(b[h],a[h]))g[h]=b[h];}else if(h in e){if(b[h]!=a[h][e[h]])g[h]=b[h];}else if(b[h]!=a[h])g[h]=b[h];return g;},"append":function(a,b){if(a.indexOf(b)==-1)a.push(b);},"remove":function(a,b){var c=a.indexOf(b);if(c!=-1)return a.splice(c,1);},"has":function(a){return !!CT.data.map[a];},"get":function(a){return CT.data.map[a];},"add":function(a){if(CT.data.map[a.key])for(var b in a)CT.data.map[a.key][b]=a[b];else CT.data.map[a.key]=a;},"addSet":function(a){for(var b=0;b<a.length;b++)CT.data.add(a[b]);},"uniquify":function(a,b){b=b||[];a.sort();var c=[];var d="";for(var e=0;e<a.length;e++)if(a[e]!=d&&b.indexOf(a[e])==-1){d=a[e];c.push(d);}return c;},"random":function(a){return Math.floor(Math.random()*a);},"choice":function(a){return a[CT.data.random(a.length)];},"checkAndDo":function(a,b,c,d,e,f,g){var h=[];a=CT.data.uniquify(a);for(var i=0;i<a.length;i++)if(CT.data.map[a[i]]==null||e&&CT.data.map[a[i]][e]==null)h.push(a[i]);if(h.length==0)return b();g=g||{"gtype":"data"};g.keys=h;CT.net.post(f||"/get",g,"error retrieving data",function(a){CT.data.addSet(a);if(c)c(h);b();},d);},"requirePrep":function(){},"itemReady":function(a,b){var c=a in CT.data.map;b&&b.forEach(function(b){c=c&&b in CT.data.map[a];});return c;},"require":function(a,b,c,d,e){CT.data.requirePrep(a);if(CT.data.itemReady(a,c))b(CT.data.get(a));else{e=e||{"gtype":"user","chat":1};e.uid=a;CT.net.post(d||"/get",e,"error retrieving data",function(c){CT.data.add(c);b(CT.data.get(a));});}},"requireAll":function(a,b,c,d,e,f){a.forEach(CT.data.requirePrep);var g=[];for(var h=0;h<a.length;h++)if(!CT.data.itemReady(a[h],d))g.push(a[h]);if(g.length==0)b(a);else{f=f||{"gtype":"user","chat":1};f.uids=g;CT.net.post("/get",f,"error retrieving data",function(c){CT.data.addSet(c);b(a);});}}};;window.CT.db=window.CT.db||{};CT.db={_schema:{},key2model:function(a){return JSON.parse(atob(a)).model;},key2label:function(a){var b=CT.data.get(a);return b.label;},isKey:function(a,b){return !!CT.db._schema[a]._kinds[b];},getSchema:function(a){return a?CT.db._schema[a]:CT.db._schema;},setSchema:function(a){CT.db._schema=a;var b,c,d,e=CT.db._rmap={};for(b in a)for(c in a[b]._kinds){d=b+"."+c;a[b]._kinds[c].forEach(function(a){if(!(a in e))e[a]=[];e[a].push(d);});}},reference2label:function(a,b){var c=CT.db._schema[a]._kinds[b][0];return{modelName:c,property:CT.db._schema[c]._label};},get:function(a,b,c,d,e,f){var g={"action":"get","modelName":a,"limit":c||20,"offset":d||0};if(e)g.order=e;if(f)g.filters=f;CT.net.post("/_db",g,null,function(a){CT.data.addSet(a);b(a);});},multi:function(a,b){var c=a.filter(function(a){return !CT.data.get(a);});if(!c.length)return b(a.map(function(a){return CT.data.get(a);}));CT.net.post("/_db",{action:"get",keys:c},null,function(c){CT.data.addSet(c);b&&b(a.map(function(a){return CT.data.get(a);}));});},one:function(a,b){if(CT.data.has(a))return b&&b(CT.data.get(a));CT.net.post("/_db",{action:"get",key:a},null,function(a){CT.data.add(a);b&&b(a);});},init:function(a){CT.db._opts=a=CT.merge(a,{panel_key:"db"});CT.net.post("/_db",{"action":"schema"},null,function(b){CT.db.setSchema(b);a.cb&&a.cb(b);});},query:function(a,b){new CT.modal.Modal({"node":new CT.db.Query(a).node,"transition":b||"none"}).show();},_refill:function(a,b,c){return function(d,e){CT.db.get(a,e,d.limit,d.offset,b,c);};},pager:function(a,b,c,d,e){var f=CT.db._opts,g=d||a,e=e||CT.dom.id(f.panel_key+"content"+g);e.appendChild(CT.panel.pager(f.builder(a),CT.db._refill(a,b,c),10,"rcol","data",g));f.post_pager&&f.post_pager(g,a);}};CT.db.edit={_d:{"string":"","integer":0,"float":0.0,"boolean":false,"datetime":null,"key":null},_no_ent:{"key":null,"label":"(tap to select)"},propertyDefault:function(a){return CT.db.edit._d[a];},isSupported:function(a,b){if(b=="label"||b=="_label")return false;return a in CT.db.edit._d;},getDefaults:function(a,b){var c,d=b||{},e=CT.db._schema[a];for(c in e)d[c]=CT.db.edit._d[e[c]];return d;},_val:function(a,b){return function(){if(b=="boolean")return a.checked;if(b=="integer")return parseInt(a.value)||null;if(b=="float")return parseFloat(a.value)||null;if(b=="key")return a.data.key;if(b=="datetime")return a.value();return a.value;};},input:function(a,b,c,d,e){var f;e=e||{};if(b=="string")f=CT.dom.field(null,c);else if(b=="boolean")f=CT.dom.checkbox(null,c,{"display":"inline-block","width":"160px"});else if(b=="float")f=CT.parse.numOnly(CT.dom.field(null,c),true);else if(b=="integer")f=CT.parse.numOnly(CT.dom.field(null,c));else if(b=="key")f=new CT.db.edit.EntityRow({property:a,key:c,modelName:d}).node;else if(b=="datetime")f=CT.dom.dateSelectors(null,null,e.startYear,null,null,null,c);f.getValue=CT.db.edit._val(f,b);f.rowKey=a;return f;}};CT.db.edit.EntityRow=CT.Class({CLASSNAME:"CT.db.edit.EntityRow",mtable:function(){var a,b=CT.dom.node("","div","h19-20 scroller"),c=CT.dom.node(b,"div","h1");for(a in this.node.data)b.appendChild(CT.dom.node([CT.dom.node(a+":","div","keycell"),CT.dom.node(this.node.data[a]||"(none)","span")],"div","lister"));c.appendChild(CT.dom.button("change",this.change));CT.admin&&c.appendChild(CT.dom.button("edit",this.edit));return c;},edit:function(){CT.admin.db.starLink(this.node.data).onclick();this._modal.hide();},modal:function(){this._change&&this._change.hide();this._modal=this._modal||new CT.modal.Modal({transition:"fade",className:"basicpopup h3-5",node:this.mtable()});this._modal.show();},change:function(){this._modal&&this._modal.hide();this._change=this._change||new CT.modal.Prompt({transition:"slide",prompt:"enter name of new "+this.opts.property,cb:this.node.fill,autocomplete:CT.db.reference2label(this.opts.modelName,this.opts.property)});this._change.show();},_change_or_modal:function(){if(this.opts.key)this.modal();else this.change();},init:function(a){this.opts=a;var b=CT.data.get(a.key),c=this.node=CT.dom.node(CT.dom.link(null,this._change_or_modal),"span");c.fill=function(b){b=c.data=b||CT.db.edit._no_ent;a.key=b.key;CT.dom.setContent(c.firstChild,b.label);};if(b||!a.key)c.fill(b);else CT.db.one(a.key,function(a){CT.data.add(a);c.fill(a);});}});CT.db.Query=CT.Class({CLASSNAME:"CT.db.Query",_filter:function(){var a=CT.dom.node(null,"span"),b=this,c=CT.dom.select(["==",">","<",">=","<=","!=","like"]),d=CT.dom.select(this.filterables),e=CT.dom.button("remove",function(){CT.dom.remove(d.parentNode);});d.onchange=function(){CT.dom.setContent(a,CT.db.edit.input(d.value,b.schema[d.value],null,b.modelName,b.opts));};d.onchange();this.filters.appendChild(CT.dom.node([d,c,a,e]));},_order:function(){var a=CT.dom.select(["None"].concat(this.filterables).concat(CT.db._rmap[this.modelName]||[])),b=CT.dom.select(["ascending","descending"]);b.className="hidden";a.onchange=function(){if(a.value=="None")b.classList.add("hidden");else b.classList.remove("hidden");};return CT.dom.node([a,b]);},_submit:function(){var a=null,b={},c=this.order.firstChild;if(c.value!="None")a=c.nextSibling.value=="descending"?"-"+c.value:c.value;CT.dom.each(this.filters,function(a){var c=a.firstChild,d=c.nextSibling,e=d.nextSibling;b[c.value]={comparator:d.value,value:e.firstChild.getValue()};});this.opts.submit({modelName:this.modelName,order:a,filters:b});this.node.parentNode.modal.hide();},_submitCb:function(a){var b=this.modelName+"query"+this.id;CT.panel.add(this.modelName+" ("+this.id+")",false,"db",CT.dom.id(this.opts.pagerPanelId),null,b);CT.db.pager(this.modelName,a.order,a.filters,b);CT.panel.swap(b,false,"db");},_build:function(){this.filters=CT.dom.node();this.order=this._order();this.node=CT.dom.node([CT.dom.node("Query: "+this.modelName,"div","bigger bold"),CT.dom.node("Order","div","big bold"),this.order,CT.dom.node([CT.dom.node("Filters","span","big bold"),CT.dom.button("add",this._filter)]),CT.dom.node("Select 'like' comparator for values such as 'MO%' (meaning 'starts with MO')","div",this.opts.showHelp&&"italic"||"hidden"),this.filters,CT.dom.button("submit",this._submit)],"div","centered");},_filterables:function(){this.filterables=[];for(var a in this.schema)if(CT.db.edit.isSupported(this.schema[a]))this.filterables.push(a);},init:function(a){this.opts=a=CT.merge(a,{submit:this._submitCb,pagerPanelId:"dbqueries"});this.id=CT.db.Query._id;CT.db.Query._id+=1;this.modelName=a.modelName;this.schema=CT.db.getSchema(a.modelName);this._filterables();this._build();}});CT.db.Query._id=0;;window.CT.drag=window.CT.drag||{};CT.drag={_:{direction2orientation:{up:"vertical",down:"vertical",left:"horizontal",right:"horizontal"},orientation2axis:{vertical:"y",horizontal:"x"},dir2abs:{right:"backward",left:"forward",up:"forward",down:"backward"}},log:CT.log.getLogger("drag"),nativeScroll:function(a,b){CT.gesture.listen("up",a,function(){if(b.up)b.up();return true;},true,false);CT.gesture.listen("down",a,function(){if(b.down)b.down();return true;},true,false);var c={up:"down",down:"up",right:"left",left:"right"},d,e,f=function(){if(e){clearTimeout(e);e=null;}e=setTimeout(function(){b.drag(c[d],0,0,0);},100);};CT.gesture.listen("drag",a,function(c,e,f,g){if(a.noDrag)return;var h=(a.parentNode.scrollHeight-a.parentNode.scrollTop===a.parentNode.clientHeight),i=(a.parentNode.scrollTop===0),j=(a.parentNode.scrollLeft===0),k=(a.parentNode.clientWidth+a.parentNode.scrollLeft===a.parentNode.scrollWidth);d=c;if(b.drag)b.drag(c,e,f,g);if((i&&c=="down")||(h&&c=="up"))return false;return b.constraint!=CT.drag._.direction2orientation[c];},true,false);CT.gesture.listen("swipe",a,function(c,d,e,f,g){if(c=="up"&&(a.parentNode.scrollTop>=(a.parentNode.scrollHeight-(a.parentNode.clientHeight+800)))&&b.swipe)b.swipe();},true,false);a.parentNode.addEventListener('scroll',function(a){if(b.scroll)b.scroll(a);if(b.drag)f();return true;},false);},makeDraggable:function(a,b){b=b||{};if(!b.interval&&!b.force&&!CT.info.isStockAndroid)return CT.drag.nativeScroll(a.firstChild,b);var c=CT.drag._;a.xDrag=0;a.yDrag=0;a.classList.add('hardware-acceleration');a.style['-webkit-transform']="translate3d(0,0,0)";a.parentNode.addEventListener('scroll',function(a){return false;},false);var d=function(){return b.interval=="auto"?(CT.align[b.constraint=="horizontal"?"height":"width"](a)/a.childNodes.length):b.interval;};var e=function(){if(a.animating)return;a.dragging=false;a.touchedDown=true;a.animating=false;a.xDragStart=a.xDrag;a.yDragStart=a.yDrag;if(b.down)b.down();};var f=function(c){var e=0,f=0,g=false,h=d();a.touchedDown=a.dragging=false;if(a.animating==false){if(h){if(b.constraint!="vertical"){f=a.yDrag%h;if(f!=0){if(Math.abs(f)<=(h/2))a.yDrag-=f;else a.yDrag-=(h+f);if(a.yDrag<a.yDragStart)c="up";else if(a.yDrag>a.yDragStart)c="down";else c="hold";}}if(b.constraint!="horizontal"){e=a.xDrag%h;if(e!=0){if(Math.abs(e)<=(h/2))a.xDrag-=e;else a.xDrag-=(h+e);if(a.xDrag<a.xDragStart)c="left";else if(a.xDrag>a.xDragStart)c="right";else c="hold";}}if(c){a.animating=true;CT.trans.translate(a,{x:a.xDrag,y:a.yDrag,cb:function(){a.animating=false;}});}}else{if(b.constraint!="horizontal")if(a.xDrag>0){a.xDrag=0;g=true;c="right";}else if(Math.abs(a.xDrag)>(a.scrollWidth-a.parentNode.clientWidth)){a.xDrag=-(a.scrollWidth-a.parentNode.clientWidth);g=true;c="left";}if(b.constraint!="vertical")if(a.yDrag>0){a.yDrag=0;g=true;c="up";}else if(a.yDrag<-(a.scrollHeight-a.parentNode.clientHeight)){a.yDrag=-(a.scrollHeight-a.parentNode.clientHeight);g=true;c="down";}if(g){a.animating=true;CT.trans.translate(a,{x:a.xDrag,y:a.yDrag,cb:function(){a.animating=false;if(b.drag)b.drag(c,0,0,0);if(b.scroll)b.scroll();}});}}if(b.up)b.up(c);}};var g=function(c,d,e,f){if(a.touchedDown&&!a.noDrag){a.dragging=true;if(b.constraint!="vertical")if(a.yDrag>-(a.scrollHeight-(2*a.parentNode.clientHeight/3)))a.yDrag+=f;if(b.constraint!="horizontal")if(Math.abs(a.xDrag)<(a.scrollWidth-(2*a.parentNode.clientWidth/3)))a.xDrag+=e;CT.trans.setVenderPrefixed(a,"transform","translate3d("+a.xDrag+"px,"+a.yDrag+"px,0)");if(b.drag)b.drag(c,d,e,f);if(b.scroll)b.scroll();}};var h=function(b){if(b=="horizontal")return a.parentNode.clientWidth-a.scrollWidth;else if(b=="vertical")return a.parentNode.clientHeight-a.scrollHeight;};var i=function(e,g,i,j,k){var l,m,n,o,p,q,r=d();if(a.animating)return;if(c.direction2orientation[e]==b.constraint)return b.up&&b.up(e);for(l in c.orientation2axis){m=c.dir2abs[e];n=c.orientation2axis[l];o=a[n+"Drag"];p=h(l);q=r?(o%r):(l=="vertical"?-j:-i);if(b.constraint!=l&&o<=0&&o>p)if(m=="backward")a[n+"Drag"]-=q;else if(m=="forward")a[n+"Drag"]+=(r?-(r+q):q);else return CT.drag.log("swipeCallback",e,"has no abs dir!");}a.animating=true;CT.trans.translate(a,{x:a.xDrag,y:a.yDrag,cb:function(){a.animating=false;f(e);}});};if(a.isDraggable)CT.gesture.unlisten(a);a.isDraggable=true;CT.gesture.listen("drag",a,g);CT.gesture.listen("down",a,e);CT.gesture.listen("swipe",a,i);CT.gesture.listen("up",a,f);}};;window.CT.dom=window.CT.dom||{};CT.dom={"_autoparse":false,"setAutoparse":function(a){CT.dom._autoparse=a;},"_nodes":{},"_obj2node":function(a){var b=[];if(a.builder){a.content=a.items.map(function(b){return a.builder(b);});delete a.builder;delete a.items;}["content","type","classname","id"].forEach(function(c){b.push(a[c]);delete a[c];});b.push(a);if(a.style){b.push(a.style);delete a.style;}return CT.dom.node.apply(null,b);},"node":function(a,b,c,d,e,f){var g=document.createElement(b||"div");if(a)if(Array.isArray(a))a.forEach(function(a){g.appendChild(a instanceof Node?a:CT.dom.node(a));});else if(a instanceof Node)g.appendChild(a);else if(typeof a=="function")g.appendChild(a());else if(typeof a=="object")return CT.dom._obj2node(a);else if(typeof a=="string"||typeof a=="number")if(b=="table")alert("illegal innerHTML set on table! content: "+a);else if(b=="style"){g.type='text/css';if(g.styleSheet)g.styleSheet.cssText=a;else g.appendChild(document.createTextNode(a));}else{if(CT.dom._autoparse)a=CT.parse.process(a.toString());g.innerHTML=a;}if(c)g.className=c;if(d){g.id=d;CT.dom._nodes[d]=g;}g.on=function(a,b){if(b)return g.addEventListener(a,b);for(var c in a)g.addEventListener(c,a[c]);};if(e)for(var h in e){if(e[h]==null)continue;if(h=="value"||h=="onclick")g[h]=e[h];else if(h.slice(0,2)=="on")g.on(h.slice(2),e[h]);else g.setAttribute(h,e[h]);}if(f)for(var i in f)g.style[i]=f[i];return g;},"script":function(a,b,c){if(c)b="setTimeout(function() { "+b+" }, 1000);";return CT.dom.node(b,"script",null,null,{"src":a});},"link":function(a,b,c,d,e,f,g){if(f==null)f={};if(b)f.onclick=b;if(c)f.href=c;if(g)f.target="_blank";return CT.dom.node(a,"a",d,e,f);},"button":function(a,b,c,d){return CT.dom.node(a,"button",c,d,{"onclick":b});},"field":function(a,b,c,d){return CT.dom.node("","input",c,a,(b!=null||d!=null)&&{"value":b,"type":d}||null);},"textArea":function(a,b,c){return CT.dom.node("","textarea",c,a,b&&{"value":b}||null);},"img":function(a,b,c,d,e,f,g,h){var i=CT.dom.node("","img",b,"",{"src":a});if(c||d){var j=CT.dom.link("",c,d);if(e)j.target=e;if(f)j.title=j.alt=f;if(g)j.id=g;if(h)i=CT.dom.node(i,"div",h);j.appendChild(i);return j;}return i;},"select":function(a,b,c,d,e){b=b||a;var f=CT.dom.node("","select","",c);for(var g=0;g<a.length;g++)f.appendChild(CT.dom.node(a[g],"option","","",{"value":b[g]}));if(d)f.value=b.indexOf(d)!=-1&&d||e;return f;},"range":function(a,b,c,d,e,f,g){var h=CT.dom.node("","input",f,g,{"type":"range","oninput":a&&function(){a(h.value);},"min":b,"max":c,"value":d,"step":e});return h;},"checkbox":function(a,b,c){var d={"type":"checkbox"};if(b)d.checked=b;return CT.dom.node("","input","",a,d,c);},"wrapped":function(a,b,c,d,e){CT.log("[DEPRECATION WARNING] CT.dom.wrapped() is deprecated. Use CT.dom.node().");var f=CT.dom.node("",b,c,d,e);if(!Array.isArray(a))a=[a];for(var g=0;g<a.length;g++)f.appendChild(a[g]);return f;},"audio":function(a,b,c,d,e,f,g){g=g||{};g.src=a;if(b)g.autoplay="true";if(c)g.onplay=c;if(d)g.onended=d;return CT.dom.node("","audio",e,f,g);},"iframe":function(a,b,c){var d=CT.dom.node("","iframe",b,c,{"src":a});d.setHash=function(a){CT.dom.getLoc(d).hash=a;};return d;},"pad":function(a){a=a||1;var b="";for(var c=0;c<a;c++)b+="&nbsp;";return CT.dom.node(b,"span");},"marquee":function(a,b,c){var d=CT.dom.node(a,"marquee",b,null,{direction:c||"left",behavior:"alternate"});setTimeout(function(){CT.dom.each(d,function(a){a.style.height=d.clientHeight+"px";});});return d;},"getDoc":function(a){return a.documentWindow||a.contentWindow||a.contentDocument;},"getLoc":function(a){return CT.dom.getDoc(a).location;},"checkboxAndLabel":function(a,b,c,d,e,f){var g=CT.dom.node("","div",e);var h=a+"checkbox";var i=CT.dom.checkbox(h,b);g.appendChild(i);if(f)i.onclick=function(){f(i);};g.appendChild(CT.dom.node(c||a,"label",d,"",{"for":h,"htmlFor":h}));return g;},"resizeTextArea":function(a){if(navigator.appName.indexOf("Microsoft Internet Explorer")==0)a.style.overflow='visible';else{while(a.rows>1&&a.scrollHeight<a.offsetHeight)a.rows--;while(a.scrollHeight>a.offsetHeight)a.rows++;}},"labelAndField":function(a,b,c,d,e,f,g){b=b||a.replace(/ /g,"");var h=CT.dom.node();var i=CT.dom[(f&&"textArea"||"field")](b,e,"right "+(c||""),(a.indexOf("Password")!=-1)&&"password"||null);if(f&&g)i.onkeyup=function(){CT.dom.resizeTextArea(i);return true;};h.appendChild(i);h.appendChild(CT.dom.node(a,"label",d,null,{"for":b,"htmlFor":b}));h.appendChild(CT.dom.node("","div","clearnode"));return h;},"_radioStripStep":function(a,b,c,d,e,f,g){var h=(e||"radiostrip")+(f||"")+c;var i=CT.dom.field(h,null,null,"radio");i.name=(e||"")+(f||"");i.onclick=function(){d(c);};if(g)i.checked=true;a.insertCell(-1).appendChild(i);b.insertCell(-1).appendChild(CT.dom.node(c,"label",null,null,{"htmlFor":h,"for":h}));},"radioStrip":function(a,b,c,d,e,f){var g=CT.dom.node("","table");g.style.textAlign="center";var h=g.insertRow(0);var i=g.insertRow(1);for(var j=0;j<b.length;j++)CT.dom._radioStripStep(h,i,b[j],c,d,e,b[j]==f);a.appendChild(g);},"linkWithIcon":function(a,b,c,d){var e=CT.dom.node("","span");e.appendChild(CT.dom.img(a,"vmiddle rpaddedsmall nodecoration",d,c));e.appendChild(CT.dom.link(b,d,c));return e;},"labeledImage":function(a,b,c,d,e,f,g,h,i){var j=CT.dom.link();var k=CT.dom.img(a,e);var l=CT.dom.node(c,"div",g);if(h){j.appendChild(l);j.appendChild(k);}else{j.appendChild(k);j.appendChild(l);}j.title=j.alt=d||c;var m=CT.dom.node(j,"div",f);if(b){j.href=b;j.target="_blank";}else if(i)m.onclick=i;return m;},"buildForm":function(a,b){var c=document.getElementById(a+"Table");for(var d=0;d<b.length;d++){var e=b[d];var f=a+e.replace(/ /g,"");var g=c.insertRow(-1);g.insertCell(0).appendChild(CT.dom.node(e,"label","","",{"htmlFor":f,"for":f}));var h=CT.dom.field(f);if(e.indexOf("Password")!=-1)h.type="password";g.insertCell(1).appendChild(h);}return c;},"timer":function(a,b,c,d,e){var f=CT.dom.node(a,"div",c,d,e);f._sec=a;f._check=function(){f._sec-=1;f.innerHTML=f._sec;if(f._sec==0){f.stop();b&&b();}};f.set=function(a){f.innerHTML=f._sec=a;};f.start=function(){f.stop();f._interval=setInterval(f._check,1000);};f.stop=function(){if(f._interval){clearInterval(f._interval);f._interval=null;}};f.start();return f;},"choices":function(a,b,c,d,e){d=d||"grayback";var f=CT.dom.node();f._sel=null;f.value=b?[]:-1;a.forEach(function(a,g){a.onclick=function(){if(!b&&f._sel)f._sel.classList.remove(d);f._sel=a;if(a.classList.contains(d)){a.classList.remove(d);if(b)CT.data.remove(f.value,g);else f.value=[];}else{a.classList.add(d);if(b)CT.data.append(f.value,g);else f.value=g;}e&&e(g);};a.classList.add(c||"choice_cell");f.appendChild(a);});return f;},"form":function(a,b,c,d,e){return CT.dom.node(a,"form",d,e,{method:c||"post",action:b});},"spinner":function(){return CT.dom.node(CT.dom.node([CT.dom.node("loading...","strong"),CT.dom.node("","span")],"div","ctspinner"),"div","ctswrap");},"_monthnames":["January","February","March","April","May","June","July","August","September","October","November","December"],"currentyear":Math.max(new Date().getFullYear(),2014),"dateSelectors":function(a,b,c,d,e,f,g){var h=["Year"];c=c||CT.dom.currentyear;d=d||CT.dom.currentyear;for(var i=c;i<=d;i++)h.push(i);a=a||CT.dom.node(null,"span");b=b||a;b.year=CT.dom.select(h);b.month=CT.dom.select(["Month"].concat(CT.dom._monthnames),["Month","01","02","03","04","05","06","07","08","09","10","11","12"]);a.appendChild(b.year);a.appendChild(b.month);if(!f){b.day=CT.dom.select(["Day","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]);a.appendChild(b.day);}if(e){var j=["Time"];for(var i=0;i<24;i++){var k=i<10?"0"+i:i;j.push(k+":"+"00");j.push(k+":"+"30");}b.time=CT.dom.select(j);a.appendChild(b.time);}if(g){var l=g.split(" "),m=l[0].split("-");b.year.value=m[0];b.month.value=m[1];if(!f)b.day.value=m[2];if(e)b.time.value=l[1].slice(0,-3);}b.value=function(){if(b.year.value=="Year"||b.month.value=="Month"||(!f&&b.day.value=="Day"))return null;var a=b.year.value+"-"+b.month.value;if(!f)a+="-"+b.day.value;if(e)a+=" "+b.time.value+":00";else a+=" 00:00:00";return a;};return a;},"_pwpcb":null,"passwordPrompt":function(a){CT.log("[DEPRECATION WARNING] CT.dom.passwordPrompt() is deprecated. Use CT.Prompt instead.");CT.dom._pwpcb=a;var b=document.getElementById("passwordprompt");var c=document.getElementById("pwpfield");if(b==null){b=CT.dom.node("","div","hidden basicpopup centered","passwordprompt");document.body.appendChild(b);b.appendChild(CT.dom.node("For your own security, please enter your password.","div","bottompadded"));c=CT.dom.field("pwpfield",null,null,"password");b.appendChild(c);var d=function(){if(!CT.parse.validPassword(c.value))return alert("invalid password!");b.style.display="none";CT.dom._pwpcb(c.value);};CT.dom.inputEnterCallback(c,d);b.appendChild(CT.dom.button("Continue",d));b.appendChild(CT.dom.button("Cancel",function(){b.style.display="none";}));}c.value="";b.style.display="block";c.focus();CT.align.centered(b);},"_blurs":{},"setBlur":function(a,b){CT.dom._blurs[a]=b;},"getFieldValue":function(a,b,c){var d=document.getElementById(a);if(!d)return null;if(b)for(var e=0;e<b.length;e++)d=d[b[e]];var f=d.value;if(f==""||(CT.dom._blurs[a]&&CT.dom._blurs[a].indexOf(f)!=-1))return "";if(c){if(c.requires)for(var e=0;e<c.requires.length;e++)if(f.indexOf(c.requires[e])==-1){f="";break;}if((f&&f.length||0)<(c.length||0))f="";}return f;},"blurField":function(a,b){b=CT.dom._blurs[a.id]=b||CT.dom._blurs[a.id];if(b){a.onblur=function(){if(a.value==""){a.classList.add("gray");a.value=b[Math.floor(Math.random()*b.length)];}else a.classList.remove("gray");};a.onfocus=function(){if(b.indexOf(a.value)!=-1){a.value="";a.classList.remove("gray");}};a.onblur();}},"setFieldValue":function(a,b,c){var d=document.getElementById(b);if(!d)return setTimeout(CT.dom.setFieldValue,500,a,b,c);if(c)for(var e=0;e<c.length;e++)d=d[c[e]];d.value=a||"";CT.dom.blurField(d);},"genfield":function(a,b,c,d,e,f){var g=CT.dom.field("up"+a,e||d[a],"right w280",(a.indexOf("password")!=-1)&&"password"||null);c[a]=g;b.appendChild(g);b.appendChild(CT.dom.node(CT.parse.key2title(a),"label","bold",null,{"for":"up"+a,"htmlFor":"up"+a}));if(f){b.appendChild(CT.dom.node("&nbsp;&nbsp;","span"));b.appendChild(f);}b.appendChild(CT.dom.node("","div","clearnode"));},"inputEnterCallback":function(a,b,c){a.onkeyup=function(d){d=d||window.event;var e=d.keyCode||d.which;if(e==13||e==3){if(c)document.getElementById(c).focus();b&&b(a.value);}};return a;},"smartField":function(a,b,c,d,e,f){c=c||("sf"+Math.floor((Math.random()*100000)));var g=CT.dom.inputEnterCallback(CT.dom.field(c,d,b,e),a,c);if(f)CT.dom.blurField(g,f);return g;},"_ricounter":0,"_get_ta_id":function(){var a="richinput"+CT.dom._ricounter;CT.dom._ricounter+=1;return a;},"richInput":function(a,b,c,d,e,f,g){b=b||CT.dom._get_ta_id();e=e||500;var h=CT.dom.textArea(b,d,"fullwidth");CT.dom.blurField(h,f);a.appendChild(CT.dom.node(h));var i=CT.dom.node("("+e+" chars left)","div","right",b+"cc");h.onkeyup=function(a){a=a||window.event;var c=CT.dom.getFieldValue(b).length;if(c>e){h.value=h.value.slice(0,e);i.className="right bold";if(a.preventDefault)a.preventDefault();return false;}else i.className="right";i.innerHTML="("+(e-c)+" chars left)";CT.dom.resizeTextArea(h);return true;};a.appendChild(i);if(c)a.appendChild(c);else if(!g)a.appendChild(CT.dom.node("","div","clearnode"));return h;},"showHideT":function(a){a=a||document.body;a.style.opacity=a.style.opacity=="1"&&"0"||"1";},"showHideV":function(a){a=a||document.body;a.style.visibility=a.style.visibility=="visible"&&"hidden"||"visible";},"showHide":function(a,b,c,d){a=a||document.body;d=d||"block";if(b||c)a.style.display=b&&d||"none";else if(a.style.display==""&&a.className.indexOf("hidden")==-1)a.style.display="none";else a.style.display=(a.style.display==d)&&"none"||d;},"showHideSet":function(a,b,c,d){for(var e=0;e<a.length;e++)CT.dom.showHide(a[e],b,c,d);},"show":function(a,b){CT.dom.showHide(a,true,false,b);},"hide":function(a){CT.dom.showHide(a,false,true);},"remove":function(a){a&&a.parentNode&&a.parentNode.removeChild(a);},"addContent":function(a,b){if(typeof b=="function")b=b();if(Array.isArray(b))b=CT.dom.node(b);if(typeof b=="string")a.innerHTML+=b;else a.appendChild(b);},"setContent":function(a,b){a.innerHTML="";CT.dom.addContent(a,b);},"addEach":function(a,b){b.forEach(function(b){a.appendChild(b);});},"ALLNODE":null,"loadAllNode":function(){if(!CT.dom.ALLNODE){CT.dom.ALLNODE=document.getElementById("all");CT.dom.ALLNODE._mobile=CT.align.width()<=720;window.onresize=function(){CT.dom.ALLNODE.resize();CT.align.resize();};}},"getAllNode":function(){CT.dom.loadAllNode();return CT.dom.ALLNODE;},"showAllNode":function(){var a=CT.dom.ALLNODE;a.style.opacity=a.style["-moz-opacity"]=a.style["-khtml-opacity"]="1";a.style.filter="alpha(opacity = 100)";a.style["-ms-filter"]="progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";},"addStyle":function(a,b,c){if(c){a=[];for(var d in c){a.push(d+" {");var e=c[d];for(var f in e)a.push(f+": "+e[f]+";");a.push("}");}a=a.join("\n");}var g=b?CT.dom.node(null,"link",null,null,{"href":b}):CT.dom.node(a,"style");CT.dom.tag("head")[0].appendChild(g);},"doWhenNodeExists":function(a,b){if(document.getElementById(a))return b();setTimeout(CT.dom.doWhenNodeExists,1000,a,b);},"id":function(a,b){return document.getElementById(a)||b&&CT.dom._nodes[a];},"_narr2arr":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b;},"className":function(a,b){return CT.dom._narr2arr((b||document).getElementsByClassName(a));},"tag":function(a,b){return CT.dom._narr2arr((b||document).getElementsByTagName(a));},"Q":function(a,b){return CT.dom._narr2arr((b||document.body).querySelectorAll(a));},"each":function(a,b){for(var c=0;c<a.childNodes.length;c++)b(a.childNodes[c]);},"mod":function(a){var b=a.targets?a.targets:(a.target?[a.target]:(a.className?CT.dom.className(a.className):(a.id?[CT.dom.id(a.id)]:[]))),c=a.property||"display",d=a.value||(a.show?"block":a.hide?"none":"");for(var e=0;e<b.length;e++)b[e].style[c]=d;}};;window.CT.gesture=window.CT.gesture||{};CT.gesture={gid:0,preventDefault:true,thresholds:{swipe:{minDistance:35,maxTime:400,minDP:600,maxDP:1000},drag:{minDP:0,maxDP:1000},tap:{maxDistance:10,maxTime:700,waitTime:300,maxCount:2},hold:{maxDistance:null,interval:1000},up:{androidDelay:600},pinch:{},zoom:{min:0.25,max:8,slow:2,wheel:{enabled:!CT.info.mobile&&!CT.info.isMac,jump:0.2}}},_vars:{active:false,startTime:null,dragTime:null,startPos:null,lastPos:null,tapCount:0,holdCount:0,zoomLevel:1,tapTimeout:null,holdInterval:null,stopTimeout:null,firstPinch:null,stopPropagation:false,preventDefault:false,iosPinch:false,iosPinching:false},gevents:{GestureStart:"gesturestart",GestureChange:"gesturechange",GestureEnd:"gestureend"},events:CT.info.mobile&&{Start:"touchstart",Stop:"touchend",Move:"touchmove",Cancel:"touchcancel"}||{Start:"mousedown",Stop:"mouseup",Move:"mousemove"},handlers:{drag:{},swipe:{},tap:{},up:{},down:{},hold:{},pinch:{},hover:{},wheel:{}},tuneThresholds:function(){if(!CT.info.iOs)for(var a in CT.gesture.thresholds)for(var b in CT.gesture.thresholds[a]){var c=b.slice(3);if(c=="Distance")CT.gesture.thresholds[a][b]/=2;else if(c=="DP")CT.gesture.thresholds[a][b]*=2;}},getPos:function(a){if(a.x==undefined){a.x=a.pageX||a.changedTouches[0].pageX;a.y=a.pageY||a.changedTouches[0].pageY;}return{x:a.x,y:a.y};},getDiff:function(a,b,c){var d={};d.x=b.x-a.x;d.y=b.y-a.y;d.distance=Math.sqrt((d.x*d.x)+(d.y*d.y));if(c)d.midpoint=CT.gesture.getMidpoint([a,b]);if(Math.abs(d.x)>Math.abs(d.y))d.direction=d.x>0?'right':'left';else d.direction=d.y>0?'down':'up';return d;},pinchDiff:function(a){return CT.info.iOs?{x:a.pageX,y:a.pageY}:CT.gesture.getDiff(CT.gesture.getPos(a.touches[0]),CT.gesture.getPos(a.touches[1]),true);},getMidpoint:function(a){var b=function(b){return(a[0][b]+a[1][b])/2;};return{x:b('x'),y:b('y')};},pixelsPerSecond:function(a,b,c){var d=CT.gesture.thresholds[c];return Math.min(d.maxDP,Math.max(d.minDP,a/b))*(CT.info.iOs?1:0.5);},isMulti:function(a){return CT.info.mobile&&a.touches.length>1;},onGestureStart:function(a,b){},onGestureChange:function(a,b){CT.gesture.triggerPinch(b,Math.pow(a.scale,(1/8)),CT.gesture.pinchDiff(a));},onGestureEnd:function(a,b){CT.gesture.triggerPinch(b,Math.pow(a.scale,(1/8)),CT.gesture.pinchDiff(a));b.gvars.iosPinching=false;},onStart:function(a,b){var c=CT.gesture.thresholds;var d=b.gvars;d.active=true;d.holdCount=0;d.startTime=d.dragTime=Date.now();d.startPos=d.lastPos=CT.gesture.getPos(a);if(d.tapTimeout){clearTimeout(d.tapTimeout);d.tapTimeout=null;}if(CT.gesture.isMulti(a))if(CT.info.android)d.firstPinch=CT.gesture.pinchDiff(a);else d.iosPinching=true;else d.holdInterval=setInterval(function(){if(!d.active||(c.hold.maxDistance&&(c.hold.maxDistance<CT.gesture.getDiff(d.startPos,d.lastPos).distance))){clearInterval(d.holdInterval);d.holdInterval=null;return;}d.holdCount+=1;CT.gesture.triggerHold(b,c.hold.interval*d.holdCount);},c.hold.interval);return CT.gesture.triggerDown(b,CT.gesture.getPos(a));},onStop:function(a,b,c){var d=b.gvars;if(!c&&d.holdInterval){clearInterval(d.holdInterval);d.holdInterval=null;}if(!d.active)return;var e=CT.gesture.thresholds;var f=CT.gesture.getPos(a);var g=CT.gesture.getDiff(d.startPos,f);var h=Date.now()-d.startTime;d.active=!!(a.touches&&a.touches.length);if(!d.active&&!d.iosPinching)if((h<e.swipe.maxTime)&&(g.distance>e.swipe.minDistance))CT.gesture.triggerSwipe(b,g.direction,g.distance,g.x,g.y,CT.gesture.pixelsPerSecond(g.distance,h,"swipe"));else if((h<e.tap.maxTime)&&(g.distance<e.tap.maxDistance)){d.tapCount+=1;if(d.tapCount==e.tap.maxCount)CT.gesture.triggerTap(b);else d.tapTimeout=setTimeout(CT.gesture.triggerTap,e.tap.waitTime,b);}return CT.gesture.triggerUp(b,c);},onMove:function(a,b){var c=b.gvars,d=CT.gesture.getPos(a);if(c.active){var e,f=CT.gesture.getDiff(c.lastPos,d),g=Date.now(),h=g-c.dragTime;c.lastPos=d;c.dragTime=g;if(!CT.gesture.isMulti(a)){var i=CT.info.mobile&&CT.gesture.triggerHover(b,d);return CT.gesture.triggerDrag(b,f.direction,f.distance,f.x,f.y,CT.gesture.pixelsPerSecond(f.distance,h,"drag"))||i;}if(CT.info.android){e=CT.gesture.pinchDiff(a);CT.gesture.triggerPinch(b,e.distance/c.firstPinch.distance,e.midpoint);}}else return CT.gesture.triggerHover(b,d);},onWheel:function(a,b){CT.gesture.triggerWheel(b,CT.gesture.getPos(a),a.deltaY);},gWrap:function(a){var b={};['GestureStart','GestureChange','GestureEnd'].forEach(function(c){b[c]=function(b){b.preventDefault();b.stopPropagation();return CT.gesture['on'+c](b,a)||false;};});return b;},eWrap:function(a){var b={};['Start','Stop','Move'].forEach(function(c){b[c]=function(b){a.gvars.preventDefault&&b.preventDefault();a.gvars.stopPropagation&&b.stopPropagation();return CT.gesture['on'+c](b,a)||(CT.gesture.preventDefault&&b.preventDefault())||b.stopPropagation()||false;};});if(CT.gesture.events.Cancel)b.Cancel=b.Stop;return b;},zoom:function(a,b,c){var d=CT.gesture.thresholds.zoom,e=a.gvars;e.zoomLevel=a.style.zoom=Math.max(d.min,Math.min(d.max,Math.pow(b*e.zoomLevel,1/d.slow)));},pinch2zoom:function(a){var b=CT.gesture.thresholds.zoom.wheel,c=a.gvars;CT.gesture.listen('pinch',a,function(b,c){CT.gesture.zoom(a,b,c);},true,true);b.enabled&&CT.gesture.listen("wheel",a,function(d,e){CT.gesture.zoom(a,c.zoomLevel*(1+(e>0?-b.jump:b.jump)),d);});},listen:function(a,b,c,d,e){if(!b.gid){b.gid=++CT.gesture.gid;var f=b.listeners=CT.gesture.eWrap(b);for(var g in CT.gesture.events)b.addEventListener(CT.gesture.events[g],f[g]);b.gvars=CT.merge(CT.gesture._vars);}if(a=="pinch"&&CT.info.iOs){var h=CT.gesture.gWrap(b);for(var g in CT.gesture.gevents)b.addEventListener(CT.gesture.gevents[g],h[g]);for(var i in h)b.listeners[i]=h[i];b.gvars.iosPinch=true;}else if(a=="wheel"&&!b.listeners.wheel){b.listeners.wheel=function(a){CT.gesture.onWheel(a,b);};b.addEventListener("wheel",b.listeners.wheel);}b.gvars.stopPropagation=d;b.gvars.preventDefault=e;if(!CT.gesture.handlers[a][b.gid])CT.gesture.handlers[a][b.gid]=[];CT.gesture.handlers[a][b.gid].push(c);},unlisten:function(a){if(a.gid){var b=a.listeners;for(var c in CT.gesture.events)a.removeEventListener(CT.gesture.events[c],b[c]);if(a.gvars.iosPinch)for(var c in CT.gesture.gevents)a.removeEventListener(CT.gesture.gevents[c],b[c]);if(b.wheel)a.removeEventListener("wheel",b.wheel);for(var d in CT.gesture.handlers)if(a.gid in CT.gesture.handlers[d])delete CT.gesture.handlers[d][a.gid];delete a.gid;}},triggerPinch:function(a,b,c){var d=CT.gesture.handlers.pinch[a.gid];if(d)for(var e=0;e<d.length;e++)d[e](b,c);},triggerSwipe:function(a,b,c,d,e,f){var g=CT.gesture.handlers.swipe[a.gid];hasSwiped=true;if(g)for(var h=0;h<g.length;h++)g[h](b,c,d,e,f);},triggerTap:function(a){var b=a.gvars;var c=CT.gesture.handlers.tap[a.gid];if(c)for(var d=0;d<c.length;d++)c[d](b.tapCount);b.tapCount=0;b.tapTimeout=null;},triggerDrag:function(a,b,c,d,e,f){var g=false;var h=CT.gesture.handlers.drag[a.gid];if(h)for(var i=0;i<h.length;i++)g=h[i](b,c,d,e,f)||g;return g;},triggerHover:function(a,b){var c=false;var d=CT.gesture.handlers.hover[a.gid];if(d)for(var e=0;e<d.length;e++)c=d[e](b)||c;return c;},triggerWheel:function(a,b,c){var d=CT.gesture.handlers.wheel[a.gid];if(d)for(var e=0;e<d.length;e++)d[e](b,c);},triggerHold:function(a,b){var c=CT.gesture.handlers.hold[a.gid];if(c)for(var d=0;d<c.length;d++)c[d](b);},triggerUp:function(a,b){var c=false;var d=CT.gesture.handlers.up[a.gid];if(d)for(var e=0;e<d.length;e++)c=d[e](b)||c;return c;},triggerDown:function(a,b){var c=false;var d=CT.gesture.handlers.down[a.gid];if(d)for(var e=0;e<d.length;e++)c=d[e](b)||c;return c;}};CT.gesture.tuneThresholds();;window.CT.key=window.CT.key||{};CT.key={_codes:[null,null,null,null,null,null,null,null,"BACKSPACE","TAB",null,null,null,"ENTER",null,null,"SHIFT","CTRL","ALT",null,"CAPS",null,null,null,null,null,null,"ESCAPE",null,null,null,null,null,"PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN",null,"PRINT",null,null,"INSERT","DELETE",null,"0","1","2","3","4","5","6","7","8","9",null,null,null,null,null,null,null,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","META_LEFT","META_RIGHT","SELECT",null,null,"NUMPAD_0","NUMPAD_1","NUMPAD_2","NUMPAD_3","NUMPAD_4","NUMPAD_5","NUMPAD_6","NUMPAD_7","NUMPAD_8","NUMPAD_9","MULTIPLY","ADD",null,"SUBTRACT","DECIMAL_POINT","DIVIDE","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"NUM_LOCK","SCROLL_LOCK",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"SEMICOLON","EQUALS","COMMA","DASH","PERIOD","FORWARD_SLASH","GRAVE_ACCENT",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"OPEN_BRACKET","BACK_SLASH","CLOSE_BRACKET","QUOTE"],_cbs:{},_init:function(){if(!CT.key._initialized){CT.key._initialized=true;window.onkeyup=CT.key._onUp;}},_onUp:function(a){a=a||window.event;var b=a.keyCode||a.which,c=CT.key._codes[b];CT.key._cbs[c]&&CT.key._cbs[c]();},on:function(a,b){CT.key._init();CT.key._cbs[a]=b;}};;window.CT.mobile=window.CT.mobile||{};CT.mobile={"options":{"true":["mobile","stretched"],"false":["normal","stretched"]},"fitNode":function(a,b,c,d){var e,f=CT.align.width()-10,g=a&&CT.align.offset(a);CT.dom.ALLNODE.mobileNode=a;if(CT.dom.ALLNODE._mode=="mobile")e="scale("+(f/a.clientWidth)+") translate(-"+g.left+"px,-"+g.top+"px)";else e="scale("+(f/CT.dom.ALLNODE.clientWidth)+")";CT.trans.setVenderPrefixed(CT.dom.ALLNODE,"transform-origin",c?c:(f<CT.dom.ALLNODE.clientWidth?"0% 0%":"50% 0%"));CT.trans.trans({node:CT.dom.ALLNODE,property:"transform",value:b&&b||e,duration:1000,prefix:true,cb:function(){a&&a.scrollIntoView(true,{"behavior":"smooth"});d&&d();}});},"fitAndSnap":function(a,b){if(CT.dom.ALLNODE.mobileNode)CT.dom.ALLNODE.mobileNode.scrollIntoView(true,{"behavior":"smooth"});CT.mobile.fitNode(a,null,null,b);},"mobileSnap":function(a){if(CT.dom.ALLNODE&&CT.dom.ALLNODE._mode=="mobile")CT.mobile.fitAndSnap(CT.dom.ALLNODE._mobileDefault,a);},"getMobileNode":function(a){if(a.id)return document.getElementById(a.id);else{var b=(CT.mobile.page&&CT.mobile.page[a.name])?CT.mobile.page[a.name]:a.firstClass;return document.getElementsByClassName(b)[0];}},"mobileMenuLink":function(a){return CT.dom.labeledImage("/img/icons/"+a.icon+".png",a.page&&(a.page+".html"),a.name||a.page,a.name||a.page,"centeredimg","round bordered padded","centered nowrap small",false,(a.id||a.firstClass)&&function(){CT.dom.ALLNODE.toggleMobileMenu();CT.mobile.fitAndSnap(CT.mobile.getMobileNode(a));});},"initMobileMenus":function(a,b,c){a.tops=CT.dom.node(null,null,"button_row top_out","top_buttons");a.bottoms=CT.dom.node(null,null,"button_row bottom_out","bottom_buttons");var d=CT.dom.field("mobile_search");a.tops.appendChild(CT.dom.node(CT.dom.node([CT.dom.node("CAN Smart Search"),d],"div","round bordered padded","mobile_search_node"),"label",null,null,{"for":"mobile_search","htmlFor":"mobile_search"}));(CT.mobile.page&&CT.mobile.page.top||CT.mobile.menus.top).forEach(function(b){a.tops.appendChild(CT.mobile.mobileMenuLink(b));});CT.mobile.menus.bottom.forEach(function(b){a.bottoms.appendChild(CT.mobile.mobileMenuLink(b));});a.bottoms.appendChild(CT.mobile.mobileMenuLink(CT.mobile.menus.alternatives[b?"participate":"login"]));CT.dom.inputEnterCallback(d,c);CT.dom.blurField(d);document.body.appendChild(a.tops);document.body.appendChild(a.bottoms);},"_mset":function(){var a=CT.dom.ALLNODE;return CT.mobile.options[(!!(a._mobile&&a._mobileDefault)).toString()];},"isMobile":function(){return CT.dom.ALLNODE._mobile;},"initResizer":function(a,b,c,d,e){CT.mobile.menus=c;CT.mobile.page=d;var f,g,h,i=CT.dom.ALLNODE,j=function(){return CT.mobile._mset()[i._mindex];};var k=function(){var a=function(a){var b=i.mobileNode||i;if(b.getBoundingClientRect().bottom<CT.align.height())b.scrollIntoView(false,{"behavior":"smooth"});};window.onscroll=function(b){setTimeout(a,500);setTimeout(a,1000);setTimeout(a,2000);setTimeout(a,3000);};var b;window.addEventListener('touchstart',function(a){b=true;});window.addEventListener('touchmove',function(a){if(b){a.preventDefault();b=false;}else window.onscroll&&window.onscroll();});};i._mobileDefault=i.mobileNode=CT.mobile.getMobileNode((d&&d.top||c.top)[1]);i._mode=j();i._mindex=0;i._otherMode=function(){return CT.mobile._mset()[(i._mindex+1)%2];};i._swapMode=function(){i._mindex=i._mindex?0:1;setTimeout(function(){var a=document.getElementsByTagName("meta");for(var b=0;b<a.length;b++)if(a[b].name=="viewport"){a[b].content="width=device-width, initial-scale=1.0"+((i._mode=="mobile")?", min-scale=1.0, max-scale=1.0, user-scalable=no":"");break;}},200);i.resize();};i.toggleMobileMenu=function(){if(h._on){h.tops.className="button_row top_out";h.bottoms.className="button_row bottom_out";}else{h.tops.className="button_row";h.bottoms.className="button_row";}h._on=!h._on;};f=b[i._otherMode()];g=CT.dom.img(f.img,null,i._swapMode,null,null,f.alt,"resize_btn","round bordered padded");h=CT.dom.img("/img/mobile-menu.png",null,i.toggleMobileMenu,null,null,"Mobile Menu","mobile_menu_btn","round bordered padded");i.resize=function(){i._mobile=CT.info.mobile||CT.align.width()<=720;i._mode=j();if(i._mode=="normal")CT.mobile.fitNode(null,"scale(1)","50% 0%");else if(i._mode=="stretched")CT.mobile.fitAndSnap(i);else CT.mobile.fitAndSnap(i._mobileDefault);if(i._mode=="mobile"){h.style.display="block";i.chatBlock&&i.chatBlock();}else{h.style.display="none";if(h._on)h.onclick();}var a=i._otherMode();g.title=g.alt=b[a].alt;g.firstChild.firstChild.src=b[a].img;};document.body.appendChild(g);document.body.appendChild(h);CT.mobile.initMobileMenus(h,a,e);i.resize();k();}};;window.CT.modal=window.CT.modal||{};CT.modal._defaults={Modal:{className:"basicpopup",transition:"none",center:true,noClose:false,slide:{origin:"top"}},LightBox:{className:"backdrop",transition:"fade",caption:"",noClose:true},Prompt:{style:"string",prompt:"",data:[]}};CT.modal.Modal=CT.Class({CLASSNAME:"CT.modal.Modal",visible:false,setup:{_centerv:function(a){var b=a.clientHeight||CT.align.height();b-=this.node.clientHeight;return b/2;},_centerh:function(a){var b=a.clientWidth||CT.align.width();b-=this.node.clientWidth;return b/2;},_fallbacks:function(a){var b=this.node;if(!b.style.top&&!b.style.bottom)b.style.top=this.setup._centerv(a)+"px";if(!b.style.left&&!b.style.right)b.style.left=this.setup._centerh(a)+"px";},_add:function(a,b){var c=this.node;a=(a instanceof Node)?a:document.body;CT.dom.addContent(a,c);this.opts.center&&!b&&this.setup._fallbacks(a);},none:function(){var a=this.node;a.show=this.setup._add;a.hide=function(){CT.dom.remove(a);};},fade:function(){var a=this.node,b=this.setup._add;a.show=function(c){a.style.opacity=0;b(c);setTimeout(function(){CT.trans.trans({node:a,property:"opacity",value:1});},100);};a.hide=function(){CT.trans.trans({node:a,property:"opacity",value:0,cb:function(){CT.dom.remove(a);}});};},slide:function(){var a=this.node,b=this.setup._add,c=this.opts.slide.origin,d=this.opts.center,e=this.setup._centerv,f=this.setup._centerh,g=this.setup._fallbacks,h=false,i=false;var j=function(b){b=(b instanceof Node)?b:document.body;["top","bottom"].forEach(function(f,g){if(c.startsWith(f)){a.style[f]=-a.clientHeight+"px";a._vout={node:a,property:f,value:a.style[f]};a._vin={node:a,property:f,value:(d?e(b):0)+"px"};h=true;}});["left","right"].forEach(function(e,g){if(c.endsWith(e)){a.style[e]=-a.clientWidth+"px";a._hout={node:a,property:e,value:a.style[e]};a._hin={node:a,property:e,value:(d?f(b):0)+"px"};i=true;}});g(b);};a.show=function(c){b(c,true);j(c);setTimeout(function(){h&&CT.trans.trans(a._vin);i&&CT.trans.trans(a._hin);},100);};a.hide=function(){h&&CT.trans.trans(a._vout);i&&CT.trans.trans(a._hout);CT.trans.trans({cb:function(){CT.dom.remove(a);}});};}},on:{show:function(){},hide:function(){}},hide:function(){this.node.hide();this.visible=false;this.on.hide();},_show:function(a){this.node.show(a);this.visible=true;this.on.show();},show:function(a){setTimeout(this._show,0,a);},showHide:function(){this.visible?this.hide():this.show();},addClose:function(){this.add(CT.dom.node(CT.dom.link("X",this.hide),"div","right pointer"));},build:function(){if(!this.opts.noClose)this.addClose();},clear:function(){this.node.innerHTML="";},add:function(a){CT.dom.addContent(this.node,a);},set:function(a,b){this.clear();b&&this.addClose();this.add(a);},_buildContent:function(){var a=this.opts,b={};["top","bottom","right","left"].forEach(function(c){if(c in a.slide)b[c]=a.slide[c];});this.node=CT.dom.node("","div",a.className,null,null,b);this.node.modal=this;this.setup[a.transition]();this.build();if(a.content||a.node)this.add(a.content||a.node);},init:function(a){this.opts=CT.merge(a,CT.modal._defaults.Modal);setTimeout(this._buildContent);}});CT.modal.LightBox=CT.Class({init:function(a){this.opts=CT.merge(a,CT.modal._defaults.LightBox,CT.modal._defaults.Modal,{content:CT.dom.node(CT.dom.node(this.opts.caption,"div","biggest bold padded round translucent full-center white grayback pointer hoverglow"),"div","backdrop-img filler","",{onclick:this.hide},{backgroundImage:"url("+this.opts.img+")"})});}},CT.modal.Modal);CT.modal.Prompt=CT.Class({CLASSNAME:"CT.modal.Prompt",_input:{string:function(){if(this.opts.autocomplete)return CT.autocomplete.DBGuesser({input:CT.dom.field(),tapCb:this.submitAC,property:this.opts.autocomplete.property,modelName:this.opts.autocomplete.modelName}).input;else return CT.dom.smartField(this.submit);},password:function(){return CT.dom.smartField(this.submit,null,null,null,"password");},"single-choice":function(a){return CT.dom.choices(a);},"multiple-choice":function(a){return CT.dom.choices(a,true);}},on:{show:function(){this.input.focus();},hide:function(){}},submitAC:function(a){this.opts.cb(a);this.hide();},submit:function(){this.opts.cb(this.input.value);this.hide();},build:function(){this.input=this._input[this.opts.style](this.opts.data);this.node.appendChild(CT.dom.node(this.opts.prompt));this.node.appendChild(this.input);this.node.appendChild(CT.dom.button("Continue",this.submit));this.node.appendChild(CT.dom.button("Cancel",this.hide));},init:function(a){this.opts=CT.merge(this.opts,a,CT.modal._defaults.Prompt,CT.modal._defaults.Modal);}},CT.modal.Modal);;window.CT.panel=window.CT.panel||{};CT.panel={"lastClicked":{},"trigger":function(a,b){var c=CT.dom.node(CT.dom.link(a.label||a.title,function(){CT.dom.each(c.parentNode,function(a){a.className=(a==c)?"activetab":"";});b(a);}));return c;},"triggerList":function(a,b,c){a.forEach(function(a){c.appendChild(CT.panel.trigger(a,b));});},"swap":function(a,b,c,d){c=c||"sb";a=a.replace(/ /g,"");var e=CT.dom.className(c+"panel");for(var f=0;f<e.length;f++)e[f].className=c+"panel hidden";CT.dom.id(c+"panel"+a).className=c+"panel";if(b){var g=CT.dom.id(c+"panel"+a+"Side");if(g)g.className=c+"panel";var h=CT.dom.id(c+"panel"+a+"Side2");if(h)h.className=c+"panel";}if(!d)CT.panel.select(a,c);},"drill":function(a){for(var b in a)CT.panel.swap(a[b],false,b);},"select":function(a,b){b=b||"sb";var c=CT.dom.className(b+"item");for(var d=0;d<c.length;d++)c[d].className=c[d].className.replace(" activetab","");if(a){CT.dom.id(b+"item"+a,true).className+=" activetab";CT.panel.lastClicked[b]=a;}CT.mobile&&CT.mobile.mobileSnap();},"selectLister":function(a,b,c){if(b)CT.dom.id("ll"+b).className="pointer";var d=CT.dom.id("ll"+a);d.className="pointer activetab";if(c)d.firstChild.innerHTML=c;CT.mobile&&CT.mobile.mobileSnap();},"add":function(a,b,c,d,e,f,g,h){f=f||a.replace(/ /g,"");c=c||"sb";if(!CT.dom.id(c+"panel"+f)){var i=CT.dom.node("","div",c+"panel",c+"panel"+f);i.appendChild(CT.dom.node(a,"div","bigger blue bold bottompadded"));i.appendChild(CT.dom.node("","div","",c+"content"+f));(e||CT.dom.id(c+"panels")).appendChild(i);}var j=CT.dom.id(c+"item"+f);if(j)j.style.display="block";else{d=d||CT.dom.id(c+"items");var k=function(){CT.panel.swap(f,b,c);h&&h();};if(g)d.appendChild(CT.dom.node(CT.dom.img(g,null,k),"div","lfloat shiftleft"));d.appendChild(CT.dom.node(CT.dom.link(a,k),"div",c+"item pointer",c+"item"+f));if(g)d.appendChild(CT.dom.node("","div","clearnode"));}},"rename":function(a,b,c,d){c=c||"sb";var e=a.replace(/ /g,""),f=b.replace(/ /g,""),g=CT.dom.id(c+"item"+e),h=CT.dom.id(c+"panel"+e);g.id=c+"item"+f;h.id=c+"panel"+f;g.firstChild.innerHTML=h.firstChild.innerHTML=b;if(d){var i=CT.dom.id(d+"item"+e);i.id=f;i.firstChild.innerHTML=b;}},"remove":function(a,b){var c=a.replace(/ /g,"");var d=CT.dom.id(b+"panel"+c);if(d)d.style.display="none";var e=CT.dom.id(b+"item"+c);if(e)e.style.display="none";},"load":function(a,b,c,d,e,f,g,h,i,j){c=c||"sb";if(!h)(d||CT.dom.id(c+"items")).innerHTML="";for(var k=0;k<a.length;k++)CT.panel.add(a[k],b,c,d,e,f&&f[k]||null,g&&g[k]||null,j&&j[k]||null);if(a.length&&(i||(!d&&!h)))CT.panel.swap(a[0],b,c);},"simple":function(a,b,c,d,e){CT.panel.load(a,null,b,c,d,null,null,null,true,e);},"pager":function(a,b,c,d,e,f){var g=f||("p"+CT.Pager._id),h=CT.dom.node(null,null,e,g+"panels"),i=CT.dom.node(),j=new CT.Pager(function(b){var c=b.map(function(a){return a.label;});CT.panel.simple(c,g,i,h);b.forEach(function(b){CT.dom.setContent(CT.dom.id(g+"content"+b.label.replace(/ /g,""),true),a(b));});return i;},b,c,d,g+"items"),k=CT.dom.node([j.node,h]);k.pager=j;return k;},"alternatebg":function(a,b,c){a=a||document.getElementById("sbitems");if(b){var d=1;for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(f.className.indexOf("lfloat")==-1&&f.className.indexOf("clearnode")==-1){if(c&&f.nodeName=="BR"){d=1;continue;}if(d==1)f.style.background="#899fb0";d*=-1;}}}else for(var e=0;e<a.childNodes.length;e+=2)a.childNodes[e].style.background="#899fb0";}};;window.CT.parse=window.CT.parse||{};CT.parse={"_linkProcessor":null,"_NUMS":'0123456789',"imgTypes":[".gif",".GIF",".png",".PNG",".jpg",".JPG","jpeg","JPEG"],"setLinkProcessor":function(a){CT.parse._linkProcessor=a;},"breakurl":function(a){return a.replace(/&/g,"&&#8203;").replace(/\//g,"/&#8203;").replace(/_/g,"_&#8203;");},"url2link":function(a,b){var c=a;if(c.slice(0,7)=="http://")a=a.slice(7);else if(c.slice(0,8)=="https://")a=a.slice(8);else c="http://"+c;return '<a target="_blank" href='+c+'>'+(b||CT.parse.breakurl(a))+"</a>";},"processLink":function(a,b){var c=a.slice(-4);if(CT.parse.imgTypes.indexOf(c)!=-1)return '<img src='+a+'>';return CT.parse._linkProcessor&&CT.parse._linkProcessor(a,b)||CT.parse.url2link(a);},"validEmail":function(a){var b=a.indexOf('@',1);var c=a.indexOf('.',b);if(b==-1||c==-1||c==a.length-1||b+2>c)return false;return true;},"validPassword":function(a){return a&&a.length>5;},"numOnly":function(a,b,c){a.onkeyup=function(){var d,e,f="",g=false;for(d=0;d<a.value.length;d++){e=a.value.charAt(d);if(b&&!g&&e==".")g=true;else if(!(!c&&!d&&e=="-")&&(CT.parse._NUMS.indexOf(e)==-1))continue;f+=e;}a.value=f;};return a;},"capitalize":function(a){return a.slice(0,1).toUpperCase()+a.slice(1);},"toCaps":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(CT.parse.capitalize(a[c]));return b;},"key2title":function(a){return CT.parse.toCaps(a.split("_")).join(" ");},"words2title":function(a){return CT.parse.toCaps(a.split(" ")).join(" ");},"keys2titles":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(CT.parse.key2title(a[c]));return b;},"month2num":function(a){return CT.dom._monthnames.indexOf(a)+1;},"stripLast":function(a){var b="",c=a.charAt(a.length-1);while(['.',',',':',';',')',']'].indexOf(c)!=-1){a=a.slice(0,a.length-1);b=c+b;c=a.charAt(a.length-1);}return [b,a];},"stripToNums":function(a){a=a||"";var b='';for(var c=0;c<a.length;c++)if(CT.parse._NUMS.indexOf(a.charAt(c))!=-1)b+=a.charAt(c);return b;},"stripToZip":function(a){var b=CT.parse.stripToNums(a);if(b.length<5)return "";return b.slice(0,5);},"stripToPhone":function(a){var b=CT.parse.stripToNums(a);if(b.length<10)return "";return b.slice(0,10);},"formatPhone":function(a){var b=CT.parse.stripToPhone(a);return b.slice(0,3)+"-"+b.slice(3,6)+"-"+b.slice(6);},"formatPhoneLink":function(a){var b=CT.parse.formatPhone(a);return "<a href='tel:+1"+b+"'>"+b+"</a>";},"shortened":function(a,b){b=b||500;if(a.length<b)return a;return a.slice(0,b)+' ...';},"sanitize":function(a){var b="<scr"+"ipt";var c="</sc"+"ript>";var d=a.indexOf(b);while(d!=-1){var e=a.indexOf(c,d);if(e==-1)e=a.length;a=a.slice(0,d)+a.slice(e+9,a.length);d=a.indexOf(b);}return a.replace(/^\s+|\s+$/g,"");},"_stampString":function(a,b){if(!a)return false;return a+" "+b+(a==1?"":"s");},"_ts_server_offset":0,"set_ts_server_offset":function(a){CT.parse._ts_server_offset=a;},"timeStamp":function(a){var b=new Date();b.setHours(b.getHours()+(b.getTimezoneOffset()/60)-CT.parse._ts_server_offset);var c=new Date(a.replace('T',' ').replace(/-/g,'/')),d=(b-c)/1000,e=~~(d/60),f=~~(e/60),g=~~(f/24);return(CT.parse._stampString(g,"day")||CT.parse._stampString(f,"hour")||CT.parse._stampString(e,"min")||"moments")+" ago";},"process":function(a,b,c){if(!a)return "";var d=a.replace(new RegExp(String.fromCharCode(10),'g'),' ').replace(new RegExp(String.fromCharCode(13),'g'),' ').replace(/</g," <").replace(/>/g,"> ").replace(/&nbsp;/g," ").replace(/  /g,' ');var e=d.match(/\d{3}-\d{3}-\d{4}/g);if(e)e.forEach(function(a){var b=d.indexOf(a);var c=d.charAt(b-1);if(c!=">"&&c!=":"&&d.slice(b-2,b)!="+1")d=d.replace(a,CT.parse.formatPhoneLink(a));});var f=d.trim().split(" ");for(var g=0;g<f.length;g++){var h=f[g];if(h.indexOf(":")==-1&&CT.parse.validEmail(h)){f[g]="<a href='mailto:"+h+"'>"+h+"</a>";continue;}var i=h.indexOf("https://");if(i==-1)i=h.indexOf("http://");if(i!=-1&&h[i-1]!='"'){var j=h.slice(0,i);h=h.slice(i);var k="";var l=h.indexOf('<');if(l!=-1){k=h.slice(l);h=h.slice(0,l);}var m=CT.parse.stripLast(h),n=m[0],h=m[1];f[g]=j+(b?CT.parse.url2link:CT.parse.processLink)(h,c)+n+k;}}return f.join(" ").replace(/ <\//g,"</");}};;window.CT.pubsub=window.CT.pubsub||{};CT.pubsub={"_":{"ws":null,"args":null,"open":false,"initialized":false,"reconnect":true,"reconnect_interval":250,"log":CT.log.getLogger("CT.pubsub"),"queue":[],"channels":{},"cb":{"snapshot":CT.log.getLogger("CT.pubsub|snapshot"),"pm":CT.log.getLogger("CT.pubsub|pm"),"message":CT.log.getLogger("CT.pubsub|message"),"subscribe":CT.log.getLogger("CT.pubsub|subscribe"),"join":CT.log.getLogger("CT.pubsub|join"),"leave":CT.log.getLogger("CT.pubsub|leave"),"open":CT.log.getLogger("CT.pubsub|open"),"close":CT.log.getLogger("CT.pubsub|close"),"wserror":CT.log.getLogger("CT.pubsub|wserror"),"error":CT.log.getLogger("CT.pubsub|error")},"process":{"channel":function(a){CT.pubsub._.channels[a.channel]=a;CT.pubsub._.cb.subscribe(a);a.history.forEach(CT.pubsub._.process.publish);},"publish":function(a){CT.pubsub._.cb.message(a);},"subscribe":function(a){CT.pubsub._.cb.join(a.channel,a.user);CT.data.append(CT.pubsub._.channels[a.channel].presence,a.user);},"unsubscribe":function(a){CT.pubsub._.cb.leave(a.channel,a.user);CT.data.remove(CT.pubsub._.channels[a.channel].presence,a.user);},"pm":function(a){CT.pubsub._.cb.pm(a.message,a.user);},"error":function(a){CT.pubsub._.cb.error(a.message);},"snapshot":function(a){CT.pubsub._.cb.snapshot(a);}},"on":{"open":function(){CT.pubsub._.open=true;CT.pubsub._.reconnect_interval=250;CT.pubsub._.write({"action":"register","data":CT.pubsub._.args[2]});for(var a in CT.pubsub._.channels)CT.pubsub.subscribe(a);CT.pubsub._.queue.forEach(CT.pubsub._.write);CT.pubsub._.queue.length=0;CT.pubsub._.cb.open();},"close":function(){CT.pubsub._.open=false;CT.pubsub._.cb.close();if(CT.pubsub._.reconnect)CT.pubsub._.try_reconnect();},"error":function(){CT.pubsub._.cb.wserror();},"message":function(a){var b=JSON.parse(atob(a.data));CT.pubsub._.process[b.action](b.data);}},"write":function(a){if(CT.pubsub._.open){var b=JSON.stringify(a),c=btoa(b);CT.pubsub._.ws.send(c);}else CT.pubsub._.queue.push(a);},"try_reconnect":function(){var a=CT.pubsub._.reconnect_interval;CT.pubsub._.log("RECONNECT",a);setTimeout(function(){CT.pubsub.connect.apply(null,CT.pubsub._.args);},a);CT.pubsub._.reconnect_interval=Math.min(2*a,30000);}},"isInitialized":function(){return CT.pubsub._.initialized;},"set_reconnect":function(a){CT.pubsub._.reconnect=a;},"set_cb":function(a,b){CT.pubsub._.cb[a]=b;},"pm":function(a,b){CT.pubsub._.write({"action":"pm","data":{"user":a,"message":b}});},"publish":function(a,b){CT.pubsub._.write({"action":"publish","data":{"channel":a,"message":b}});},"subscribe":function(a){CT.pubsub._.write({"action":"subscribe","data":a});},"unsubscribe":function(a){CT.pubsub._.write({"action":"unsubscribe","data":a});},"connect":function(a,b,c){CT.pubsub._.args=arguments;CT.pubsub._.initialized=true;CT.pubsub._.ws=new WebSocket("ws://"+a+":"+b);for(var d in CT.pubsub._.on)CT.pubsub._.ws["on"+d]=CT.pubsub._.on[d];window.onbeforeunload=function(){CT.pubsub._.write({"action":"close"});};}};;window.CT.recaptcha=window.CT.recaptcha||{};CT.recaptcha={"build":function(a,b,c,d,e){CT.require("CT.lib.recaptcha_ajax",true);try{Recaptcha.create(a,b);d&&setTimeout(function(){var a=document.getElementById(e||"recaptcha_response_field");a&&CT.dom.inputEnterCallback(a,d);},1000);}catch(f){c&&c(f)||alert(f);}},"submit":function(a,b,c,d){var e=Recaptcha.get_response();if(e.length<3)alert("don't forget to fill in the CAPTCHA! you are human, right?");else{d=d||{};d.cresponse=e;d.cchallenge=Recaptcha.get_challenge();CT.net.post(c||"/recaptcha",d,null,a,function(a){if(a.trim()=="incorrect-captcha-sol")a="That's not quite right! Please try again.";alert(a);Recaptcha.reload();});b&&b();}}};;window.CT.slider=window.CT.slider||{};CT.slider={other_dim:{height:"width",width:"height"},other_orientation:{vertical:"horizontal",horizontal:"vertical"},orientation2dim:{vertical:"height",horizontal:"width"},orientation2abs:{vertical:{forward:"up",backward:"down"},horizontal:{forward:"left",backward:"right"}}};CT.slider.Slider=CT.Class({CLASSNAME:"CT.slider.Slider",init:function(a){this.opts=a=CT.merge(a,{frames:[],keys:true,autoSlideInterval:5000,autoSlide:true,visible:true,navButtons:true,startFrame:null,pan:true,parent:document.body,mode:"peekaboo",orientation:"horizontal",arrowPosition:"middle",bubblePosition:"bottom"});this.jumpers={};this.dimension=CT.slider.orientation2dim[a.orientation];this.circlesContainer=CT.dom.node("","div","carousel-order-indicator "+a.bubblePosition);var b="slider-btn hoverglow pointer sb-"+this.opts.arrowPosition+" sb-"+a.orientation;if(!a.navButtons){b+=" hider";this.circlesContainer.classList.add("hider");}this.prevButton=CT.dom.node(CT.dom.node(CT.dom.node("<","span")),"div",b+" prv hidden");this.nextButton=CT.dom.node(CT.dom.node(CT.dom.node(">","span")),"div",b+" nxt"+(a.frames.length<2?" hidden":""));this.index=this.pos=0;this.container=CT.dom.node("","div","carousel-container full"+CT.slider.other_dim[this.dimension]);this.node=CT.dom.node([this.container,this.circlesContainer,this.prevButton,this.nextButton],"div","carousel fullwidth fullheight"+(a.visible?"":" hider"));this.opts.parent.appendChild(this.node);this.opts.frames.forEach(this.addFrame);CT.gesture.listen("tap",this.prevButton,this.prevButtonCallback);CT.gesture.listen("tap",this.nextButton,this.nextButtonCallback);if(a.keys){CT.key.on(a.orientation=="horizontal"?"LEFT":"UP",this.prevButtonCallback);CT.key.on(a.orientation=="horizontal"?"RIGHT":"DOWN",this.nextButtonCallback);}this.dragOpts={constraint:CT.slider.other_orientation[a.orientation],up:this.updatePosition,interval:"auto"};CT.drag.makeDraggable(this.container,this.dragOpts);if(a.autoSlideInterval&&a.autoSlide&&!a.startFrame)this.resume();CT.gesture.listen("down",this.container,this.pause);this.opts.parent.onresize=this.trans;this._reflow();if(a.startFrame in this.jumpers)this.jumpers[a.startFrame]();},showNav:function(){if(this.opts.navButtons){CT.trans.translate(this.prevButton,{x:0});CT.trans.translate(this.nextButton,{x:0});CT.trans.translate(this.circlesContainer,{y:0});}if(this.opts.parent.slider)this.opts.parent.slider.showNav();},hideNav:function(){if(this.opts.navButtons){CT.trans.translate(this.prevButton,{x:-200});CT.trans.translate(this.nextButton,{x:200});CT.trans.translate(this.circlesContainer,{y:(this.opts.bubblePosition=="top")&&-100||100});}if(this.opts.parent.slider)this.opts.parent.slider.hideNav();},show:function(){this.node.classList.remove("hider");},hide:function(){this.node.classList.add("hider");},_reflow:function(){CT.dom.mod({targets:this.container.childNodes,property:this.dimension,value:(100/this.container.childNodes.length)+"%"});this.container.style[this.dimension]=(this.opts.frames.length*100)+"%";},resume:function(){if(!this._autoSlide)this._autoSlide=setInterval(this._autoSlideCallback,this.opts.autoSlideInterval);},pause:function(){if(this._autoSlide){clearInterval(this._autoSlide);this._autoSlide=null;}this.opts.parent.slider&&this.opts.parent.slider.pause();},addFrame:function(a,b){if(typeof a=="string")a={img:a};var c=CT.dom.node(a.label,"div","hoverglow pointer indicator-circle "+(a.label?"labeled":"unlabeled")+"-circle"),d=this.jumpers[a.label||b]=this.circleJump(b);CT.gesture.listen("tap",c,d);this.circlesContainer.appendChild(c);this.container.appendChild(new CT.slider.Frame(a,this).node);if(b==0){c.className+=" active-circle";this.activeCircle=c;if(!this.opts.parent.slider)setTimeout(this.container.firstChild.frame.on.show,500);}if(b==undefined)this._reflow();},circleJump:function(a){var b=function(){this.pause();this.updateIndicator(a);this.trans();}.bind(this);return b;},updateIndicator:function(a){this.container.childNodes[this.index].frame.on.hide();this.index=a;this.container.childNodes[this.index].frame.on.show();this.activeCircle.classList.remove('active-circle');this.activeCircle=this.circlesContainer.childNodes[a];this.activeCircle.classList.add('active-circle');CT.dom[this.activeCircle.nextSibling?"show":"hide"](this.nextButton);CT.dom[this.activeCircle.previousSibling?"show":"hide"](this.prevButton);},updatePosition:function(a,b){var c=this.index,d=CT.drag._.dir2abs[a];if(CT.drag._.direction2orientation[a]==this.opts.orientation){if(d=="forward"&&(b||this.activeCircle.nextSibling))c+=1;else if(d=="backward"&&(b||this.activeCircle.previousSibling))c-=1;this.updateIndicator(c%this.circlesContainer.childNodes.length);}else if(this.opts.parent.slider)this.opts.parent.slider.shift(a,b);},trans:function(){var a={},b=CT.drag._.orientation2axis[this.opts.orientation];a[b]=this.container[b+"Drag"]=-this.index*CT.align[this.dimension](this.container)/this.container.childNodes.length;CT.trans.translate(this.container,a);},shift:function(a,b){this.updatePosition(a,b);this.trans();},_autoSlideCallback:function(){this.shift(CT.slider.orientation2abs[this.opts.orientation].forward,true);},prevButtonCallback:function(){this.pause();this.shift(CT.slider.orientation2abs[this.opts.orientation].backward);},nextButtonCallback:function(){this.pause();this.shift(CT.slider.orientation2abs[this.opts.orientation].forward);}});CT.slider.Frame=CT.Class({CLASSNAME:"CT.slider.Frame",on:{show:function(){},hide:function(){}},peekaboo:function(){var a=this.opts,b=this.node,c=this.slider,d,e,f=CT.dom.node(a.content,"div","big carousel-content-full"),g=CT.dom.node(null,"div","carousel-content-image",null,null,{backgroundImage:"url("+a.img+")"}),h=[g,f];var i=function(){c.pause();b._retracted=!b._retracted;if(b._retracted){CT.trans.resize(g,{width:"40%",height:"30%",cb:function(){if(d)d.style.zIndex=200;}});CT.trans.trans({node:j,property:"left",value:"10px"});CT.trans.trans({node:j,property:"top",value:"0px"});c.hideNav();}else{if(d)d.style.zIndex=0;CT.trans.resize(g,{width:"100%",height:"100%"});CT.trans.trans({node:j,property:"left",value:"22.5%"});CT.trans.trans({node:j,property:"top",value:"100px"});c.showNav();}};if(c.opts.pan){g.classList.add("bp-left");g.controller=CT.trans.pan(g,{duration:a.panDuration||c.opts.autoSlideInterval},true);}if(a.tab)e=new CT.modal.Modal({content:a.tab.content,center:false,noClose:true,className:"basicpopup rounder translucent above shiftall",transition:"slide",slide:{origin:a.tab.origin}});if(a.title||a.blurb){var j=CT.dom.node([CT.dom.node(a.title,"div","biggest"),CT.dom.node(a.blurb,"div","bigger")],"div","carousel-content-teaser transparent hoverglow pointer");h.push(j);}if(a.pulse){d=CT.dom.img(a.pulse,"carousel-pulse pointer");d.controller=CT.trans.pulse(d,null,true);CT.gesture.listen("tap",d,i);h.push(d);}this.on.show=function(){if(a.title||a.blurb)CT.trans.fadeIn(j);if(c.opts.keys)CT.key.on("ENTER",i);if(c.opts.pan)g.controller.resume();if(a.pulse)d.controller.resume();if(a.tab)e.show();};this.on.hide=function(){if(a.title||a.blurb)CT.trans.fadeOut(j);if(b._retracted)i();if(c.opts.pan)g.controller.pause();if(a.pulse)d.controller.pause();if(a.tab)e.hide();};CT.dom.addEach(b,h);if(a.content)CT.gesture.listen("tap",j,i);},chunk:function(){var a=new CT.slider.Slider({parent:this.node,frames:this.opts.frames,autoSlide:false,orientation:CT.slider.other_orientation[this.slider.opts.orientation],arrowPosition:"bottom"}),b=this.slider;this.on.hide=function(){a.container.childNodes[a.index].frame.on.hide();};this.on.show=function(){a.container.childNodes[a.index].frame.on.show();if(b.opts.keys){CT.key.on(a.opts.orientation=="horizontal"?"LEFT":"UP",a.prevButtonCallback);CT.key.on(a.opts.orientation=="horizontal"?"RIGHT":"DOWN",a.nextButtonCallback);}};},menu:function(){var a=new CT.modal.Modal({transition:"slide",noClose:true,className:"round centered basicpopup above",content:this.opts.buttons.map(function(a){var b=CT.dom.node([CT.dom.node(a.label||a.page,"div","biggest bold bottombordered"),CT.dom.node(a.content)],"div","margined padded bordered round hoverglow pointer inline-block");b.onclick=function(){location="/"+a.page+".html";};return b;})});var b=function(a){var b=[];for(var c=0;c<5;c++)b.push(CT.dom.img(a));return b;};this.node.appendChild(CT.dom.marquee(b(this.opts.logo),"abs top0 h20p fullwidth"));this.node.appendChild(CT.dom.marquee(b(this.opts.logo),"abs bottom0 h20p fullwidth","right"));this.on.hide=a.hide;this.on.show=a.show;},profile:function(){var a=CT.dom.node(null,"div","w2-3 h4-5",null,null,{backgroundImage:"url("+this.opts.img+")"}),b=CT.dom.node(null,"div","centered");if(this.slider.opts.pan){a.classList.add("bp-right");a.controller=CT.trans.pan(a,{duration:this.opts.panDuration||this.slider.opts.autoSlideInterval},true);this.on.hide=a.controller.pause;this.on.show=a.controller.resume;}for(var c in this.opts.buttons)b.appendChild(CT.dom.button(c,this.opts.buttons[c],"round padded margined"));this.node.appendChild(CT.dom.node([CT.dom.node(this.opts.name,"div","biggest"),CT.dom.node(this.opts.description)],"div","right thirdwidth"));this.node.appendChild(a);this.node.appendChild(b);},init:function(a,b){this.opts=a;this.node=CT.dom.node("","div","carousel-content-container full"+CT.slider.other_dim[b.dimension]);this.node.frame=this;this.slider=this.node.slider=b;if(b.dimension=="width")this.node.style.display="inline-block";this[a.mode||b.opts.mode]();}});;window.CT.storage=window.CT.storage||{};CT.storage={"init":function(a){if(!CT.storage.opts){CT.storage.opts=CT.merge(a,{"backend":localStorage,"json":true,"compress":true});if(CT.storage.opts.compress)CT.require("CT.lib.lz-string",true);}return CT.storage.opts;},"_jsp":function(a){try{return JSON.parse(a);}catch(b){return null;}},"get":function(a){var b=CT.storage.init(),c=b.backend.getItem(a);if(b.compress)c=LZString.decompress(c);return b.json?CT.storage._jsp(c):c;},"set":function(a,b){var c=CT.storage.init();if(c.json)b=JSON.stringify(b);if(c.compress)b=LZString.compress(b);c.backend.setItem(a,b);},"clear":function(){CT.storage.init().backend.clear();}};;window.CT.trans=window.CT.trans||{};CT.trans={_:{vender_prefixes:["-webkit-","-moz-","-ms-","-o-",""],tswap:{transform:"-webkit-transform"},enames:["webkitTransitionEnd","mozTransitionEnd","oTransitionEnd","transitionend"],defaults:{trans:{duration:500,property:"*",ease:"ease-in-out"},rotate:{degrees:180,duration:1000,property:"transform",ease:"linear",prefix:true},translate:{duration:300,property:"transform",ease:"linear",prefix:true,x:0,y:0,z:0},pan:{duration:5000,property:"background-position",ease:"linear",value:"right bottom"},resize:{duration:300,ease:"linear"},fadeIn:{duration:1600,property:"opacity",value:1},fadeOut:{duration:1600,property:"opacity",value:0},pulse:{wait:1000}}},setVenderPrefixed:function(a,b,c){for(var d=0;d<CT.trans._.vender_prefixes.length;d++)a.style[CT.trans._.vender_prefixes[d]+b]=c;},trans:function(a){a=CT.merge(a,CT.trans._.defaults.trans);if(a.node){var b=a.node.style.transition||"",c=(CT.trans._.tswap[a.property]||a.property)+" "+a.duration+"ms "+a.ease,d=b?(b+", "+c):c;CT.trans.setVenderPrefixed(a.node,"transition",d);}if(a.cb){var e,f=function(){a.node&&CT.trans.setVenderPrefixed(a.node,"transition",b);clearTimeout(e);e=null;if(a.node)CT.trans._.enames.forEach(function(b){a.node.removeEventListener(b,f,false);});a.cb();};if(a.node)CT.trans._.enames.forEach(function(b){a.node.addEventListener(b,f,false);});e=setTimeout(f,a.duration);}if(a.property&&a.property!="*")if(a.prefix)CT.trans.setVenderPrefixed(a.node,a.property,a.value);else a.node.style[a.property]=a.value;},rotate:function(a,b){b=CT.merge(b,CT.trans._.defaults.rotate);b.node=a;b.value="rotate("+b.degrees+"deg)";if(b.forever)b.cb=function(){b.degrees+=CT.trans._.defaults.rotate.degrees;CT.trans.rotate(a,b);};CT.trans.trans(b);},translate:function(a,b){b=CT.merge(b,CT.trans._.defaults.translate);b.node=a;b.value="translate3d("+b.x+"px,"+b.y+"px,"+b.z+"px)",CT.trans.trans(b);},pan:function(a,b,c){b=CT.merge(b,CT.trans._.defaults.pan);b.node=a;var d=new CT.trans.Controller(function(){b.value=b.value=="left top"?"right bottom":"left top";CT.trans.trans(b);});b.cb=d.tick;if(!c)CT.trans.trans(b);return d;},resize:function(a,b){var c=b.width,d=b.height,e=b.cb;delete b.width;delete b.height;delete b.cb;b.node=a;b=CT.merge(b,CT.trans._.defaults.resize);if(c)CT.trans.trans(CT.merge({property:"width",value:c},b));if(d)CT.trans.trans(CT.merge({property:"height",value:d},b));if(e)CT.trans.trans(CT.merge({cb:e},b));},fadeIn:function(a,b){b=CT.merge(b,CT.trans._.defaults.fadeIn);b.node=a;CT.trans.trans(b);},fadeOut:function(a,b){b=CT.merge(b,CT.trans._.defaults.fadeOut);b.node=a;CT.trans.trans(b);},pulse:function(a,b,c){b=CT.merge(b,CT.trans._.defaults.pulse);var d,e=new CT.trans.Controller(function(){d=!d;if(d)setTimeout(function(){CT.trans.fadeIn(a,b);},b.wait);else CT.trans.fadeOut(a,b);});b.cb=e.tick;if(!c)e.tick();return e;}};CT.trans.Controller=CT.Class({CLASSNAME:"CT.trans.Controller",pause:function(){this._paused=true;},resume:function(){this._paused=false;this.cb();},active:function(){return !this._paused;},tick:function(){this.active()&&this.cb();},init:function(a){this.cb=a;}});;window.CT.upload=window.CT.upload||{};CT.upload={"form":function(a,b,c,d){var e=CT.dom.node("","form");e.action="/upload";e.enctype="multipart/form-data";e.method="post";var f=CT.dom.field();f.type="hidden";f.name="uid";f.value=a;var g=CT.dom.field();g.type="hidden";g.name="key";if(b)g.value=b;var h=CT.dom.field();h.type="file";h.name="data";e.appendChild(f);e.appendChild(g);e.appendChild(h);if(c){h.size="10";e.appendChild(c);}if(d)h.size=d;return e;},"submit":function(a,b,c,d){CT.require("CT.lib.aim",true);AIM.submit(a,{'onComplete':function(a){var e=a.charAt(0);if(e=='0')(c||alert)(a.slice(1));else if(d)b(a.slice(2,-2));else b(a.slice(1));}});a.submit();}};;window.CT.video=window.CT.video||{};CT.video={"rawVidTypes":["mp4","ogg","webm"],"player2url":{"google":"video.google.com?docid=","youtube":"www.youtube.com/watch?v=","vimeo":"vimeo.com/","ustream":"www.ustream.tv/recorded/","mp4":"","ogg":"","webm":""},"embed_url":{"youtube":"http://www.youtube.com/embed/","vimeo":"//player.vimeo.com/video/"},"urlFromData":function(a,b){return a?("http://"+CT.video.player2url[a]+b):"";},"getQSParam":function(a,b){var c=a.indexOf(b+"=")+b.length+1,d=a.indexOf("&",c);if(d==-1)d=a.indexOf("#",c);if(d==-1)return a.slice(c);return a.slice(c,d);},"docidFromUrl":function(a){if(a.indexOf("video.google.com")!=-1)return CT.video.getQSParam(a,"docid");else if(a.indexOf("youtube.com")!=-1)return CT.video.getQSParam(a,"v");else if(a.indexOf("vimeo.com")!=-1)return a.slice(a.lastIndexOf('/')+1);else if(a.indexOf("ustream.tv/recorded/")!=-1)return a.split("recorded/")[1].split("?")[0];var b=a.split('.'),c=b[b.length-1];if(CT.video.rawVidTypes.indexOf(c)!=-1)return a.replace("http://","").replace("https://","");return "";},"playerFromUrl":function(a){if(a.indexOf("video.google.com")!=-1)return "google";if(a.indexOf("youtube.com")!=-1)return "youtube";if(a.indexOf("vimeo.com")!=-1)return "vimeo";if(a.indexOf("ustream.tv")!=-1)return "ustream";var b=a.split('.'),c=b[b.length-1];if(CT.video.rawVidTypes.indexOf(c)!=-1)return c;return "";},"videoData":function(a){var b=CT.video.playerFromUrl(a);return b?{player:b,docid:CT.video.docidFromUrl(a)}:null;},"embed":function(a,b){var c=b?375:400;var d=b?315:335;if(a.player=="google")return "<embed width="+c+" height="+d+" id=VideoPlayback src=http://video.google.com/googleplayer.swf?docid="+a.docid+"&hl=en&fs=true allowFullScreen=true allowScriptAccess=always type=application/x-shockwave-flash> </embed>";else if(a.player=="youtube"||a.player=="vimeo")return "<iframe src=\""+CT.video.embed_url[a.player]+a.docid+"?html5=1\" width="+c+" height="+d+" frameborder=0 webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>";else if(a.player=="ustream")return "<object type=application/x-shockwave-flash data=http://static-cdn1.ustream.tv/swf/live/viewerqos:21.swf width="+c+" height="+d+"id=utv"+a.docid+" name=utv"+a.docid+"><param name=flashvars value=autoplay=true&locale=en_US&referrer=http%3A%2F%2Fwww.ustream.tv%2Frecorded%2F"+a.docid+"%3Futm_campaign%3Dustre.am%26utm_source%3Dustre.am%2F%3A44gEy%26utm_medium%3Dsocial%26utm_content%3D20150324210416&autoResize=false&enablejsapi=true&sv=6&volume=1&ts=1427256261325&vid="+a.docid+"&loc="+a.docid+"&hasticket=false><param name=allowfullscreen value=true><param name=allowscriptaccess value=always><param name=bgcolor value=000000><param name=wmode value=transparent></object>";else if(CT.video.rawVidTypes.indexOf(a.player)!=-1)return "<video width="+c+" height="+d+" controls><source src=http://"+a.docid+" type=video/"+a.player+"></video>";else alert("unknown video player: "+a.player);}};;;window.CT.map=window.CT.map||{};CT.scriptImport("https://maps.googleapis.com/maps/api/js");window.CT.map.util=window.CT.map.util||{};CT.map.util={_try_limit:20,_llcache:CT.storage.get("addr2latlng")||{},_keys:[],_kindex:0,_get_res:function(a){var b={address:a},c=CT.map.util._keys[CT.map.util._kindex];if(c){b.key=c;CT.map.util._kindex+=1;}else CT.map.util._kindex=0;return CT.net.get("https://maps.googleapis.com/maps/api/geocode/json",b,true).results[0];},_try_a2ll:function(a){var b=0,c,d;while(b<CT.map.util._try_limit&&!c){c=CT.map.util._get_res(a);if(c)return c;b+=1;CT.log("CT.map.util.addr2latlng: can't find "+a+" - trying again! tries: "+b);}},_geo_fallback:{lat:37.75,lng:-122.45},setGeoKeys:function(a){CT.map.util._keys=a;},setGeoFallback:function(a){CT.map.util._geo_fallback=a;},getGeoFallback:function(){return CT.map.util._geo_fallback;},latlng:function(a){return a instanceof google.maps.LatLng?a:new google.maps.LatLng(a);},addr2latlng:function(a){var b=CT.map.util._llcache;if(!b[a]){b[a]=CT.map.util._try_a2ll(a).geometry.location;CT.storage.set("addr2latlng",b);}return b[a];},bounds:function(a,b){return new google.maps.LatLngBounds(CT.map.util.latlng(a),CT.map.util.latlng(b));}};;window.CT.map.Map=window.CT.map.Map||{};CT.map.Map=CT.Class({CLASSNAME:"CT.map.Map",markers:{},addTriggers:function(a,b,c,d,e){var f=this.addMarker;e=e||CT.dom.id("map"+b+"s");d&&e.appendChild(CT.panel.trigger({"title":"new "+b},d));CT.panel.triggerList(a.map(function(a){d=c(a);d.key=a.key;d.marker=f(d);return d;}),function(a){a.marker.showInfo();},e);},addMarker:function(a){var b=this.markers[a.key]=this.markers[a.key]||new CT.map.Marker(a);if(this.map)b.add(this.map);else this.opts.markers[a.key]=a;return b;},addMarkers:function(a){var b=this,c=[];a.forEach(function(a){c.push(b.addMarker(a));});return c;},clearMarkers:function(a){(Array.isArray(a)?a:Object.values(this.markers)).forEach(function(a){a.remove();});},geoJson:function(a){this.map.data.loadGeoJSON(a);},frame:function(a,b){var c=a.getPosition(),d=b.getPosition();this.map.fitBounds(CT.map.util.bounds({latitude:Math.min(c.lat(),d.lat()),longitude:Math.min(c.lng(),d.lng())},{latitude:Math.max(c.lat(),d.lat()),longitude:Math.max(c.lng(),d.lng())}));},_build:function(){var a;this.opts.center=CT.map.util.latlng(this.opts.center);this.map=new google.maps.Map(this.opts.node,this.opts);for(a in this.opts.markers)this.addMarker(this.opts.markers[a]);if(this.opts.geojson)this.geoJson(this.opts.geojson);this.refresh();this.map.setCenter(this.opts.center);},refresh:function(){google.maps.event.trigger(this.map,'resize');},_geoSucceed:function(a){this.opts.center={lat:a.coords.latitude,lng:a.coords.longitude};this._build();},_geoFail:function(){this.opts.center=CT.map.util.getGeoFallback();this._build();},init:function(a){this.opts=a=CT.merge(a,{zoom:12,disableDefaultUI:true,zoomControl:true,markers:{}});if(a.center)this._build();else navigator.geolocation.getCurrentPosition(this._geoSucceed,this._geoFail);}});;window.CT.map.Node=window.CT.map.Node||{};CT.map.Node=CT.Class({CLASSNAME:"CT.map.Node",_regEvt:function(a){if(this.opts.listeners[a])google.maps.event.addDomListener(this.content,a,this.opts.listeners[a]);},_add:function(){this.content=CT.dom.node(this.opts.content,"div",this.opts.className);this.projection=this.overlay.getProjection();CT.dom.setContent(this.overlay.getPanes().floatPane,this.content);Object.keys(this.opts.listeners).forEach(this._regEvt);},_remove:function(){google.maps.event.clearListeners(this.content);CT.dom.remove(this.content);this.content=null;},_draw:function(){if(!this.content||!this.opts.visible)return;var a=this.projection.fromLatLngToDivPixel(this.opts.position);this.content.style.left=a.x+"px";this.content.style.top=a.y+"px";},getPosition:function(){return this.opts.position;},setPosition:function(a){this.opts.position=a;this._draw();},setVisible:function(a){this.opts.visible=a;if(this.content){this.content.style.display=a?"block":"none";this._draw();}},setContent:function(a){this.opts.content=a;if(this.content)CT.dom.setContent(this.content,a);},setListeners:function(a){this.opts.listeners=a;if(this.content){google.maps.event.clearListeners(this.content);Object.keys(a).forEach(this._regEvt);}},clearListeners:function(){this.setListeners({});},addListener:function(a,b){this.opts.listeners[a]=b;this._regEvt(a);},addUpdater:function(a,b){this.opts.updaters[a]=b;},update:function(a){var b=this.opts=CT.merge(a,this.opts);if("visible" in a)this.setVisible(a.visible);if(a.position)this.setPosition(a.position);if(a.content)this.setContent(a.content);if(a.listeners)this.setListeners(a.listeners);Object.keys(b.updaters).forEach(function(c){if(c in a)b.updaters[c](a[c]);});},show:function(){this.overlay.setMap(this.opts.map);},hide:function(){this.overlay.setMap(null);},init:function(a){this.opts=a=CT.merge(a,{visible:true,updaters:{},listeners:{}});this.overlay=new google.maps.OverlayView();this.overlay.onAdd=this._add;this.overlay.onRemove=this._remove;this.overlay.draw=this._draw;}});;window.CT.map.Marker=window.CT.map.Marker||{};CT.map.DOMMarker=CT.Class({CLASSNAME:"CT.map.DOMMarker",setTitle:function(a){this.opts.title=a;if(this.title)this.title.setContent(a);else this._build();},setIcon:function(a){if(typeof a=="string")a=CT.dom.img(a);this.setContent(a);},setMap:function(a){this.opts.map=a;this.overlay.setMap(a);},_build:function(){if(this.opts.title)this.title=new CT.map.Node(CT.merge(this.opts.hover,{map:this.opts.map,content:this.opts.title,position:this.getPosition(),className:"tooltip"}));},init:function(){this.opts=CT.merge(this.opts,{className:"abs pointer"});this.addUpdater("map",this.setMap);this.addUpdater("icon",this.setIcon);this.addUpdater("title",this.setTitle);this._build();}},CT.map.Node);CT.map.infoWindow=function(){return new google.maps.InfoWindow();};CT.map.infoWindowSingleton=function(){if(!CT.map._iw)CT.map._iw=CT.map.infoWindow();return CT.map._iw;};CT.map.useSingleInfoWindow=function(){CT.map._iwSingleton=true;};CT.map.Marker=CT.Class({CLASSNAME:"CT.map.Marker",_converters:{position:CT.map.util.latlng},add:function(a){this.opts.map=a;this.marker.setMap(a);},remove:function(){this.opts.map=null;this.marker.setMap(null);this.hideInfo();},update:function(a){this.opts=CT.merge(a,this.opts);},showInfo:function(){var a=this._infoWindow=this._infoWindow||CT.map.infoWindow();a.setContent(this.opts.info);a.setPosition(this.getPosition());a.open(this.opts.map);},hideInfo:function(){this._infoWindow&&this._infoWindow.close();},_wrap:function(a){var b=this,c=CT.parse.capitalize(a);this["get"+c]=function(){return b.opts[a];};this["set"+c]=function(d){b.opts[a]=b._converters[a]?b._converters[a](d):d;b.marker["set"+c](b.opts[a]);};},_buildWrappers:function(){["title","icon","map","content","position","visible"].forEach(this._wrap);},_addMarkerListener:function(a,b){google.maps.event.addListener(this.marker,a,b);},_buildMarker:function(){this.marker=new google.maps.Marker(this.opts);for(var a in this.opts.listeners)this._addMarkerListener(a,this.opts.listeners[a]);},_buildCustomMarker:function(){this.marker=new CT.map.DOMMarker(this.opts);},init:function(a){this.opts=a=CT.merge(a,{icon:"http://maps.google.com/mapfiles/ms/icons/purple-dot.png",listeners:a.info&&{click:this.showInfo}||{}});a.position=CT.map.util.latlng((a.position&&a.position.lat&&a.position.lng)?a.position:CT.map.util.addr2latlng(a.address));a.content?this._buildCustomMarker():this._buildMarker();if(CT.map._iwSingleton)this._infoWindow=CT.map.infoWindowSingleton();this._buildWrappers();if(this.opts.map)this.add(this.opts.map);}});;window.CT.map.Shape=window.CT.map.Shape||{};CT.map.Shape=CT.Class({CLASSNAME:"CT.map.Shape",_gclass:function(){var a=this.CLASSNAME.split(".")[2];return{Shape:"Polygon",Line:"Polyline"}[a]||a;},add:function(a){this.opts.map=a;this.shape.setMap(a);},remove:function(){this.opts.map=null;this.shape.setMap(null);},init:function(a){this.opts=a;this.shape=new google.maps[this._gclass()](a);if(a.map)this.add(a.map);}});CT.map.Circle=CT.Class({CLASSNAME:"CT.map.Circle"},CT.map.Shape);CT.map.Rectangle=CT.Class({CLASSNAME:"CT.map.Rectangle"},CT.map.Shape);CT.map.Line=CT.Class({CLASSNAME:"CT.map.Line"},CT.map.Shape);;;CT.onload(function(){CT.dom.id("build").onclick=function(){CT.log("scraping buildings");CT.net.post("/scrape",{"scraper":"buildings"},"error scraping buildings",function(a){CT.log("scraping rent-control");CT.net.post("/scrape",{"scraper":"rent_control"},"error scraping rent control",function(a){CT.log("scraping lords");CT.net.post("/scrape",{"scraper":"lords"},"error scraping rent control",function(a){CT.log("done!");});});});};CT.dom.id("fetch").onclick=function(){CT.log("fetching owners");CT.net.post("/get",{"model":"owner"},"error loading owners",function(a){CT.log("got "+a.length+" owners");var b=[];a.forEach(function(a){b.push(a.name);});CT.log("loading owners");CT.panel.load(b);CT.log("owners loaded");});};CT.dom.id("test").onclick=function(){CT.net.post("/test",{},"error performing test",function(a){CT.dom.id("data").appendChild(CT.dom.node(JSON.stringify(a)));});};var a={};var b=function(b,c){CT.log("loading "+b+" with offset "+c);CT.net.post("/get",{"model":b,"offset":c},"error retrieving "+b+" records",function(c){CT.log("got "+c.length+" "+b+" records");c.forEach(function(b){if(b.key in a)CT.log("REPEAT: "+b.key);else a[b.key]=b;});});};CT.dom.id("reqtest").onclick=function(){var a=["building","parcel","owner","zipcode","propertyvalue","fire"];var c=100;var d=20;CT.log("testing hecka ("+a.length*(1+(c/d))+") rapid consecutive requests");for(var e=0;e<=c;e+=d)a.forEach(function(a,c){b(a,e);});};var c=CT.dom.id("map");CT.dom.id("mapup").onclick=function(){CT.dom.showHide(c);};CT.map.Map({node:c,center:{lat:37.75,lng:-122.45}});});;</script> </head><body><div><button id="build" disabled>build</button><button id="fetch">fetch</button><button id="test" disabled>test db</button><button id="reqtest">test requests</button><button id="mapup">map</button></div><div id="map"></div><div id="data"></div><div id="sbitems"></div><div id="sbpanels"></div><div class="ctswrap"><div class="ctspinner"><strong>loading...</strong><span></span></div></div><noscript><div style="position: absolute; left:0px; top:0px;"> This site requires Javascript to function properly. To enable Javascript in your browser, please follow <a href="http://www.google.com/support/bin/answer.py?answer=23852">these instructions</a>. Thank you, and have a nice day. </div></noscript></body></html>