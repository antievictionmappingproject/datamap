<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><title>blocparty</title><link rel="stylesheet" href="/css/ct.css"><link rel="stylesheet" href="/css/live.css"><link rel="stylesheet" href="/css/custom.css"> <script>var CT={"_":{"vals":{},"extReqs":{},"scriptImportCb":{},"onImport":function(a){CT._.scriptImportCb[a].forEach(function(a){a();});},"triggerOnload":function(a){(a||window)._ct_onload.forEach(function(a){a();});}},"info":{"page":location.pathname.slice(1,-5),"userAgent":navigator.userAgent||navigator.vendor||window.opera},"net":{"_path":"","_mode":"ct","_cache":false,"_encode":true,"_spinner":false,"_scrambler":"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+/=_","_scramble":function(a){var b="",c=a.length,d,e,f=CT.net._scrambler,g=f.length,h=g/2;for(d=0;d<c;d++){e=f.indexOf(a[d]);if(e==-1)b+=a[d];else b+=f[(e+h)%g];}return b;},"_encoder":function(a){return CT.net._scramble(btoa(a));},"_decoder":function(a){return atob(CT.net._scramble(a));},"_silentFail":true,"setMode":function(a){if(a!="ct"&&a!="basic"&&a!="passthrough"){CT.log("CT.net.setMode() - illegal mode specified: "+a);CT.log("mode must be one of: 'ct', 'basic', 'passthrough'");}else CT.net._mode=a;},"setSilentFail":function(a){CT.net._silentFail=a;},"setScrambler":function(a){CT.net._scrambler=a;},"setSpinner":function(a){CT.net._spinner=a;},"setCache":function(a){CT.net._cache=a;},"setEncoder":function(a){CT.net._encoder=a;},"setDecoder":function(a){CT.net._decoder=a;},"fullPath":function(a){if(!CT.net._path){var b=document.getElementsByTagName("script");for(var c=0;c<b.length;c++)if(b[c].src.slice(-8)=="CT/ct.js"){CT.net._path=b[c].src.replace("CT/ct.js","");break;}CT.net._path=CT.net._path||"/";}return CT.net._path+a;},"xhr":function(a,b,c,d,e,f,g,h){var i=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");i.open(b,a,d);if(!(f&&"Content-Type" in f))i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var j in f)i.setRequestHeader(j,f[j]);i.onreadystatechange=e&&function(){(i.readyState==4)&&e(i);};if(c){if(!g&&CT.net._mode!="passthrough"){if(!h&&CT.net._mode=="ct")c=CT.net._rd(c,true);c=JSON.stringify(c);}if(CT.net._encode&&!(c instanceof FormData||a.startsWith("http")))c=CT.net._encoder(c);}i.send(c);if(!d)return i.responseText;},"_fallback_error":function(a){if(CT.net._silentFail)CT.log(a);else alert(a);},"_u2l":function(a){return btoa(encodeURIComponent(a));},"_l2u":function(a){return decodeURIComponent(atob(a));},"_rd":function(a,b){if(a){if(typeof a=="string")return CT.net[(b?"_u2l":"_l2u")](a);if(typeof a=="object"){var c,d=Array.isArray(a)?[]:{};for(c in a)d[c]=CT.net._rd(a[c],b);return d;}}return a;},"_ctsuccess":function(a,b,c){var d=JSON.parse(a);if(c)d=CT.net._rd(d);if(CT.net._cache&&b)CT.storage.set(b,d);return d;},"_ctresponse":function(a,b,c){if(CT.net._encode&&!c)a=CT.net._decoder(a);var d=a.charAt(0),e={success:!!(d%2)};a=a.slice(1);if(d=="2"||d=="3")e.data=CT.net._rd(a);else if(e.success)e.data=CT.net._ctsuccess(a,b,d=="3");else e.data=a;return e;},"_xhrcb":function(a,b,c,d,e,f,g,h,i,j,k){if(CT.net._spinner||j){CT.net._spinner_node=CT.net._spinner_node||CT.dom.spinner();document.body.appendChild(CT.net._spinner_node);}b=b||function(){};c=c||function(a){CT.net._fallback_error((f||"error")+": "+a);};return function(f){if(f.status==200||(h&&f.status==500)){if(CT.net._spinner||j)CT.dom.remove(CT.net._spinner_node);var l=f.responseText.trim();if(k||CT.net._mode=="basic")b(l,d);else if(!i&&CT.net._mode=="ct"){var m=CT.net._ctresponse(l,g,a.startsWith("http"));if(m.success)b(m.data,d);else c(m.data,e);}else b(CT.net._ctsuccess(l,g),d);}else c("request to "+a+" failed! ("+f.status+" - "+f.responseText+")",e);};},"formData":function(a,b,c){var d=new FormData();if(b)for(var e in b)d.append(e,b[e]);d.append(c||"data",a);return d;},"formUp":function(a,b,c){b.params=CT.net.formData(a,b.params,c);b.passthrough=true;b.headers=b.headers||{};b.headers["Content-Type"]="multipart/form-data";return CT.net.post(b);},"post":function(a,b,c,d,e,f,g,h,i,j,k,l,m){if(arguments.length==1&&typeof arguments[0]!="string"){var n=arguments[0];a=n.path;b=n.params;c=n.errMsg;d=n.cb;e=n.eb;f=n.headers;g=n.cbarg;h=n.ebarg;i=n.sync;j=n.passthrough;k=n.noct;l=n.spinner;m=n.basic;}var o;if(CT.net._cache){o=a+JSON.stringify(b);var p=CT.storage.get(o);if(p)return d(p,g);}return CT.net.xhr(a,"POST",b,!i,CT.net._xhrcb(a,d,e,g,h,c,o,null,k,l,m),f,j,k);},"put":function(a,b,c,d,e,f,g,h,i){CT.net.xhr(a,"PUT",b,true,CT.net._xhrcb(a,c,null,null,null,null,null,f,g,h,i),d,e,g);},"del":function(a,b,c,d){CT.net.xhr(a,"DELETE",b,true,CT.net._xhrcb(a,c),d);},"qs":function(a,b){a=a||"";if(b){var c=[];for(var d in b)c.push(d+"="+escape(b[d]));a+="?"+c.join("&");}return a;},"get":function(a,b,c,d){var e,f,g=CT.net._cache&&(c||d);a=CT.net.qs(a,b);if(g){f=CT.storage.get(a);if(f)return f;}e=CT.net.xhr(a,"GET");if(d)e=CT.net._ctresponse(e,a).data;else{if(c)e=JSON.parse(e);if(g)CT.storage.set(a,e);}return e;}},"scriptImport":function(a,b,c){var d=document.getElementsByTagName("head")[0],e=(a.slice(0,4)=="http")&&a||(CT.net.fullPath(a.replace(/\./g,"/")+".js")),f=!(e in CT._.scriptImportCb);if(f)CT._.scriptImportCb[e]=[];if(b)CT._.scriptImportCb[e].push(b);if(f){d.appendChild(CT.dom.script(e));d.appendChild(CT.dom.script(null,"CT._.onImport('"+e+"');",c));}},"require":function(a,b){if(a.slice(0,4)=="http"){if(!(a in CT._.extReqs)){CT._.extReqs[a]=true;eval(CT.net.get(a));}}else{var c=a.split("."),d,e=window;while(e&&c.length){d=c.shift();if(d in e)e=e[d];else{c.unshift(d);c.forEach(function(a,b){e=e[a]={};});c.length=0;e=null;}}if(!e)eval(CT.net.get(CT.net.fullPath(a.replace(/\./g,"/")+".js")));}},"initCore":function(){core.config.css.forEach(function(a){CT.dom.addStyle(null,a);});if(core.config.autoparse)CT.dom.setAutoparse(core.config.autoparse);CT.layout.header(core.config.header);core.config.footer&&CT.layout.footer(core.config.footer);core.config.mobile.scale&&CT.dom.meta("viewport","width=device-width, initial-scale=1");},"setVal":function(a,b){CT._.vals[a]=b;},"getVal":function(a){return CT._.vals[a];},"clipboard":function(a,b){var c=CT.dom.field(null,a,"transparent");document.body.appendChild(c);c.select();document.execCommand('copy');CT.dom.remove(c);alert(b||"copied to clipboard");},"onload":function(a,b){b=b||window;if(!b._ct_onload){b._ct_onload=[];b.addEventListener('load',function(){CT._.triggerOnload(b);});}b._ct_onload.push(a);},"on":function(a,b,c){(c||window).addEventListener(a,b);},"onresize":function(a,b){CT.on("resize",a,b);},"dmerge":function(){var a,b,c,d={};for(a=arguments.length-1;a>-1;a--)if(arguments[a])for(b in arguments[a]){c=arguments[a][b];if(typeof c=="object")d[b]=Array.isArray(c)?c.slice():CT.dmerge(c);else d[b]=c;}return d;},"merge":function(){var a,b,c={};for(a=arguments.length-1;a>-1;a--)if(arguments[a])for(b in arguments[a])c[b]=arguments[a][b];return c;},"bind":function(a,b){for(var c in b)if(typeof b[c]=="function")b[c]=b[c].bind(a);else if(typeof b[c]=="object")CT.bind(a,b[c]);},"Class":function(a,b){a.fullInit=function(){if(b)b.prototype.fullInit.apply(this,arguments);if(a.init)a.init.apply(this,arguments);};var c=function(){var b=CT.dmerge(c.prototype);CT.bind(b,b);if(!b.CLASSNAME){b.CLASSNAME="CT Class";CT.log("Class missing CLASSNAME property -- falling back to 'CT Class'");}if(!b.log)b.log=CT.log.getLogger(b.CLASSNAME);a.fullInit.apply(b,arguments);return b;};c.prototype=CT.merge(a,b&&b.prototype);return c;}};CT.info.android=/Android/.test(CT.info.userAgent);CT.info.iOs=/iPhone|iPad/.test(CT.info.userAgent);CT.info.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(CT.info.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(CT.info.userAgent.substr(0,4));CT.info.iPhone=CT.info.userAgent.indexOf("iPhone")!=-1;CT.info.iPad=CT.info.userAgent.indexOf("iPad")!=-1;CT.info.androidTablet=CT.info.android&&!CT.info.mobile;CT.info.isStockAndroid=(CT.info.userAgent.indexOf("Mozilla/5.0")!=-1)&&(CT.info.userAgent.indexOf("Android ")!=-1)&&(CT.info.userAgent.indexOf("AppleWebKit")!=-1)&&(CT.info.userAgent.indexOf("Chrome")==-1);CT.info.isMac=/Macintosh/.test(CT.info.userAgent);CT.info.isChrome=CT.info.userAgent.indexOf("Chrome")!=-1;CT.info.isFirefox=CT.info.userAgent.indexOf("Firefox")!=-1;CT.log=function(a,b){if(CT.log._silent)return;a=CT.log._fix(a);for(var c=0;c<CT.log.grep._ins.length;c++)if(a.indexOf(CT.log.grep._ins[c])==-1)return;for(var c=0;c<CT.log.grep._outs.length;c++)if(a.indexOf(CT.log.grep._outs[c])!=-1)return;var d=Date()+" ::";if(b)for(var c=0;c<b;c++)d+="  ";console.log(d,a);};CT.log.grep=function(a,b){CT.log.grep._ins=a||[];CT.log.grep._outs=b||[];};CT.log.grep._ins=[];CT.log.grep._outs=[];CT.log._fix=function(a){return(typeof a=="object")?JSON.stringify(a):a;};CT.log._silent=true;CT.log.set=function(a){CT.log._silent=a;};CT.log._loggerCounts={};CT.log.getLogger=function(a){var b=CT.log._loggerCounts;if(!(a in b))b[a]=0;var c=a+" {"+b[a]+"}";b[a]+=1;var d=function(){var a=[];for(var b=0;b<d.arguments.length;b++)a.push(CT.log._fix(d.arguments[b]));CT.log("["+c+"] "+a.join(" "));};return d;};CT.log._tcbs={};CT.log._timer=CT.log.getLogger("timer");CT.log.startTimer=function(a,b){CT.log._tcbs[a]=Date.now();b&&CT.log._timer("Initiated",a,"with",b);};CT.log.endTimer=function(a,b){var c=(Date.now()-CT.log._tcbs[a])/1000;CT.log._timer("Completed in",c,"seconds:",a,b);};if(!window.JSON)CT.require("CT.lib.shims.JSON",true);if(!window.sessionStorage)CT.require("CT.lib.shims.sessionStorage",true);if(!document.createElement("div").classList)CT.require("CT.lib.shims.classList",true);if(!window.requestAnimationFrame)CT.require("CT.lib.shims.requestAnimationFrame",true);if(!Object.values)CT.require("CT.lib.shims.ObjectValues",true);if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)CT.require("CT.lib.shims.getUserMedia",true);if(!window.addEventListener)window.addEventListener=window.attachEvent;;window.CT.all=window.CT.all||{};window.CT.Drop=window.CT.Drop||{};CT.Drop=CT.Class({CLASSNAME:"CT.Drop",_position:function(){var a=CT.align.offset(this.anchor);if(this.opts.setWidth)this.node.style.width=(this.anchor.clientWidth+2)+"px";this.node.style.top=(a.top+this.anchor.clientHeight+this.opts.shiftV)+"px";this.node.style.left=(a.left+this.opts.shiftH)+"px";},_hide:function(){this.node.className=this.className+" hider";this.opts.onHide&&this.opts.onHide();},expand:function(a){a=a||this.opts.onShow;var b=this.node,c=this.opts;!this.opts.relative&&this._position();this.viewing=true;if(c.constrained)b.className=this.className+" drop-open";else{b.className=this.className;b.style.maxHeight=(c.content.scrollHeight||1000)+"px";}CT.trans.trans({node:b,cb:function(){if(c.constrained)b.className+=" scrolly";a&&a();}});},retract:function(){if(!this.viewing)return;this.viewing=false;this.node.className=this.className;if(!this.opts.constrained)this.node.style.maxHeight="0px";CT.trans.trans({node:this.node,cb:this._hide});},slide:function(){if(this.viewing)this.retract();else this.expand();},_setAnchor:function(){if(this.opts.setClick)this.anchor.onclick=this.slide;},init:function(a){this.opts=a=CT.merge(a,{content:CT.dom.node(),parent:document.body,rows:false,shiftH:0,shiftV:0,relative:false,setClick:true,setNodeClick:true,setWidth:true,constrained:true,translucent:false,transparent:false,round:false,border:null});this.className=a.relative?"relative drop":((a.transparent?"backtrans":a.translucent?"whitebacktrans":"whiteback")+" drop mosthigh");if(a.round)this.className+=" round";if(a.rows)this.className+=" drop-rows";this.anchor=a.anchor;this.node=CT.dom.node(a.content,null,this.className+" hider");if(a.border)this.node.style.border="1px solid "+a.border;if(a.setNodeClick)this.node.onclick=this.slide;a.parent.appendChild(this.node);CT.drag.makeDraggable(this.node,{constraint:"horizontal"});setTimeout(this._setAnchor);}});;window.CT.Pager=window.CT.Pager||{};CT.Pager=CT.Class({"CLASSNAME":"CT.Pager","offset":0,"limit":20,"data":[],"init":function(a,b,c,d,e){this.id=CT.Pager._id;CT.Pager._id+=1;this._renderCb=a;this._requestCb=b;if(c)this.limit=c;this._build(d,e);},"remove":function(a){CT.data.remove(this.data,a);this._load();},"_build":function(a,b){this.content=CT.dom.node();this.next=CT.dom.button("next",this._next);this.previous=CT.dom.button("previous",this._previous);this.node=CT.dom.node([this.content,this.previous,this.next],null,a,b);this.node.pager=this;this._load();},"_next":function(){this.offset+=this.limit;this._load();},"_previous":function(){this.offset-=this.limit;this._load();},"_updateButtons":function(){if(this.offset==0)CT.dom.hide(this.previous);else if(this.offset==this.limit)CT.dom.show(this.previous,"inline");if(this.max)CT.dom[((this.offset+this.limit)>=this.max)?"hide":"show"](this.next,"inline");},"_render":function(){CT.dom.setContent(this.content,this._renderCb(this.data.slice(this.offset,this.offset+this.limit)));},"_refill":function(a){CT.data.addSet(a);this.data=this.data.concat(a);if(a.length<this.limit){this.max=this.data.length;this.full=true;}this._load();},"_load":function(){if(this.full||(this.offset+this.limit)<=this.data.length){this._render();this._updateButtons();}else this._requestCb({"limit":this.limit,"offset":this.offset},this._refill);}});CT.Pager._id=0;;window.CT.align=window.CT.align||{};CT.align={"absers":[],"fullscreeners":[],"centerscreeners":[],"_setLeft":function(a,b){return a.style.left=(8+b)+"px";},"absed":function(a,b,c,d,e){a.style.position="absolute";CT.align._setLeft(a,b);if(c!=null)a.style.top=c+"px";if(d!=null)a.style.right=d+"px";if(e!=null)a.style.bottom=e+"px";CT.align.absers.push([a,b,c,d,e]);return a;},"centernode":function(a){if(a.scrollHeight){a.origScrollHeight=a.origScrollHeight||a.scrollHeight;var b=CT.align.height();var c=b-100;var d=parseInt(a.style.height)||a.origScrollHeight;if(d>c||d<a.origScrollHeight){d=Math.min(a.origScrollHeight,c);a.style.height=d+"px";}a.style.top=(b-d)/2+"px";a.style.left=(CT.align.width()/2)-(a.clientWidth/2)+"px";}},"centerall":function(){for(var a=0;a<CT.align.centerscreeners.length;a++)CT.align.centernode(CT.align.centerscreeners[a]);},"centered":function(a){a.style.position="fixed";CT.align.centernode(a);if(CT.align.centerscreeners.indexOf(a)==-1)CT.align.centerscreeners.push(a);return a;},"resize":function(){var a=CT.align.absers;for(var b=0;b<a.length;b++)CT.align._setLeft(a[b][0],a[b][1]);CT.align.centerall();},"position":function(a){var b=curtop=0;if(a.offsetParent)do{b+=a.offsetLeft;curtop+=a.offsetTop;}while(a=a.offsetParent);return [b,curtop];},"offset":function(a){var b={"top":0,"left":0};while(a){if(a==(CT.dom.ALLNODE||document.body))break;b.top+=a.offsetTop;b.left+=a.offsetLeft;a=a.offsetParent;}return b;},"height":function(a){return a?a.clientHeight:window.innerHeight;},"width":function(a){return a?a.clientWidth:window.innerWidth;}};;window.CT.autocomplete=window.CT.autocomplete||{};CT.autocomplete.Guesser=CT.Class({CLASSNAME:"CT.autocomplete.Guesser",targets:[],_doNothing:function(){},_returnTrue:function(){return true;},tapTag:function(a){this.opts.tapCb(a);this.retract();},addTag:function(a){var b=CT.dom.node(a.label,"div","tagline","ac"+a.label.replace(/ /g,""));a.label.toLowerCase().split(" ").forEach(function(a){for(var c=1;c<=a.length;c++)b.className+=" "+a.slice(0,c);});this.node.firstChild.appendChild(b);this.targets.push(b);b.onclick=function(){this.tapTag(a);}.bind(this);},guesser:function(a){this._update(this.opts.data.filter(function(b){var c,d=b.label.toLowerCase().split(" ");for(c=0;c<d.length;c++)if(d[c].slice(0,a.length)==a)return true;}));},_hide:function(){this.node.className=this.className+" hider";this.opts.onHide&&this.opts.onHide();this.input.blur();},_upOne:function(a){if(!CT.dom.id("ac"+a.label.replace(/ /g,"")))this.addTag(a);},_update:function(a){a.forEach(this._upOne);},_onUp:function(a){if(!this.viewing){this.opts.expandCb();CT.dom.mod({className:"tagline",show:true});this.expand(function(){this.input.active=true;this.input.focus();}.bind(this));return true;}},_unselect:function(){if(this.selection){this.selection.classList.remove("drop-selection");this.selection=null;}},_select:function(a){if(this.targets.length){var b=this.targets.indexOf(this.selection);b+=a?1:-1;if(b<0)b=this.targets.length-1;else if(b>=this.targets.length)b=0;this._unselect();this.selection=this.targets[b];this.selection.classList.add("drop-selection");this.selection.scrollIntoViewIfNeeded();}},_onKeyUp:function(a){a=a||window.event;var b=a.keyCode||a.which;if(b==27)return this._retract();if(b==38||b==40)this._select(b==40);else if(b==13||b==3)if(this.selection){this.selection.onclick();this._unselect();this.targets.length=0;}else{this.input.blur();this.opts.enterCb(this.input.value);}else if(this.input.value){var c=this.input.value.toLowerCase();this.targets=CT.dom.className(c,this.node);this._unselect();CT.dom.mod({className:"tagline",hide:true});if(this.targets.length)CT.dom.mod({className:c,show:true});else this.opts.guessCb(c,this._update);if(!this.viewing)this.expand();}else CT.dom.mod({className:"tagline",hide:true});this.opts.keyUpCb();},_onTap:function(a){this.input.value=a.label;this.input.onenter&&this.input.onenter();},_focus:function(){this.input.focus();},_retract:function(){this._unselect();this.targets.length=0;this.retract();setTimeout(this._focus,500);},_waitRetract:function(){this._unselect();this.targets.length=0;setTimeout(this.retract,500);},init:function(a){this.opts=a=CT.merge(a,{rows:true,setClick:false},this.opts,{enterCb:this._doNothing,keyUpCb:this._doNothing,expandCb:this._doNothing,tapCb:this._onTap,guessCb:this.guesser,anchor:a.input,data:[]});if(a.rows&&this.className.indexOf("drop-rows")==-1){this.className+=" drop-rows";this.node.classList.add("drop-rows");}a.data=a.data.map(function(a){return typeof a=="string"?{label:a}:a;});CT.autocomplete.Guesser.id+=1;this.id=CT.autocomplete.Guesser.id;this.input=this.anchor=a.input;CT.gesture.listen("down",this.input,this._returnTrue);CT.gesture.listen("up",this.input,this._onUp);this.input.addEventListener("keyup",this._onKeyUp);this.input.addEventListener("blur",this._waitRetract);}},CT.Drop);CT.autocomplete.Guesser.id=0;CT.autocomplete.DBGuesser=CT.Class({CLASSNAME:"CT.autocomplete.DBGuesser",guesser:function(a){var b=CT.merge(this.opts.filters);b[this.opts.property]={comparator:"like",value:a+"%"};CT.db.get(this.opts.modelName,this._update,null,null,null,b);}},CT.autocomplete.Guesser);;window.CT.canvas=window.CT.canvas||{};window.CT.canvas.Canvas=window.CT.canvas.Canvas||{};CT.canvas.Canvas=CT.Class({"CLASSNAME":"CT.canvas.Canvas","_":{"controllers":{},"propagate":function(a,b){var c=this._.vars.controllers,d,e,f;for(d in c){e=c[d];f=e[a].apply(e,b)||f;}return f;},"on":{"up":function(){this._.propagate("up");},"hover":function(a){this._.propagate("hover",[this._.where(a)]);},"down":function(a){this.canvas.noDrag=this._.propagate("down",[this._.where(a)]);},"drag":function(a,b,c,d,e){this._.propagate("drag",[a,b,c,d,e]);}},"where":function(a){var b=this.canvas.offsetLeft+this.view.offsetLeft,c=this.canvas.offsetTop+this.view.offsetTop;return{x:a.x+this.view.scrollLeft-b,y:a.y+this.view.scrollTop-c};}},"draw":function(a){this._.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var b in this._.controllers)this._.controllers[b].draw(this._.ctx);},"render":function(){if(!this.canvas)return;requestAnimationFrame(this.render);var a=new Date().getTime(),b=a-(this.startTime||a);this.startTime=a;this.draw(b);},"dismantle":function(){if(this.canvas){CT.gesture.unlisten('hover',this.canvas);CT.gesture.unlisten('drag',this.canvas);CT.gesture.unlisten('down',this.canvas);CT.gesture.unlisten('up',this.canvas);CT.dom.remove(this.canvas);this.canvas=null;}},"build":function(){this.canvas=CT.dom.node("","canvas","","",{"width":this._.vars.width,"height":this._.vars.height});this._.ctx=this.canvas.getContext('2d');CT.gesture.listen('hover',this.canvas,this._.on.hover);CT.gesture.listen('drag',this.canvas,this._.on.drag);CT.gesture.listen('down',this.canvas,this._.on.down);CT.gesture.listen('up',this.canvas,this._.on.up);this._.vars.zoom&&CT.gesture.pinch2zoom(this.canvas);},"register":function(a,b){var c=this._.vars,d=this._.controllers,e=b.getDimensions();d[a]=b;c.width=Math.max(c.width,e.width);c.height=Math.max(c.height,e.height);if(this.canvas){this.canvas.width=c.width;this.canvas.height=c.height;}},"init":function(a){this._.vars=CT.merge(a,{"width":CT.align.width(a.view),"height":CT.align.height(a.view),"controllers":{},"zoom":false});for(var b in this._.vars.controllers)this.register(b,this._.vars.controllers[b]);this.view=this._.vars.view;this.build();}});;window.CT.canvas.Controller=window.CT.canvas.Controller||{};CT.canvas.Controller=CT.Class({"CLASSNAME":"CT.canvas.Controller","nodes":[],"nodesByName":{},"_":{"on":{"up":function(a){},"hover":function(a){},"down":function(a){},"drag":function(a){}},"propagate":function(a,b){var c;if(this._.vars.input)this.nodes.forEach(function(d){c=d[a].apply(d,b)&&d||c;});if(c)this._.on[a](c);return c;},bounds:function(a){var b,c=this._.vars.padding,d,e,f=maxY=minX=minY=0;this.nodes.forEach(function(a){b=a._.vars;d=b.x+b.width;e=b.y+b.height;if(f<d+c)f=d+c;if(maxY<e+c)maxY=e+c;if(minX==0||(b.x-c)<minX)minX=b.x-c;if(minY==0||(b.y-c)<minY)minY=b.y-c;});a&&this.nodes.forEach(function(a){a.move(-minX,-minY);});this._.vars.width=f-minX;this._.vars.height=maxY-minY;}},"getDimensions":function(){return{"width":this._.vars.width,"height":this._.vars.height};},"on":function(a,b){this._.on[a]=b;},"up":function(){this.selected=null;return this._.propagate("up");},"hover":function(a){return this._.propagate("hover",[a]);},"down":function(a){this.selected=this._.propagate("down",[a]);return this.selected;},"drag":function(a,b,c,d,e){if(this.selected&&this._.vars.draggable){this.selected.move(c,d);return true;}},"get":function(a){return this.nodesByName[a];},"draw":function(a){this.nodes.forEach(function(b){b.draw(a);});},"addNode":function(a){this.nodes.push(a);this.nodesByName[a._.vars.name]=a;},"rmNode":function(a){CT.data.remove(this.nodes,a);delete this.nodesByName[a.name];},"init":function(a){var b=this._.vars=CT.merge(a,{"input":true,"draggable":true,"normalize":true,"padding":5});b.nodes.forEach(this.addNode);if(b.dimensions){b.width=b.dimensions.width;b.height=b.dimensions.height;delete b.dimensions;}else this._.bounds(b.normalize);}});;window.CT.canvas.Node=window.CT.canvas.Node||{};CT.canvas.Node=CT.Class({"CLASSNAME":"CT.canvas.Node","_":{"mids":function(){var a=this._.vars;a.mids={};a.mids.x=a.x+(a.width/2);a.mids.y=a.y+(a.height/2);},"draw_box":function(a){var b=this._.vars,c,d=b.x,e=b.y,f=b.radius,g=b.width,h=b.height,i=b.over?(2*b.border):b.border,j={tl:f,tr:f,br:f,bl:f};a.strokeStyle=b.selected?b.color_selected:b.color_unselected;a.lineWidth=b.selected?(2*i):i;a.beginPath();a.moveTo(d+j.tl,e);a.lineTo(d+g-j.tr,e);a.quadraticCurveTo(d+g,e,d+g,e+j.tr);a.lineTo(d+g,e+h-j.br);a.quadraticCurveTo(d+g,e+h,d+g-j.br,e+h);a.lineTo(d+j.bl,e+h);a.quadraticCurveTo(d,e+h,d,e+h-j.bl);a.lineTo(d,e+j.tl);a.quadraticCurveTo(d,e,d+j.tl,e);a.closePath();c=a.createLinearGradient(d,e,d,e+h);c.addColorStop(0,"white");c.addColorStop(1,b.color);a.fillStyle=c;a.shadowColor=b.shadowColor;a.shadowBlur=b.shadowBlur;a.shadowOffsetX=b.shadowOffsetX;a.shadowOffsetY=b.shadowOffsetY;a.fill();a.stroke();}},"components":{},"move":function(a,b){this._.vars.x+=a;this._.vars.y+=b;this._.mids();},"contains":function(a){var b=this._.vars.x,c=this._.vars.y,d=this._.vars.width,e=this._.vars.height;return((a.x>=b)&&(a.x<=b+d)&&(a.y>=c)&&(a.y<=c+e));},"hover":function(a){this._.vars.over=this.contains(a);},"up":function(a){},"down":function(a){this._.vars.selected=this.contains(a);return this._.vars.selected&&this;},"build":function(){},"draw":function(a){var b=this._.vars,c=this.components;this.build();b.box&&this._.draw_box(a);b.drawOrder.forEach(function(b){c[b](a);});},"init":function(a){this.id=CT.canvas.Node.id;CT.canvas.Node.id+=1;this._.vars=CT.merge(a,{"inputPadding":5,"border":1,"radius":5,"box":true,"over":false,"selected":false,"color_selected":"red","color_unselected":"#0023AA","shadowColor":"99AAAA","shadowBlur":10,"shadowOffsetX":4,"shadowOffsetY":4,"drawOrder":Object.keys(this.components)});this._.mids();}});CT.canvas.Node.id=0;;window.CT.canvas.Text=window.CT.canvas.Text||{};CT.canvas.Text=CT.Class({"CLASSNAME":"CT.canvas.Text","components":{"text":function(a){var b=this._.vars,c=0,d='',e=[],f=b.x+b.padding,g=b.y+b.padding,h=b.width-b.padding*2,i=b.height-b.padding*2,j=b.lineHeight,k=b.label.split(' '),l,m,n,o,p,q;a.shadowColor=b.textShadowColor;a.shadowBlur=b.textShadowBlur;a.shadowOffsetX=b.textShadowOffsetX;a.shadowOffsetY=b.textShadowOffsetY;a.fillStyle=b.fillStyle;a.textBaseline=b.textBaseline;for(;c<k.length;++c){o=!d?k[c]:d+' '+k[c];p=a.measureText(o);n=n||p;q=p.width;if(q>h&&c>0){m=f+(h-n.width)/2;e.push({"line":d,"xStart":m});d=k[c];n=a.measureText(d);}else{n=p;d=o;}if(c==k.length-1){n=a.measureText(d);m=f+(h-n.width)/2;e.push({"line":d,"xStart":m});}}l=g+(i-j*e.length)/2;a.font=b.font;e.forEach(function(b){a.fillText(b.line,b.xStart,l);l+=j;});}},"init":function(){this._.vars=CT.merge(this._.vars,{"padding":7,"lineHeight":12,"fillStyle":"black","textBaseline":"top","textShadowColor":"none","textShadowBlur":0,"textShadowOffsetX":0,"textShadowOffsetY":0,"font":"Bold 8pt Sans-Serif"});this._.vars.label=this._.vars.label.replace(/(?:\r\n|\r|\n)/g,' ');}},CT.canvas.Node);;;window.CT.data=window.CT.data||{};CT.data={map:{},"sameList":function(a,b){if(a.length!=b.length)return false;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return false;return true;},"copyList":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b;},"diff":function(a,b,c,d,e,f){var g=c||{};d=d||[];f=f||[];e=e||{};for(var h in b)if(d.indexOf(h)!=-1){for(var i in b[h])if(b[h][i]!=a[h][i]){g[h]=b[h];break;}}else if(f.indexOf(h)!=-1){if(!CT.data.sameList(b[h],a[h]))g[h]=b[h];}else if(h in e){if(b[h]!=a[h][e[h]])g[h]=b[h];}else if(b[h]!=a[h])g[h]=b[h];return g;},"append":function(a,b){if(a.indexOf(b)==-1)a.push(b);},"remove":function(a,b){var c=a.indexOf(b);if(c!=-1)return a.splice(c,1);},"sum":function(a){return a.length?a.reduce(function(a,b){if(Array.isArray(a))return a.map(function(a,c){return a+b[c];});return a+b;}):a;},"alpha":function(a,b){return a.sort(function(a,c){if(b){a=a[b];c=c[b];}return(a<c)?-1:(a>c)?1:0;});},"has":function(a){return !!CT.data.map[a];},"get":function(a){return CT.data.map[a];},"add":function(a){if(CT.data.map[a.key])for(var b in a)CT.data.map[a.key][b]=a[b];else CT.data.map[a.key]=a;},"addSet":function(a){for(var b=0;b<a.length;b++)CT.data.add(a[b]);},"uniquify":function(a,b){b=b||[];a.sort();var c=[];var d="";for(var e=0;e<a.length;e++)if(a[e]!=d&&b.indexOf(a[e])==-1){d=a[e];c.push(d);}return c;},"numstr":function(a){return Math.floor(Math.random()*Math.pow(10,a)).toString();},"random":function(a){return Math.floor(Math.random()*a);},"choice":function(a){return a[CT.data.random(a.length)];},"checkAndDo":function(a,b,c,d,e,f,g){var h=[];a=CT.data.uniquify(a);for(var i=0;i<a.length;i++)if(CT.data.map[a[i]]==null||e&&CT.data.map[a[i]][e]==null)h.push(a[i]);if(h.length==0)return b();g=g||{"gtype":"data"};g.keys=h;CT.net.post(f||"/get",g,"error retrieving data",function(a){CT.data.addSet(a);if(c)c(h);b();},d);},"requirePrep":function(){},"itemReady":function(a,b){var c=a in CT.data.map;b&&b.forEach(function(b){c=c&&b in CT.data.map[a];});return c;},"require":function(a,b,c,d,e){CT.data.requirePrep(a);if(CT.data.itemReady(a,c))b(CT.data.get(a));else{e=e||{"gtype":"user","chat":1};e.uid=a;CT.net.post(d||"/get",e,"error retrieving data",function(c){CT.data.add(c);b(CT.data.get(a));});}},"requireAll":function(a,b,c,d,e,f){a.forEach(CT.data.requirePrep);var g=[];for(var h=0;h<a.length;h++)if(!CT.data.itemReady(a[h],d))g.push(a[h]);if(g.length==0)b(a);else{f=f||{"gtype":"user","chat":1};f.uids=g;CT.net.post("/get",f,"error retrieving data",function(c){CT.data.addSet(c);b(a);});}}};;window.CT.db=window.CT.db||{};CT.db={_schema:{},_limit:20,_pagerLimit:20,key2model:function(a){if(a.slice(-3,-1)=="CT"){var b,c=parseInt(a.slice(-1));a=a.slice(0,-3);for(b=0;b<c;b++)a+="=";}return JSON.parse(atob(a)).model;},key2label:function(a){var b=CT.data.get(a);return b.label;},isKey:function(a,b){return !!CT.db._schema[a]._kinds[b];},getSchema:function(a){return a?CT.db._schema[a]:CT.db._schema;},setSchema:function(a){CT.db._schema=a;var b,c,d,e=CT.db._rmap={};for(b in a)for(c in a[b]._kinds){d=b+"."+c;a[b]._kinds[c].forEach(function(a){if(!(a in e))e[a]=[];e[a].push(d);});}},setLimit:function(a){CT.db._limit=a;},setPagerLimit:function(a){CT.db._pagerLimit=a;},eachProp:function(a,b){return Object.keys(CT.db._schema[a]).filter(function(a){return ["index","key","modelName","label","_label","_kinds"].indexOf(a)==-1;}).map(function(a){return b(a);});},reference2label:function(a,b){var c=CT.db._schema[a]._kinds[b][0];return{modelName:c,property:CT.db._schema[c]._label};},get:function(a,b,c,d,e,f,g){var h,i,j={"action":"get","modelName":a,"limit":c||CT.db._limit,"offset":d||0};if(e)j.order=e;if(f){for(h in f){i=f[h];if(!i.comparator)f[h]={value:i,comparator:"=="};}j.filters=f;}return CT.net.post("/_db",j,null,function(a){CT.data.addSet(a);b(a);},null,null,null,null,g);},multi:function(a,b){var c=a.filter(function(a){return !CT.data.get(a);});if(!c.length)return b(a.map(function(a){return CT.data.get(a);}));CT.net.post("/_db",{action:"get",keys:c},null,function(c){CT.data.addSet(c);b&&b(a.map(function(a){return CT.data.get(a);}));});},one:function(a,b){if(CT.data.has(a))return b&&b(CT.data.get(a));CT.net.post("/_db",{action:"get",key:a},null,function(a){CT.data.add(a);b&&b(a);});},withSchema:function(a){if(Object.keys(CT.db._schema).length)a&&a(CT.db._schema);else CT.net.post("/_db",{"action":"schema"},null,function(b){CT.db.setSchema(b);a&&a(b);});},init:function(a){CT.db._opts=a=CT.merge(a,{panel_key:"db"});CT.db.withSchema(a.cb);},query:function(a,b){new CT.modal.Modal({"node":new CT.db.Query(a).node,"transition":b||"none"}).show();},_refill:function(a,b,c){return function(d,e){CT.db.get(a,e,d.limit,d.offset,b,c);};},pager:function(a,b,c,d,e){var f=CT.db._opts,g=d||a,e=e||CT.dom.id(f.panel_key+"content"+g);e.appendChild(CT.panel.pager(f.builder(a),CT.db._refill(a,b,c),CT.db._pagerLimit,"rcol","data",g));f.post_pager&&f.post_pager(g,a);}};CT.db.Blob=CT.Class({CLASSNAME:"CT.db.Blob",uploadPrompt:function(){new CT.modal.Prompt({noClose:true,style:"file",transition:"slide",cb:this.upload}).show();},upload:function(a){var b={action:"blob"};if(this.index)b.value=this.index;else{b.key=this.opts.key;b.property=this.opts.property;}a.upload("/_db",this._update,b);},_update:function(a){this.opts.value=a;this.opts.cb&&this.opts.cb(a);this._setup();},_setup:function(){if(this.opts.value){this.index=this.opts.value.slice(6);CT.dom.setContent(this.node,[CT.dom.link("download",null,"/_db?action=blob&value="+this.index,this.opts.className||"blue",null,null,true),CT.dom.pad(),CT.dom.link("upload",this.uploadPrompt,null,this.opts.className||"nodecoration blue")]);}else if(this.opts.key)CT.dom.setContent(this.node,CT.dom.link(this.opts.firstUp||"upload",this.uploadPrompt,null,this.opts.className||"nodecoration blue"));else if(!this.opts.noNothing)CT.dom.setContent(this.node,"(nothing yet)");},value:function(){return this.index;},keyUp:function(a){this.opts.key=a;this._setup();},init:function(a){this.opts=a;this.node=CT.dom.node();this.node.blob=this;this._setup();}});CT.db.edit={_d:{"string":"","text":"","integer":0,"float":0.0,"boolean":false,"datetime":null,"key":null,"blob":null,"list":[],"keylist":[]},_no_ent:{"key":null,"label":"(tap to select)"},propertyDefault:function(a){return CT.db.edit._d[a];},isSupported:function(a,b){if(["label","_label","created","modified"].indexOf(b)!=-1)return false;return a in CT.db.edit._d;},getDefaults:function(a,b){var c,d=b||{},e=CT.db._schema[a];for(c in e)d[c]=CT.db.edit._d[e[c]];return d;},_val:function(a,b){return function(){if(b=="boolean")return a.isChecked?a.isChecked():a.checked;if(b=="integer")return parseInt(a.value)||null;if(b=="float")return parseFloat(a.value)||null;if(b=="key")return a.data.key;if(["datetime","list","keylist"].indexOf(b)!=-1)return typeof a.value=="string"?a.value:a.value();return a.value;};},input:function(a,b,c,d,e){var f,g={marginLeft:"180px",minHeight:"18px"};e=e||{};if(b=="string")f=CT.dom.field(null,c);else if(b=="text")f=CT.dom.textArea(null,c);else if(b=="boolean")if(e.label)f=CT.dom.checkboxAndLabel(a,c);else f=CT.dom.checkbox(null,c,{"display":"inline-block","width":"160px"});else if(b=="float")f=CT.parse.numOnly(CT.dom.field(null,c),true);else if(b=="integer")f=CT.parse.numOnly(CT.dom.field(null,c));else if(b=="key")f=new CT.db.edit.EntityRow({property:a,key:c,modelName:d}).node;else if(b=="datetime")f=CT.dom.dateSelectors(null,null,e.startYear,null,true,null,c);else if(b=="blob"){var h={key:e.key,property:a,value:c};if(e.label)h.firstUp="upload "+a;f=new CT.db.Blob(h).node;}else if(b=="list")if(c)f=CT.dom.fieldList(c,null,g);else f=CT.dom.field();else if(b=="keylist")if(c)f=CT.dom.fieldList(c,function(b){return new CT.db.edit.EntityRow({property:a,key:b,modelName:d}).node;},g);else f=new CT.db.edit.EntityRow({property:a,modelName:d}).node;if(e.label&&b=="string"||b=="text")CT.dom.blurField(f,[a]);f.getValue=CT.db.edit._val(f,b);f.rowKey=a;return f;},media:function(a){a=CT.merge(a,{className:"w1",parentClass:"w1",mediaType:"img"});a.property=a.property||a.mediaType;var b=CT.dom.node(null,"div",a.parentClass),c=a.data[a.property],d=a.mediaType=="img"?"image":"video",e=CT.dom[a.mediaType](c,a.className),f=new CT.db.Blob({noNothing:true,key:a.data.key,property:a.property,value:c,firstUp:"upload "+d,className:"round hoverglow",cb:function(b){e.src=b+"?ts="+Date.now();a.data[a.property]=b;a.cb&&a.cb();}});CT.dom.setContent(b,[e,f.node]);return b;},img:function(a){CT.log("[DEPRECATION WARNING] CT.db.edit.img() is deprecated. Use CT.db.edit.media() instead.");return CT.db.edit.media(a);}};CT.db.edit.EntityRow=CT.Class({CLASSNAME:"CT.db.edit.EntityRow",mtable:function(){var a,b=CT.dom.node("","div","h9-10 scroller"),c=CT.dom.node(b,"div","h1");for(a in this.node.data)b.appendChild(CT.dom.node([CT.dom.node(a+":","div","keycell"),CT.dom.node(this.node.data[a]||"(none)","span")],"div","lister"));c.appendChild(CT.dom.button("change",this.change));CT.admin&&c.appendChild(CT.dom.button("edit",this.edit));return c;},edit:function(){CT.admin.db.starLink(this.node.data).onclick();this._modal.hide();},modal:function(){this._change&&this._change.hide();this._modal=this._modal||new CT.modal.Modal({transition:"fade",className:"basicpopup h3-5",node:this.mtable()});this._modal.show();},change:function(){this._modal&&this._modal.hide();this._change=this._change||new CT.modal.Prompt({transition:"slide",prompt:"enter name of new "+this.opts.property,cb:this.node.fill,autocomplete:CT.db.reference2label(this.opts.modelName,this.opts.property)});this._change.show();},_change_or_modal:function(){if(this.opts.key)this.modal();else this.change();},init:function(a){this.opts=a;var b=CT.data.get(a.key),c=this.node=CT.dom.node(CT.dom.link(null,this._change_or_modal),"span");c.fill=function(b){b=c.data=b||CT.db.edit._no_ent;c.value=b.key;a.key=b.key;CT.dom.setContent(c.firstChild,b.label);};if(b||!a.key)c.fill(b);else CT.db.one(a.key,function(a){CT.data.add(a);c.fill(a);});}});CT.db.Query=CT.Class({CLASSNAME:"CT.db.Query",_filter:function(){var a=CT.dom.node(null,"span"),b=this,c=CT.dom.node(null,"span"),d=CT.dom.select(this.filterables,null,null,null,null,function(){var e=b.schema[d.value];CT.dom.setContent(c,e.slice(-4)=="list"?CT.dom.select(["contains","lacks"]):CT.dom.select(["==",">","<",">=","<=","!=","like"]));CT.dom.setContent(a,CT.db.edit.input(d.value,e,null,b.modelName,b.opts));}),e=CT.dom.button("remove",function(){CT.dom.remove(d.parentNode);});d.onchange();this.filters.appendChild(CT.dom.node([d,c,a,e]));},_suborders:function(){var a=this.modelName,b=[];CT.db._rmap[a].forEach(function(c){b.push(c);CT.db._rmap[c.split(".")[0]].forEach(function(c){b.push(c+"."+a);});});return b;},_order:function(){var a=CT.dom.select(["None"].concat(this.filterables).concat(this._suborders())),b=CT.dom.select(["ascending","descending"]);b.className="hidden";a.onchange=function(){if(a.value=="None")b.classList.add("hidden");else b.classList.remove("hidden");};return CT.dom.node([a,b]);},_submit:function(){var a=null,b={},c=this.order.firstChild;if(c.value!="None")a=c.nextSibling.value=="descending"?"-"+c.value:c.value;CT.dom.each(this.filters,function(a){var c=a.firstChild,d=c.nextSibling,e=d.nextSibling;b[c.value]={comparator:d.firstChild.value,value:e.firstChild.getValue()};});this.opts.submit({modelName:this.modelName,order:a,filters:b});this.node.parentNode.parentNode.modal.hide();},_submitCb:function(a){var b=this.modelName+"query"+this.id;CT.panel.add(this.modelName+" ("+this.id+")",false,"db",CT.dom.id(this.opts.pagerPanelId),null,b);CT.db.pager(this.modelName,a.order,a.filters,b);CT.panel.swap(b,false,"db");},_build:function(){this.filters=CT.dom.node();this.order=this._order();this.node=CT.dom.node([CT.dom.node("Query: "+this.modelName,"div","bigger bold"),CT.dom.node("Order","div","big bold"),this.order,CT.dom.node([CT.dom.node("Filters","span","big bold"),CT.dom.button("add",this._filter)]),CT.dom.node("Select 'like' comparator for values such as 'MO%' (meaning 'starts with MO')","div",this.opts.showHelp&&"italic"||"hidden"),this.filters,CT.dom.button("submit",this._submit)],"div","centered");},_filterables:function(){this.filterables=[];for(var a in this.schema)if(CT.db.edit.isSupported(this.schema[a],a))this.filterables.push(a);},init:function(a){this.opts=a=CT.merge(a,{submit:this._submitCb,pagerPanelId:"dbqueries"});this.id=CT.db.Query._id;CT.db.Query._id+=1;this.modelName=a.modelName;this.schema=CT.db.getSchema(a.modelName);this._filterables();this._build();}});CT.db.Query._id=0;;window.CT.drag=window.CT.drag||{};CT.drag={_:{direction2orientation:{up:"vertical",down:"vertical",left:"horizontal",right:"horizontal"},orientation2axis:{vertical:"y",horizontal:"x"},dir2abs:{right:"backward",left:"forward",up:"forward",down:"backward"}},log:CT.log.getLogger("drag"),nativeScroll:function(a,b){CT.gesture.listen("up",a,function(){if(b.up)b.up();return true;},true,false);CT.gesture.listen("down",a,function(){if(b.down)b.down();return true;},true,false);var c={up:"down",down:"up",right:"left",left:"right"},d,e,f=function(){if(e){clearTimeout(e);e=null;}e=setTimeout(function(){b.drag(c[d],0,0,0);},100);};CT.gesture.listen("drag",a,function(c,e,f,g){if(a.noDrag)return;var h=(a.parentNode.scrollHeight-a.parentNode.scrollTop===a.parentNode.clientHeight),i=(a.parentNode.scrollTop===0),j=(a.parentNode.scrollLeft===0),k=(a.parentNode.clientWidth+a.parentNode.scrollLeft===a.parentNode.scrollWidth);d=c;if(b.drag)b.drag(c,e,f,g);if((i&&c=="down")||(h&&c=="up"))return false;return b.constraint!=CT.drag._.direction2orientation[c];},true,false);CT.gesture.listen("swipe",a,function(c,d,e,f,g){if(c=="up"&&(a.parentNode.scrollTop>=(a.parentNode.scrollHeight-(a.parentNode.clientHeight+800)))&&b.swipe)b.swipe();},true,false);a.parentNode.addEventListener('scroll',function(a){if(b.scroll)b.scroll(a);if(b.drag)f();return true;},false);},makeDraggable:function(a,b){b=b||{};if(!b.interval&&!b.force&&!CT.info.isStockAndroid)return CT.drag.nativeScroll(a.firstChild,b);var c=CT.drag._;a.xDrag=0;a.yDrag=0;a.classList.add('hardware-acceleration');a.style['-webkit-transform']="translate3d(0,0,0)";a.parentNode.addEventListener('scroll',function(a){return false;},false);var d=function(){return b.interval=="auto"?(CT.align[b.constraint=="horizontal"?"height":"width"](a)/a.childNodes.length):b.interval;};var e=function(){if(a.animating)return;a.dragging=false;a.touchedDown=true;a.animating=false;a.xDragStart=a.xDrag;a.yDragStart=a.yDrag;if(b.down)b.down();};var f=function(c){var e=0,f=0,g=false,h=d();a.touchedDown=a.dragging=false;if(a.animating==false){if(h){if(b.constraint!="vertical"){f=a.yDrag%h;if(f!=0){if(Math.abs(f)<=(h/2))a.yDrag-=f;else a.yDrag-=(h+f);if(a.yDrag<a.yDragStart)c="up";else if(a.yDrag>a.yDragStart)c="down";else c="hold";}}if(b.constraint!="horizontal"){e=a.xDrag%h;if(e!=0){if(Math.abs(e)<=(h/2))a.xDrag-=e;else a.xDrag-=(h+e);if(a.xDrag<a.xDragStart)c="left";else if(a.xDrag>a.xDragStart)c="right";else c="hold";}}if(c){a.animating=true;CT.trans.translate(a,{x:a.xDrag,y:a.yDrag,cb:function(){a.animating=false;}});}}else{if(b.constraint!="horizontal")if(a.xDrag>0){a.xDrag=0;g=true;c="right";}else if(Math.abs(a.xDrag)>(a.scrollWidth-a.parentNode.clientWidth)){a.xDrag=-(a.scrollWidth-a.parentNode.clientWidth);g=true;c="left";}if(b.constraint!="vertical")if(a.yDrag>0){a.yDrag=0;g=true;c="up";}else if(a.yDrag<-(a.scrollHeight-a.parentNode.clientHeight)){a.yDrag=-(a.scrollHeight-a.parentNode.clientHeight);g=true;c="down";}if(g){a.animating=true;CT.trans.translate(a,{x:a.xDrag,y:a.yDrag,cb:function(){a.animating=false;if(b.drag)b.drag(c,0,0,0);if(b.scroll)b.scroll();}});}}if(b.up)b.up(c);}};var g=function(c,d,e,f){if(a.touchedDown&&!a.noDrag){a.dragging=true;if(b.constraint!="vertical")if(a.yDrag>-(a.scrollHeight-(2*a.parentNode.clientHeight/3)))a.yDrag+=f;if(b.constraint!="horizontal")if(Math.abs(a.xDrag)<(a.scrollWidth-(2*a.parentNode.clientWidth/3)))a.xDrag+=e;CT.trans.setVenderPrefixed(a,"transform","translate3d("+a.xDrag+"px,"+a.yDrag+"px,0)");if(b.drag)b.drag(c,d,e,f);if(b.scroll)b.scroll();}};var h=function(b){if(b=="horizontal")return a.parentNode.clientWidth-a.scrollWidth;else if(b=="vertical")return a.parentNode.clientHeight-a.scrollHeight;};var i=function(e,g,i,j,k){var l,m,n,o,p,q,r=d();if(a.animating)return;if(c.direction2orientation[e]==b.constraint)return b.up&&b.up(e);for(l in c.orientation2axis){m=c.dir2abs[e];n=c.orientation2axis[l];o=a[n+"Drag"];p=h(l);q=r?(o%r):(l=="vertical"?-j:-i);if(b.constraint!=l&&o<=0&&o>p)if(m=="backward")a[n+"Drag"]-=q;else if(m=="forward")a[n+"Drag"]+=(r?-(r+q):q);else return CT.drag.log("swipeCallback",e,"has no abs dir!");}a.animating=true;CT.trans.translate(a,{x:a.xDrag,y:a.yDrag,cb:function(){a.animating=false;f(e);}});};if(a.isDraggable)CT.gesture.unlisten(a);a.isDraggable=true;CT.gesture.listen("drag",a,g);CT.gesture.listen("down",a,e);CT.gesture.listen("swipe",a,i);CT.gesture.listen("up",a,f);}};;window.CT.dom=window.CT.dom||{};CT.dom={"_autoparse":false,"setAutoparse":function(a){CT.dom._autoparse=a;},"_nodes":{},"_obj2node":function(a){var b=[];if(a.builder){a.content=a.items.map(function(b){return a.builder(b);});delete a.builder;delete a.items;}["content","type","classname","id"].forEach(function(c){b.push(a[c]);delete a[c];});b.push(a);if(a.style){b.push(a.style);delete a.style;}return CT.dom.node.apply(null,b);},"node":function(a,b,c,d,e,f){var g=document.createElement(b||"div");if(a!=null)if(Array.isArray(a))a.forEach(function(a){g.appendChild(a instanceof Node?a:CT.dom.node(a));});else if(a instanceof Node)g.appendChild(a);else if(typeof a=="function")g.appendChild(a());else if(typeof a=="object")return CT.dom._obj2node(a);else if((typeof a=="string"&&a.length)||typeof a=="number")if(b=="table")alert("illegal innerHTML set on table! content: "+a);else if(b=="style"){g.type='text/css';if(g.styleSheet)g.styleSheet.cssText=a;else g.appendChild(document.createTextNode(a));}else{if(CT.dom._autoparse)a=CT.parse.process(a.toString());g.innerHTML=a;}if(c)g.className=c;if(d){g.id=d;CT.dom._nodes[d]=g;}g.on=function(a,b){if(b)return g.addEventListener(a,b);for(var c in a)g.addEventListener(c,a[c]);};if(e)for(var h in e){if(e[h]==null)continue;if(h=="value"||h=="onclick")g[h]=e[h];else if(h.slice(0,2)=="on")g.on(h.slice(2),e[h]);else g.setAttribute(h,e[h]);}if(f)for(var i in f)g.style[i]=f[i];return g;},"div":function(a,b,c,d,e){return CT.dom.node(a,"div",b,c,d,e);},"span":function(a,b,c,d,e){return CT.dom.node(a,"span",b,c,d,e);},"script":function(a,b,c){if(c)b="setTimeout(function() { "+b+" }, "+c+");";return CT.dom.node(b,"script",null,null,{"src":a});},"link":function(a,b,c,d,e,f,g){if(f==null)f={};if(b)f.onclick=b;if(c)f.href=c;if(g)f.target="_blank";return CT.dom.node(a,"a",d,e,f);},"button":function(a,b,c,d){return CT.dom.node(a,"button",c,d,{"onclick":b});},"field":function(a,b,c,d,e){e=e||{};if(b)e.value=b;if(d)e.type=d;return CT.dom.node("","input",c,a,e);},"file":function(a,b,c,d){return CT.dom.field(b,null,c,"file",{onchange:a,multiple:d});},"fieldList":function(a,b,c){var d=function(a){return b?b(a):CT.dom.field(null,a);},e=function(a){var b=CT.dom.button("remove",function(){CT.dom.remove(b.parentNode);});return CT.dom.node([b,d(a)]);},f=CT.dom.node(a&&a.map(e),null,null,null,null,c);f.empty=d();f.addButton=CT.dom.button("add",function(){if(f.empty.value){f.insertBefore(e(f.empty.value),f.firstChild);if(f.empty.fill)f.empty.fill();else f.empty.value="";}});f.addButton.style.width="57px";f.value=function(){return CT.dom.map(f,function(a){return a.lastChild.value;});};return f;},"textArea":function(a,b,c){return CT.dom.node("","textarea",c,a,b&&{"value":b}||null);},"img":function(a,b,c,d,e,f,g,h,i,j,k){if(arguments.length==1&&typeof arguments[0]!="string"){var l=arguments[0];a=l.src;b=l.imgclass;c=l.onclick;d=l.href;e=l.target;f=l.title;g=l.linkid;h=l.wrapperclass;i=l.imgid;j=l.noanchor;k=l.style;}var m=CT.dom.node("","img",b,i,{"src":a},k);if(j)m.onclick=c;else if(c||d){var n=CT.dom.link("",c,d);if(e)n.target=e;if(f)n.title=n.alt=f;if(g)n.id=g;if(h)m=CT.dom.div(m,h);n.appendChild(m);return n;}return m;},"panImg":function(a){a=CT.merge(a,{pan:true,panDuration:5000,className:"abs all0 noflow below"});var b=CT.dom.div(CT.dom.img(a.img,"abs"),a.className);if(a.pan){b.controller=CT.trans.pan(b.firstChild,{duration:a.panDuration},true);if(a.controllerHook){a.controllerHook.hide=b.controller.pause;a.controllerHook.show=b.controller.resume;}}return b;},"select":function(a,b,c,d,e,f,g){b=b||a;var h=CT.dom.node("","select","",c);if(g){e=e||"other";if(b.indexOf("other")==-1){b.push("other");if(b!=a)a.push("other");}h.other=CT.dom.field(null,(b.indexOf(d)==-1)&&d,"hidden");h.container=CT.dom.node([h,h.other]);h.container.value=function(){if(h.value=="other")return h.other.value.trim();return h.value;};}for(var i=0;i<a.length;i++)h.appendChild(CT.dom.node(a[i],"option","","",{"value":b[i]}));if(d)h.value=b.indexOf(d)!=-1&&d||e;h.onchange=function(){if(g)if(h.value=="other")h.other.style.display="block";else h.other.style.display="none";f&&f();};setTimeout(h.onchange);return h.container||h;},"range":function(a,b,c,d,e,f,g){var h=CT.dom.node("","input",f,g,{"type":"range","oninput":a&&function(){a(h.value);},"min":b,"max":c,"value":d,"step":e});return h;},"checkbox":function(a,b,c){var d={"type":"checkbox"};if(b)d.checked=b;return CT.dom.node("","input","",a,d,c);},"wrapped":function(a,b,c,d,e){CT.log("[DEPRECATION WARNING] CT.dom.wrapped() is deprecated. Use CT.dom.node().");var f=CT.dom.node("",b,c,d,e);if(!Array.isArray(a))a=[a];for(var g=0;g<a.length;g++)f.appendChild(a[g]);return f;},"audio":function(a,b,c,d,e,f,g,h,i,j,k){if(arguments.length==1&&typeof arguments[0]!="string"){var l=arguments[0];a=l.src;b=l.controls;c=l.autoplay;d=l.preload;e=l.onplay;f=l.onended;g=l.className;h=l.id;i=l.atts;j=l.oncanplay;k=l.onpause;}i=i||{};i.src=a;if(b)i.controls="true";if(c)i.autoplay="true";if(e)i.onplay=e;if(k)i.onpause=k;if(f)i.onended=f;if(j)i.oncanplay=j;i.preload=i.preload||d||"none";return CT.dom.node("","audio",g,h,i);},"video":function(a,b,c,d,e,f,g,h,i,j){if(arguments.length==1&&typeof arguments[0]!="string"){var k=arguments[0];a=k.src;b=k.className;c=k.id;d=k.attrs;e=k.style;f=k.oncanplay;g=k.onended;h=k.onplay;i=k.onpause;j=k.poster;}d=d||{};var l=false;if(a&&a.length&&typeof a!="string")l=true;else d.src=a;if(h)d.onplay=h;if(i)d.onpause=i;if(g)d.onended=g;if(f)d.oncanplay=f;if(j)d.poster=j;var m=CT.dom.node(l&&a.map(function(a){return CT.dom.node(null,"source",null,null,{src:a});}),"video",b,c,d,e);m.stream=function(a){m.src=window.URL.createObjectURL(a);m.play();};return m;},"iframe":function(a,b,c){var d=CT.dom.node("","iframe",b,c,{"src":a});d.setHash=function(a){CT.dom.getLoc(d).hash=a;};return d;},"pad":function(a){a=a||1;var b="";for(var c=0;c<a;c++)b+="&ensp;";return CT.dom.node(b,"span");},"br":function(a){a=a||1;var b=[];for(var c=0;c<a;c++)b.push(CT.dom.node(null,"br"));return CT.dom.node(b);},"marquee":function(a,b,c,d){var e=CT.dom.node(a,"marquee",b,null,{direction:c||"left",behavior:"alternate"});!d&&setTimeout(function(){CT.dom.each(e,function(a){a.style.height=e.clientHeight+"px";});});return e;},"getDoc":function(a){return a.documentWindow||a.contentWindow||a.contentDocument;},"getLoc":function(a){return CT.dom.getDoc(a).location;},"checkboxAndLabel":function(a,b,c,d,e,f){if(!c&&a.indexOf(" ")!=-1){c=a;a=a.replace(/ /g,"");}var g=CT.dom.node("","div",e);var h=a+"checkbox";var i=CT.dom.checkbox(h,b);g.appendChild(i);if(f)i.onclick=function(){f(i);};g.appendChild(CT.dom.node(c||a,"label",d,"",{"for":h,"htmlFor":h}));g.isChecked=function(){return i.checked;};return g;},"resizeTextArea":function(a){if(navigator.appName.indexOf("Microsoft Internet Explorer")==0)a.style.overflow='visible';else{while(a.rows>1&&a.scrollHeight<a.offsetHeight)a.rows--;while(a.scrollHeight>a.offsetHeight)a.rows++;}},"labelAndField":function(a,b,c,d,e,f,g){b=b||a.replace(/ /g,"");var h=CT.dom.node();var i=CT.dom[(f&&"textArea"||"field")](b,e,"right "+(c||""),(a.indexOf("Password")!=-1)&&"password"||null);if(f&&g)i.onkeyup=function(){CT.dom.resizeTextArea(i);return true;};h.appendChild(i);h.appendChild(CT.dom.node(a,"label",d,null,{"for":b,"htmlFor":b}));h.appendChild(CT.dom.node("","div","clearnode"));return h;},"_radioStripStep":function(a,b,c,d,e,f,g){var h=(e||"radiostrip")+(f||"")+c;var i=CT.dom.field(h,null,null,"radio");i.name=(e||"")+(f||"");i.onclick=function(){d(c);};if(g)i.checked=true;a.insertCell(-1).appendChild(i);b.insertCell(-1).appendChild(CT.dom.node(c,"label",null,null,{"htmlFor":h,"for":h}));},"radioStrip":function(a,b,c,d,e,f){var g=CT.dom.node("","table");g.style.textAlign="center";var h=g.insertRow(0);var i=g.insertRow(1);for(var j=0;j<b.length;j++)CT.dom._radioStripStep(h,i,b[j],c,d,e,b[j]==f);a.appendChild(g);},"linkWithIcon":function(a,b,c,d){var e=CT.dom.node("","span");e.appendChild(CT.dom.img(a,"vmiddle rpaddedsmall nodecoration",d,c));e.appendChild(CT.dom.link(b,d,c));return e;},"labeledImage":function(a,b,c,d,e,f,g,h,i){var j=CT.dom.link();var k=CT.dom.img(a,e);var l=CT.dom.node(c,"div",g);if(h){j.appendChild(l);j.appendChild(k);}else{j.appendChild(k);j.appendChild(l);}j.title=j.alt=d||c;var m=CT.dom.node(j,"div",f);if(b){j.href=b;j.target="_blank";}else if(i)m.onclick=i;return m;},"buildForm":function(a,b){var c=document.getElementById(a+"Table");for(var d=0;d<b.length;d++){var e=b[d];var f=a+e.replace(/ /g,"");var g=c.insertRow(-1);g.insertCell(0).appendChild(CT.dom.node(e,"label","","",{"htmlFor":f,"for":f}));var h=CT.dom.field(f);if(e.indexOf("Password")!=-1)h.type="password";g.insertCell(1).appendChild(h);}return c;},"timer":function(a,b,c,d,e){var f=CT.dom.node(a,"div",c,d,e);f._sec=a;f._check=function(){f._sec-=1;f.innerHTML=f._sec;if(f._sec==0){f.stop();b&&b();}};f.set=function(a){f.innerHTML=f._sec=a;};f.start=function(){f.stop();f._interval=setInterval(f._check,1000);};f.stop=function(){if(f._interval){clearInterval(f._interval);f._interval=null;}};f.start();return f;},"choices":function(a,b,c,d,e){d=d||"grayback";var f=CT.dom.node();f._sel=null;f.value=b?[]:-1;a.forEach(function(a,g){a.onclick=function(){if(!b&&f._sel)f._sel.classList.remove(d);f._sel=a;if(a.classList.contains(d)){a.classList.remove(d);if(b)CT.data.remove(f.value,g);else f.value=[];}else{a.classList.add(d);if(b)CT.data.append(f.value,g);else f.value=g;}e&&e(g);};a.classList.add(c||"choice_cell");f.appendChild(a);});return f;},"form":function(a,b,c,d,e){return CT.dom.node(a,"form",d,e,{method:c||"post",action:b});},"spinner":function(){return CT.dom.node(CT.dom.node([CT.dom.node("loading...","strong"),CT.dom.node("","span")],"div","ctspinner"),"div","ctswrap");},"_monthnames":["January","February","March","April","May","June","July","August","September","October","November","December"],"currentyear":Math.max(new Date().getFullYear(),2014),"dateSelectors":function(a,b,c,d,e,f,g){if(arguments.length==1&&!(arguments[0] instanceof Node)){var h=arguments[0];a=h.node;b=h.d;c=h.startdate;d=h.enddate;e=h.withtime;f=h.noday;g=h.val;}var i=["Year"];c=c||CT.dom.currentyear;d=d||CT.dom.currentyear;for(var j=c;j<=d;j++)i.push(j);a=a||CT.dom.node(null,"span");b=b||a;b.year=CT.dom.select(i);b.month=CT.dom.select(["Month"].concat(CT.dom._monthnames),["Month","01","02","03","04","05","06","07","08","09","10","11","12"]);a.appendChild(b.year);a.appendChild(b.month);if(!f){b.day=CT.dom.select(["Day","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]);a.appendChild(b.day);}if(e){var k=["Time"];for(var j=0;j<24;j++){var l=j<10?"0"+j:j;k.push(l+":"+"00");k.push(l+":"+"30");}b.time=CT.dom.select(k);a.appendChild(b.time);}if(g){var m=g.split(" "),n=m[0].split("-");b.year.value=n[0];b.month.value=n[1];if(!f)b.day.value=n[2];if(e)b.time.value=m[1].slice(0,-3);}b.value=function(){if(b.year.value=="Year"||b.month.value=="Month"||(!f&&b.day.value=="Day"))return null;var a=b.year.value+"-"+b.month.value;if(!f)a+="-"+b.day.value;if(e)a+=" "+b.time.value+":00";else a+=" 00:00:00";return a;};return a;},"_pwpcb":null,"passwordPrompt":function(a){CT.log("[DEPRECATION WARNING] CT.dom.passwordPrompt() is deprecated. Use CT.Prompt instead.");CT.dom._pwpcb=a;var b=document.getElementById("passwordprompt");var c=document.getElementById("pwpfield");if(b==null){b=CT.dom.node("","div","hidden basicpopup centered","passwordprompt");document.body.appendChild(b);b.appendChild(CT.dom.node("For your own security, please enter your password.","div","bottompadded"));c=CT.dom.field("pwpfield",null,null,"password");b.appendChild(c);var d=function(){if(!CT.parse.validPassword(c.value))return alert("invalid password!");b.style.display="none";CT.dom._pwpcb(c.value);};CT.dom.inputEnterCallback(c,d);b.appendChild(CT.dom.button("Continue",d));b.appendChild(CT.dom.button("Cancel",function(){b.style.display="none";}));}c.value="";b.style.display="block";c.focus();CT.align.centered(b);},"_blurs":{},"setBlur":function(a,b){CT.dom._blurs[a]=b;},"getFieldValue":function(a,b,c){var d=CT.dom.id(a)||a;if(!d)return null;if(b)for(var e=0;e<b.length;e++)d=d[b[e]];var f=d.container?d.container.value():d.value,g=CT.dom._blurs[a]||d._blurs;if(!f||(g&&g.indexOf(f)!=-1))return "";if(c){if(c.requires)for(var e=0;e<c.requires.length;e++)if(f.indexOf(c.requires[e])==-1){f="";break;}if((f&&f.length||0)<(c.length||0))f="";}return f;},"blurField":function(a,b){b=CT.dom._blurs[a.id]=a._blurs=b||CT.dom._blurs[a.id]||a._blurs;var c=a.type=="password";if(b){a.onblur=function(){if(a.value==""){if(c)a.type="";a.classList.add("gray");a.value=b[Math.floor(Math.random()*b.length)];}else a.classList.remove("gray");};a.onfocus=function(){if(b.indexOf(a.value)!=-1){a.value="";if(c)a.type="password";a.classList.remove("gray");}};a.onblur();}},"setFieldValue":function(a,b,c){var d=document.getElementById(b);if(!d)return setTimeout(CT.dom.setFieldValue,500,a,b,c);if(c)for(var e=0;e<c.length;e++)d=d[c[e]];d.value=a||"";CT.dom.blurField(d);},"genfield":function(a,b,c,d,e,f){var g=CT.dom.field("up"+a,e||d[a],"right w280",(a.indexOf("password")!=-1)&&"password"||null);c[a]=g;b.appendChild(g);b.appendChild(CT.dom.node(CT.parse.key2title(a),"label","bold",null,{"for":"up"+a,"htmlFor":"up"+a}));if(f){b.appendChild(CT.dom.node("&nbsp;&nbsp;","span"));b.appendChild(f);}b.appendChild(CT.dom.node("","div","clearnode"));},"inputEnterCallback":function(a,b,c){a.onenter=function(){if(c)document.getElementById(c).focus();if(b&&(b(a.value)=="clear"))a.value="";};a.addEventListener("keyup",function(b){b=b||window.event;var c=b.keyCode||b.which;if(c==13||c==3)a.onenter();});return a;},"smartField":function(a,b,c,d,e,f,g){if(arguments.length==1&&typeof arguments[0]!="function"){var h=arguments[0];a=h.cb;b=h.classname;c=h.id;d=h.value;e=h.type;f=h.blurs;g=h.isTA;}c=c||("sf"+Math.floor((Math.random()*100000)));var i=CT.dom.inputEnterCallback(CT.dom[g?"textArea":"field"](c,d,b,e),a,c);if(f)CT.dom.blurField(i,f);return i;},"_isVerticalOrientation":function(a){if(a.clientHeight==0||a.clientWidth==0)return undefined;return a.clientWidth/a.parentNode.clientWidth<a.clientHeight/a.parentNode.clientHeight;},"cover":function(a){var b=CT.dom._isVerticalOrientation(a);if(b==undefined)return b;a.classList.add(b?"w1":"h1");a.classList.remove(b?"h1":"w1");return b;},"contain":function(a){var b=CT.dom._isVerticalOrientation(a);if(b==undefined)return b;a.classList.add(b?"h1":"w1");a.classList.remove(b?"w1":"h1");return b;},"fit":function(a){a.fit=function(){if(a.scrollHeight!=a.clientHeight){var b=parseInt(getComputedStyle(a).fontSize);a.style.fontSize=(b-1)+"px";setTimeout(a.fit);}};CT.onresize(a.fit);},"_ricounter":0,"_get_ta_id":function(){var a="richinput"+CT.dom._ricounter;CT.dom._ricounter+=1;return a;},"richInput":function(a,b,c,d,e,f,g){b=b||CT.dom._get_ta_id();e=e||500;var h=CT.dom.textArea(b,d,"fullwidth");CT.dom.blurField(h,f);a.appendChild(CT.dom.node(h));var i=CT.dom.node("("+e+" chars left)","div","right",b+"cc");h.onkeyup=function(a){a=a||window.event;var c=CT.dom.getFieldValue(b).length;if(c>e){h.value=h.value.slice(0,e);i.className="right bold";if(a.preventDefault)a.preventDefault();return false;}else i.className="right";i.innerHTML="("+(e-c)+" chars left)";CT.dom.resizeTextArea(h);return true;};a.appendChild(i);if(c)a.appendChild(c);else if(!g)a.appendChild(CT.dom.node("","div","clearnode"));return h;},"showHideT":function(a){a=a||document.body;a.style.opacity=a.style.opacity=="1"&&"0"||"1";},"showHideV":function(a,b,c){a=a||document.body;if(b)a.style.visibility="visible";else if(c)a.style.visibility="hidden";else a.style.visibility=a.style.visibility=="visible"&&"hidden"||"visible";},"showHide":function(a,b,c,d){a=a||document.body;if(typeof a=="string")a=CT.dom.id(a);d=d||"block";if(b||c)a.style.display=b&&d||"none";else if(a.style.display==""&&a.className.indexOf("hidden")==-1)a.style.display="none";else a.style.display=(a.style.display==d)&&"none"||d;},"showHideSet":function(a,b,c,d){for(var e=0;e<a.length;e++)CT.dom.showHide(a[e],b,c,d);},"show":function(a,b){CT.dom.showHide(a,true,false,b);},"hide":function(a){CT.dom.showHide(a,false,true);},"showV":function(a){CT.dom.showHideV(a,true);},"hideV":function(a){CT.dom.showHideV(a,false,true);},"remove":function(a){if(!a)return;if(typeof a=="string")a=CT.dom.id(a);a&&a.parentNode&&a.parentNode.removeChild(a);},"replace":function(a,b){if(a.parentNode){a.parentNode.insertBefore(typeof b=="string"?CT.dom.node(b):b,a);a.parentNode.removeChild(a);}},"clear":function(a){if(typeof a=="string")a=CT.dom.id(a);(a||document.body).innerHTML="";},"addContent":function(a,b,c){if(typeof b=="function")b=b();if(Array.isArray(b))b=CT.dom.div(b,c);if(typeof a=="string")a=CT.dom.id(a,true);if(typeof b=="string"||typeof b=="number")a.innerHTML+=b;else if(b)a.appendChild(b);},"setContent":function(a,b,c){CT.dom.clear(a);CT.dom.addContent(a,b,c);},"addEach":function(a,b){b.forEach(function(b){a.appendChild(b);});},"ALLNODE":null,"loadAllNode":function(a){if(!CT.dom.ALLNODE){CT.dom.ALLNODE=document.getElementById("all")||(a&&document.body);CT.dom.ALLNODE._mobile=CT.align.width()<=720;window.onresize=function(){CT.dom.ALLNODE.resize&&CT.dom.ALLNODE.resize();CT.align.resize();};}},"getAllNode":function(a){CT.dom.loadAllNode(a);return CT.dom.ALLNODE;},"showAllNode":function(){var a=CT.dom.ALLNODE;a.style.opacity=a.style["-moz-opacity"]=a.style["-khtml-opacity"]="1";a.style.filter="alpha(opacity = 100)";a.style["-ms-filter"]="progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";},"addStyle":function(a,b,c){if(c){a=[];for(var d in c){a.push(d+" {");var e=c[d];for(var f in e)a.push(f+": "+e[f]+";");a.push("}");}a=a.join("\n");}var g=b?CT.dom.node(null,"link",null,null,{"href":b,"rel":"stylesheet"}):CT.dom.node(a,"style");CT.dom.head(g);},"doWhenNodeExists":function(a,b){if(document.getElementById(a))return b();setTimeout(CT.dom.doWhenNodeExists,500,a,b);},"id":function(a,b){return document.getElementById(a)||b&&CT.dom._nodes[a];},"_narr2arr":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b;},"className":function(a,b){return CT.dom._narr2arr((b||document).getElementsByClassName(a));},"tag":function(a,b){return CT.dom._narr2arr((b||document).getElementsByTagName(a));},"attr":function(a,b,c){var d=CT.dom.Q("["+(b?(a+'="'+b+'"'):a)+"]");return c?d[0]:d;},"Q":function(a,b){return CT.dom._narr2arr((b||document.body).querySelectorAll(a));},"head":function(a){var b=CT.dom.tag("head")[0];if(a)b.appendChild(a);return b;},"meta":function(a,b){var c=CT.dom.node(null,"meta");c.name=a;c.content=b;CT.dom.head(c);},"each":function(a,b){for(var c=0;c<a.childNodes.length;c++)b(a.childNodes[c]);},"map":function(a,b){var c=[];for(var d=0;d<a.childNodes.length;d++)c.push(b(a.childNodes[d]));return c;},"mod":function(a){var b=a.targets?a.targets:(a.target?[a.target]:(a.className?CT.dom.className(a.className):(a.id?[CT.dom.id(a.id)]:[]))),c=a.property||"display",d=a.value||(a.show?"block":a.hide?"none":""),e=a.modz;if(!e){e={};e[c]=d;}Object.keys(e).forEach(function(a){for(var c=0;c<b.length;c++)b[c].style[a]=e[a];});}};;window.CT.file=window.CT.file||{};CT.file={getter:function(a,b){var c=CT.dom.file(function(d){if(b){var e=[];for(var f=0;f<c.files.length;f++)e.push(new CT.file.File({input:c,path:c.files[f].name,file:c.files[f]}));a(e);}else a(new CT.file.File({input:c,path:c.value,file:c.files[0]}));},null,null,b);return c;},make:function(a){if(!Array.isArray(a))a=[a];return new CT.file.File({file:new Blob(a)});}};CT.file.File=CT.Class({CLASSNAME:"CT.file.File",download:function(a,b,c){b=b||"download";var d=CT.dom.link(b,null,this.url,c,null,null,true);d.download=a||this.name()||b;return d;},name:function(){return this.opts.path&&this.opts.path.split("\\").pop();},upload:function(a,b,c){var d=this.opts.file,e={};if(c){e["Content-Type"]="multipart/form-data";d=CT.net.formData(this.opts.file,c);}CT.net.put(a,d,b,e,true,null,null,true);},init:function(a){this.opts=a;if(a.input)a.input.ctfile=this;this.url=window.URL.createObjectURL(a.file);}});;window.CT.gesture=window.CT.gesture||{};CT.gesture={gid:0,preventDefault:true,thresholds:{swipe:{minDistance:35,maxTime:400,minDP:600,maxDP:1000},drag:{minDP:0,maxDP:1000},tap:{maxDistance:10,maxTime:700,waitTime:300,maxCount:2},hold:{maxDistance:null,interval:1000},up:{androidDelay:600},pinch:{},zoom:{min:0.25,max:8,slow:2,wheel:{enabled:!CT.info.mobile&&!CT.info.isMac,jump:0.2}}},_vars:{active:false,startTime:null,dragTime:null,startPos:null,lastPos:null,tapCount:0,holdCount:0,zoomLevel:1,tapTimeout:null,holdInterval:null,stopTimeout:null,firstPinch:null,stopPropagation:false,preventDefault:false,iosPinch:false,iosPinching:false},gevents:{GestureStart:"gesturestart",GestureChange:"gesturechange",GestureEnd:"gestureend"},events:(CT.info.mobile||CT.info.android||CT.info.iOs)&&{Start:"touchstart",Stop:"touchend",Move:"touchmove",Cancel:"touchcancel"}||{Start:"mousedown",Stop:"mouseup",Move:"mousemove"},handlers:{drag:{},swipe:{},tap:{},up:{},down:{},hold:{},pinch:{},hover:{},wheel:{}},tuneThresholds:function(){if(!CT.info.iOs)for(var a in CT.gesture.thresholds)for(var b in CT.gesture.thresholds[a]){var c=b.slice(3);if(c=="Distance")CT.gesture.thresholds[a][b]/=2;else if(c=="DP")CT.gesture.thresholds[a][b]*=2;}},getPos:function(a){if(a.x==undefined){a.x=a.pageX||a.changedTouches[0].pageX;a.y=a.pageY||a.changedTouches[0].pageY;}return{x:a.x,y:a.y};},getDiff:function(a,b,c){var d={};d.x=b.x-a.x;d.y=b.y-a.y;d.distance=Math.sqrt((d.x*d.x)+(d.y*d.y));if(c)d.midpoint=CT.gesture.getMidpoint([a,b]);if(Math.abs(d.x)>Math.abs(d.y))d.direction=d.x>0?'right':'left';else d.direction=d.y>0?'down':'up';return d;},pinchDiff:function(a){return CT.info.iOs?{x:a.pageX,y:a.pageY}:CT.gesture.getDiff(CT.gesture.getPos(a.touches[0]),CT.gesture.getPos(a.touches[1]),true);},getMidpoint:function(a){var b=function(b){return(a[0][b]+a[1][b])/2;};return{x:b('x'),y:b('y')};},pixelsPerSecond:function(a,b,c){var d=CT.gesture.thresholds[c];return Math.min(d.maxDP,Math.max(d.minDP,a/b))*(CT.info.iOs?1:0.5);},isMulti:function(a){return CT.info.mobile&&a.touches.length>1;},onGestureStart:function(a,b){},onGestureChange:function(a,b){CT.gesture.triggerPinch(b,Math.pow(a.scale,(1/8)),CT.gesture.pinchDiff(a));},onGestureEnd:function(a,b){CT.gesture.triggerPinch(b,Math.pow(a.scale,(1/8)),CT.gesture.pinchDiff(a));b.gvars.iosPinching=false;},onStart:function(a,b){var c=CT.gesture.thresholds;var d=b.gvars;d.active=true;d.holdCount=0;d.startTime=d.dragTime=Date.now();d.startPos=d.lastPos=CT.gesture.getPos(a);if(d.tapTimeout){clearTimeout(d.tapTimeout);d.tapTimeout=null;}if(CT.gesture.isMulti(a))if(CT.info.android)d.firstPinch=CT.gesture.pinchDiff(a);else d.iosPinching=true;else d.holdInterval=setInterval(function(){if(!d.active||(c.hold.maxDistance&&(c.hold.maxDistance<CT.gesture.getDiff(d.startPos,d.lastPos).distance))){clearInterval(d.holdInterval);d.holdInterval=null;return;}d.holdCount+=1;CT.gesture.triggerHold(b,c.hold.interval*d.holdCount);},c.hold.interval);return CT.gesture.triggerDown(b,CT.gesture.getPos(a));},onStop:function(a,b,c){var d=b.gvars;if(!c&&d.holdInterval){clearInterval(d.holdInterval);d.holdInterval=null;}if(!d.active)return;var e=CT.gesture.thresholds;var f=CT.gesture.getPos(a);var g=CT.gesture.getDiff(d.startPos,f);var h=Date.now()-d.startTime;d.active=!!(a.touches&&a.touches.length);if(!d.active&&!d.iosPinching)if((h<e.swipe.maxTime)&&(g.distance>e.swipe.minDistance))CT.gesture.triggerSwipe(b,g.direction,g.distance,g.x,g.y,CT.gesture.pixelsPerSecond(g.distance,h,"swipe"));else if((h<e.tap.maxTime)&&(g.distance<e.tap.maxDistance)){d.tapCount+=1;if(d.tapCount==e.tap.maxCount)CT.gesture.triggerTap(b);else d.tapTimeout=setTimeout(CT.gesture.triggerTap,e.tap.waitTime,b);}return CT.gesture.triggerUp(b,c);},onMove:function(a,b){var c=b.gvars,d=CT.gesture.getPos(a);if(c.active){var e,f=CT.gesture.getDiff(c.lastPos,d),g=Date.now(),h=g-c.dragTime;c.lastPos=d;c.dragTime=g;if(!CT.gesture.isMulti(a)){var i=CT.info.mobile&&CT.gesture.triggerHover(b,d);return CT.gesture.triggerDrag(b,f.direction,f.distance,f.x,f.y,CT.gesture.pixelsPerSecond(f.distance,h,"drag"))||i;}if(CT.info.android){e=CT.gesture.pinchDiff(a);CT.gesture.triggerPinch(b,e.distance/c.firstPinch.distance,e.midpoint);}}else return CT.gesture.triggerHover(b,d);},onWheel:function(a,b){CT.gesture.triggerWheel(b,CT.gesture.getPos(a),a.deltaY);},gWrap:function(a){var b={};['GestureStart','GestureChange','GestureEnd'].forEach(function(c){b[c]=function(b){b.preventDefault();b.stopPropagation();return CT.gesture['on'+c](b,a)||false;};});return b;},eWrap:function(a){var b={};['Start','Stop','Move'].forEach(function(c){b[c]=function(b){a.gvars.preventDefault&&b.preventDefault();a.gvars.stopPropagation&&b.stopPropagation();return CT.gesture['on'+c](b,a)||(CT.gesture.preventDefault&&b.preventDefault())||b.stopPropagation()||false;};});if(CT.gesture.events.Cancel)b.Cancel=b.Stop;return b;},zoom:function(a,b,c){var d=CT.gesture.thresholds.zoom,e=a.gvars;e.zoomLevel=a.style.zoom=Math.max(d.min,Math.min(d.max,Math.pow(b*e.zoomLevel,1/d.slow)));},pinch2zoom:function(a){var b=CT.gesture.thresholds.zoom.wheel,c=a.gvars;CT.gesture.listen('pinch',a,function(b,c){CT.gesture.zoom(a,b,c);},true,true);b.enabled&&CT.gesture.listen("wheel",a,function(d,e){CT.gesture.zoom(a,c.zoomLevel*(1+(e>0?-b.jump:b.jump)),d);});},listen:function(a,b,c,d,e){if(!b.gid){b.gid=++CT.gesture.gid;var f=b.listeners=CT.gesture.eWrap(b);for(var g in CT.gesture.events)b.addEventListener(CT.gesture.events[g],f[g]);b.gvars=CT.merge(CT.gesture._vars);}if(a=="pinch"&&CT.info.iOs){var h=CT.gesture.gWrap(b);for(var g in CT.gesture.gevents)b.addEventListener(CT.gesture.gevents[g],h[g]);for(var i in h)b.listeners[i]=h[i];b.gvars.iosPinch=true;}else if(a=="wheel"&&!b.listeners.wheel){b.listeners.wheel=function(a){CT.gesture.onWheel(a,b);};b.addEventListener("wheel",b.listeners.wheel);}b.gvars.stopPropagation=d;b.gvars.preventDefault=e;if(!CT.gesture.handlers[a][b.gid])CT.gesture.handlers[a][b.gid]=[];CT.gesture.handlers[a][b.gid].push(c);},unlisten:function(a){if(a.gid){var b=a.listeners;for(var c in CT.gesture.events)a.removeEventListener(CT.gesture.events[c],b[c]);if(a.gvars.iosPinch)for(var c in CT.gesture.gevents)a.removeEventListener(CT.gesture.gevents[c],b[c]);if(b.wheel)a.removeEventListener("wheel",b.wheel);for(var d in CT.gesture.handlers)if(a.gid in CT.gesture.handlers[d])delete CT.gesture.handlers[d][a.gid];delete a.gid;}},triggerPinch:function(a,b,c){var d=CT.gesture.handlers.pinch[a.gid];if(d)for(var e=0;e<d.length;e++)d[e](b,c);},triggerSwipe:function(a,b,c,d,e,f){var g=CT.gesture.handlers.swipe[a.gid];hasSwiped=true;if(g)for(var h=0;h<g.length;h++)g[h](b,c,d,e,f);},triggerTap:function(a){var b=a.gvars;var c=CT.gesture.handlers.tap[a.gid];if(c)for(var d=0;d<c.length;d++)c[d](b.tapCount);b.tapCount=0;b.tapTimeout=null;},triggerDrag:function(a,b,c,d,e,f){var g=false;var h=CT.gesture.handlers.drag[a.gid];if(h)for(var i=0;i<h.length;i++)g=h[i](b,c,d,e,f)||g;return g;},triggerHover:function(a,b){var c=false;var d=CT.gesture.handlers.hover[a.gid];if(d)for(var e=0;e<d.length;e++)c=d[e](b)||c;return c;},triggerWheel:function(a,b,c){var d=CT.gesture.handlers.wheel[a.gid];if(d)for(var e=0;e<d.length;e++)d[e](b,c);},triggerHold:function(a,b){var c=CT.gesture.handlers.hold[a.gid];if(c)for(var d=0;d<c.length;d++)c[d](b);},triggerUp:function(a,b){var c=false;var d=CT.gesture.handlers.up[a.gid];if(d)for(var e=0;e<d.length;e++)c=d[e](b)||c;return c;},triggerDown:function(a,b){var c=false;var d=CT.gesture.handlers.down[a.gid];if(d)for(var e=0;e<d.length;e++)c=d[e](b)||c;return c;}};CT.gesture.tuneThresholds();;window.CT.hover=window.CT.hover||{};CT.hover={_:{},_pos:function(a){return [a.offsetLeft,a.offsetTop];},_hide:function(){var a=CT.hover._;setTimeout(function(){!a.nodeOn&&!a.hoverOn&&CT.dom.hide(a.infoBubble);},1000);},set:function(a,b,c,d){if(arguments.length==1&&!(a instanceof Node)){var e=arguments[0];a=e.node;b=e.content;c=e.poptop;d=e.stayopen;}var f=CT.hover._;if(!f.infoBubble){f.infoBubble=CT.dom.div("","small hidden infobubble");CT.dom.getAllNode(true).appendChild(f.infoBubble);f.bubbleBounds={'left':0,'top':0};}a.onmouseover=function(d){f.nodeOn=true;var e=CT.hover._pos(a);CT.dom.ALLNODE.appendChild(f.infoBubble);CT.dom.setContent(f.infoBubble,b);CT.dom.show(f.infoBubble);var g=c?-(f.infoBubble.clientHeight+10):((a.clientHeight||a.offsetHeight)+10);f.bubbleBounds.right=CT.dom.ALLNODE.clientWidth-f.infoBubble.clientWidth;f.bubbleBounds.bottom=CT.dom.ALLNODE.clientHeight-f.infoBubble.clientHeight;f.infoBubble.style.left=Math.min(f.bubbleBounds.right-10,Math.max(10,e[0]-(f.infoBubble.clientWidth-(a.clientWidth||a.offsetWidth))/2))+"px";f.infoBubble.style.top=(e[1]+g)+"px";};a.onmouseout=function(){f.nodeOn=false;CT.hover._hide();};if(d){b.onmouseover=function(a){f.hoverOn=true;};b.onmouseout=function(a){f.hoverOn=false;CT.hover._hide();};}return a;}};;window.CT.key=window.CT.key||{};CT.key={_codes:[null,null,null,null,null,null,null,null,"BACKSPACE","TAB",null,null,null,"ENTER",null,null,"SHIFT","CTRL","ALT",null,"CAPS",null,null,null,null,null,null,"ESCAPE",null,null,null,null,"SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN",null,"PRINT",null,null,"INSERT","DELETE",null,"0","1","2","3","4","5","6","7","8","9",null,null,null,null,null,null,null,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","META_LEFT","META_RIGHT","SELECT",null,null,"NUMPAD_0","NUMPAD_1","NUMPAD_2","NUMPAD_3","NUMPAD_4","NUMPAD_5","NUMPAD_6","NUMPAD_7","NUMPAD_8","NUMPAD_9","MULTIPLY","ADD",null,"SUBTRACT","DECIMAL_POINT","DIVIDE","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"NUM_LOCK","SCROLL_LOCK",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"SEMICOLON","EQUALS","COMMA","DASH","PERIOD","FORWARD_SLASH","GRAVE_ACCENT",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"OPEN_BRACKET","BACK_SLASH","CLOSE_BRACKET","QUOTE"],_cbs:{},_downs:[],_init:function(){if(!CT.key._initialized){CT.key._initialized=true;window.onkeyup=CT.key._onUp;window.onkeydown=CT.key._onDown;}},_onDown:function(a){a=a||window.event;var b=a.keyCode||a.which,c=CT.key._codes[b];CT.data.append(CT.key._downs,c);},_onUp:function(a){a=a||window.event;var b=a.keyCode||a.which,c=CT.key._codes[b];CT.data.remove(CT.key._downs,c);CT.key._cbs[c]&&CT.key._cbs[c]();},down:function(a){CT.key._init();return CT.key._downs.indexOf(a)!=-1;},on:function(a,b){CT.key._init();CT.key._cbs[a]=b;}};;window.CT.layout=window.CT.layout||{};CT.layout={header:function(a){a=CT.merge(a,{logo:"Placeholder Logo",right:[],rightPadding:"30px",centerLogo:true});var b=[];if(a.img)b.push(CT.dom.panImg(a));if(a.right instanceof Node||a.right.length)if(a.centerLogo)b.push(CT.dom.node(a.right,"div","right padded"));else b.push(CT.dom.node(CT.dom.node(a.right,"div","right h1",null,null,{padding:a.rightPadding}),"div","abs top0 bottom0 right0 w1-2"));if(a.centerLogo)b.push(CT.dom.node(CT.dom.link(a.logo,null,"/"),"center","biggerester"));else b.push(CT.dom.link(a.logo,null,"/","w1-2 biggest bold block nodecoration abs top0 bottom0 left0"));if(a.marquee){var c=a.marquee;b.push(CT.dom.marquee(c.content,c.className||"abs ctl mosthigh",c.direction,c.noresize));}CT.dom.setContent(CT.dom.id("ctheader"),CT.dom.node(b,"div","h1 w1"));},footer:function(a){a=CT.merge(a,{logoClass:"left nodecoration",linksClass:"right p20",bottomClass:"small bline centered",logo:"Placeholder Logo",links:[],contact:{}});var b=[],c=[];if(a.img)c.push(CT.dom.panImg(a));c.push(CT.dom.link(a.logo,null,"/",a.logoClass));if(a.links.length)b.push(a.links.map(function(a){return CT.dom.link(a.content,a.cb,a.href,a.className||"padded");}));if(a.contact.email||a.contact.phone){var d=[];if(a.contact.email)d.push(CT.dom.node(a.contact.email,"div","padded inline-block"));if(a.contact.phone)d.push(CT.dom.node(a.contact.phone,"div","padded inline-block"));b.push(d);}if(b.length)c.push(CT.dom.node(b,"div",a.linksClass));if(a.bottom)c.push(CT.dom.node(a.bottom,"div",a.bottomClass));if(a.extra)c.push(a.extra);document.body.classList.add("footered");document.body.appendChild(CT.dom.node(c,"div",null,"ctfooter"));},grid:function(a,b,c,d){var e="w1-"+(b||3)+" h1-"+(c||4)+" noflow inline-block hoverglow pointer",f=function(a){var b={backgroundImage:"url("+a.img+")",backgroundPosition:"center",backgroundSize:"cover"};if(d)b.height=d+"px";return CT.dom.div(CT.dom.div(a.label,"biggest centered p20p overlay",a.id,null,{paddingTop:"20%"}),e,null,{onclick:a.onclick||function(){location=a.link;}},b);},g=CT.dom.div(a.map(f),"full");g.addCell=function(a){g.appendChild(f(a));};return g;},profile:function(a){a=CT.merge(a,{className:"w2-3 h1 noflow abs",buttons:[]});var b=CT.dom.panImg(a),c=CT.dom.node(null,"div","centered");for(var d in a.buttons)c.appendChild(CT.dom.button(d,a.buttons[d],"round padded margined"));if(!a.name&&a.firstName&&a.lastName)a.name=a.firstName+" "+a.lastName;return [CT.dom.node([CT.dom.node(a.name,"div","biggest"),CT.dom.node(a.description||a.blurb),c],"div","right w1-3 ctprofile"),b];},listView:function(a){a=CT.merge(a,{content:null,listNode:null,listContent:null,activeClass:null,fallback:null,hashcheck:null,parent:"ctmain",listClass:"ctlist big",contentClass:"ctcontent",titleClass:"biggerest bold bottompadded"});var b=CT.dom.div(null,a.contentClass),c=CT.dom.div(null,a.listClass),d=function(c){CT.dom.setContent(b,a.content?a.content(c):[CT.dom.div(c.name,a.titleClass),c.content]);},e=CT.panel.triggerList(a.data,d,a.listNode,a.activeClass,a.listContent);c.appendChild(e);CT.dom.setContent(a.parent,[b,c]);var f,g=CT.dom.id("tl"+location.hash.slice(1));if(g)g.trigger();else{if(a.hashcheck)f=a.hashcheck();if(f)CT.dom.setContent(b,f);else{var h=CT.dom.className("tlitem");if(h.length)h[0].trigger();else if(a.fallback)CT.dom.setContent(b,a.fallback());}}return e;}};;window.CT.memcache=window.CT.memcache||{};CT.memcache={_local:{},_rq:function(a,b,c,d,e,f){e=CT.merge(e,{action:a,key:c});if(d){if(e.mode=="blob")return CT.net.formUp(d,CT.merge(f,{cb:b,params:e,path:"/_memcache"}),"value");e.value=d;}CT.net.post(CT.merge(f,{cb:b,params:e,path:"/_memcache"}));},get:function(a,b,c){var d=c&&CT.memcache._local[a];if(d)b(d);else CT.memcache._rq("get",b,a);},set:function(a,b,c,d){if(d)CT.memcache._local[a]=b;CT.memcache._rq("set",c,a,b);},forget:function(a,b,c){if(c&&CT.memcache._local[a])delete CT.memcache._local[a];CT.memcache._rq("forget",b,a);}};CT.memcache.blob={get:function(a,b,c){CT.memcache._rq("get",function(a){b(new Blob([a],{type:c}));},a,null,{mode:"blob"},{basic:true});},set:function(a,b,c,d){var e={mode:"blob"};if(d)e.transcode=true;CT.memcache._rq("set",c,a,b,e);}};CT.memcache.countdown={get:function(a,b){CT.memcache._rq("get",b,a,null,{mode:"countdown"});},set:function(a,b,c,d){var e={mode:"countdown"};if(d)e.meta=d;CT.memcache._rq("set",c,a,b,e);},list:function(a){CT.memcache._rq("get",a,"_countdown_list",null,{mode:"countdown"});}};;window.CT.mobile=window.CT.mobile||{};CT.mobile={"options":{"true":["mobile","stretched"],"false":["normal","stretched"]},"fitNode":function(a,b,c,d){var e,f=CT.align.width()-10,g=a&&CT.align.offset(a);CT.dom.ALLNODE.mobileNode=a;if(CT.dom.ALLNODE._mode=="mobile")e="scale("+(f/a.clientWidth)+") translate(-"+g.left+"px,-"+g.top+"px)";else e="scale("+(f/CT.dom.ALLNODE.clientWidth)+")";CT.trans.setVenderPrefixed(CT.dom.ALLNODE,"transform-origin",c?c:(f<CT.dom.ALLNODE.clientWidth?"0% 0%":"50% 0%"));CT.trans.trans({node:CT.dom.ALLNODE,property:"transform",value:b&&b||e,duration:1000,prefix:true,cb:function(){a&&a.scrollIntoView(true,{"behavior":"smooth"});d&&d();}});},"fitAndSnap":function(a,b){if(CT.dom.ALLNODE.mobileNode)CT.dom.ALLNODE.mobileNode.scrollIntoView(true,{"behavior":"smooth"});CT.mobile.fitNode(a,null,null,b);},"mobileSnap":function(a){if(CT.dom.ALLNODE&&CT.dom.ALLNODE._mode=="mobile")CT.mobile.fitAndSnap(CT.dom.ALLNODE._mobileDefault,a);},"getMobileNode":function(a){if(a.id)return document.getElementById(a.id);else{var b=(CT.mobile.page&&CT.mobile.page[a.name])?CT.mobile.page[a.name]:a.firstClass;return document.getElementsByClassName(b)[0];}},"mobileMenuLink":function(a){return CT.dom.labeledImage("/img/icons/"+a.icon+".png",a.page&&(a.page+".html"),a.name||a.page,a.name||a.page,"centeredimg","round bordered padded","centered nowrap small",false,(a.id||a.firstClass)&&function(){CT.dom.ALLNODE.toggleMobileMenu();CT.mobile.fitAndSnap(CT.mobile.getMobileNode(a));});},"initMobileMenus":function(a,b,c){a.tops=CT.dom.node(null,null,"button_row top_out","top_buttons");a.bottoms=CT.dom.node(null,null,"button_row bottom_out","bottom_buttons");var d=CT.dom.field("mobile_search");a.tops.appendChild(CT.dom.node(CT.dom.node([CT.dom.node("CAN Smart Search"),d],"div","round bordered padded","mobile_search_node"),"label",null,null,{"for":"mobile_search","htmlFor":"mobile_search"}));(CT.mobile.page&&CT.mobile.page.top||CT.mobile.menus.top).forEach(function(b){a.tops.appendChild(CT.mobile.mobileMenuLink(b));});CT.mobile.menus.bottom.forEach(function(b){a.bottoms.appendChild(CT.mobile.mobileMenuLink(b));});a.bottoms.appendChild(CT.mobile.mobileMenuLink(CT.mobile.menus.alternatives[b?"participate":"login"]));CT.dom.inputEnterCallback(d,c);CT.dom.blurField(d);document.body.appendChild(a.tops);document.body.appendChild(a.bottoms);},"_mset":function(){var a=CT.dom.ALLNODE;return CT.mobile.options[(!!(a._mobile&&a._mobileDefault)).toString()];},"isMobile":function(){return CT.dom.ALLNODE._mobile;},"initResizer":function(a,b,c,d,e){CT.mobile.menus=c;CT.mobile.page=d;var f,g,h,i=CT.dom.ALLNODE,j=function(){return CT.mobile._mset()[i._mindex];};var k=function(){var a=function(a){var b=i.mobileNode||i;if(b.getBoundingClientRect().bottom<CT.align.height())b.scrollIntoView(false,{"behavior":"smooth"});};window.onscroll=function(b){setTimeout(a,500);setTimeout(a,1000);setTimeout(a,2000);setTimeout(a,3000);};var b;window.addEventListener('touchstart',function(a){b=true;});window.addEventListener('touchmove',function(a){if(b){a.preventDefault();b=false;}else window.onscroll&&window.onscroll();});};i._mobileDefault=i.mobileNode=CT.mobile.getMobileNode((d&&d.top||c.top)[1]);i._mode=j();i._mindex=0;i._otherMode=function(){return CT.mobile._mset()[(i._mindex+1)%2];};i._swapMode=function(){i._mindex=i._mindex?0:1;setTimeout(function(){var a=document.getElementsByTagName("meta");for(var b=0;b<a.length;b++)if(a[b].name=="viewport"){a[b].content="width=device-width, initial-scale=1.0"+((i._mode=="mobile")?", min-scale=1.0, max-scale=1.0, user-scalable=no":"");break;}},200);i.resize();};i.toggleMobileMenu=function(){if(h._on){h.tops.className="button_row top_out";h.bottoms.className="button_row bottom_out";}else{h.tops.className="button_row";h.bottoms.className="button_row";}h._on=!h._on;};f=b[i._otherMode()];g=CT.dom.img(f.img,null,i._swapMode,null,null,f.alt,"resize_btn","round bordered padded");h=CT.dom.img("/img/mobile-menu.png",null,i.toggleMobileMenu,null,null,"Mobile Menu","mobile_menu_btn","round bordered padded");i.resize=function(){i._mobile=CT.info.mobile||CT.align.width()<=720;i._mode=j();if(i._mode=="normal")CT.mobile.fitNode(null,"scale(1)","50% 0%");else if(i._mode=="stretched")CT.mobile.fitAndSnap(i);else CT.mobile.fitAndSnap(i._mobileDefault);if(i._mode=="mobile"){h.style.display="block";i.chatBlock&&i.chatBlock();}else{h.style.display="none";if(h._on)h.onclick();}var a=i._otherMode();g.title=g.alt=b[a].alt;g.firstChild.firstChild.src=b[a].img;};document.body.appendChild(g);document.body.appendChild(h);CT.mobile.initMobileMenus(h,a,e);i.resize();k();}};;window.CT.modal=window.CT.modal||{};CT.modal._defaults={Modal:{className:"basicpopup",innerClass:"h1 w1 scroller",transition:"none",center:true,noClose:false,slide:{origin:"top"}},LightBox:{className:"backdrop",transition:"fade",caption:"",noClose:true},Prompt:{style:"string",prompt:"",clear:false,data:[]}};CT.modal.Modal=CT.Class({CLASSNAME:"CT.modal.Modal",visible:false,setup:{_centerv:function(a){var b=a.clientHeight||CT.align.height();b-=this.node.clientHeight;return b/2;},_centerh:function(a){var b=a.clientWidth||CT.align.width();b-=this.node.clientWidth;return b/2;},_fallbacks:function(a){var b=this.node;if(!b.style.top&&!b.style.bottom)b.style.top=this.setup._centerv(a)+"px";if(!b.style.left&&!b.style.right)b.style.left=this.setup._centerh(a)+"px";},_add:function(a,b){var c=this.node;a=(a instanceof Node)?a:document.body;CT.dom.addContent(a,c);this.opts.center&&!b&&this.setup._fallbacks(a);},none:function(){var a=this.node;a.show=this.setup._add;a.hide=function(){CT.dom.remove(a);};},fade:function(){var a=this.node,b=this.setup._add;a.show=function(c){a.style.opacity=0;b(c);setTimeout(function(){CT.trans.trans({node:a,property:"opacity",value:1});},100);};a.hide=function(){CT.trans.trans({node:a,property:"opacity",value:0,cb:function(){CT.dom.remove(a);}});};},slide:function(){var a=this.node,b=this.setup._add,c=this.opts.slide.origin,d=this.opts.center,e=this.setup._centerv,f=this.setup._centerh,g=this.setup._fallbacks,h=false,i=false;var j=function(b){b=(b instanceof Node)?b:document.body;["top","bottom"].forEach(function(f,g){if(c.startsWith(f)){a.style[f]=-a.clientHeight+"px";a._vout={node:a,property:f,value:a.style[f]};a._vin={node:a,property:f,value:(d?e(b):0)+"px"};h=true;}});["left","right"].forEach(function(e,g){if(c.endsWith(e)){a.style[e]=-a.clientWidth+"px";a._hout={node:a,property:e,value:a.style[e]};a._hin={node:a,property:e,value:(d?f(b):0)+"px"};i=true;}});g(b);};a.show=function(c){b(c,true);j(c);setTimeout(function(){h&&CT.trans.trans(a._vin);i&&CT.trans.trans(a._hin);},100);};a.hide=function(){h&&CT.trans.trans(a._vout);i&&CT.trans.trans(a._hout);CT.trans.trans({cb:function(){CT.dom.remove(a);}});};}},on:{show:function(){},hide:function(){}},hide:function(){this.node.hide();this.visible=false;this.on.hide();},_show:function(a){this.node.show(a);this.visible=true;this.on.show();},show:function(a,b){setTimeout(this._show,0,a);b&&setTimeout(b,200);},showHide:function(a){this.visible?this.hide():this.show(a);},addClose:function(){this.node.insertBefore(CT.dom.div(CT.dom.link("X",this.hide),"abs ctr above"),this.node.firstChild);},build:function(){},clear:function(){this.node.lastChild.innerHTML="";},isClear:function(){return !this.node.lastChild.childElementCount;},add:function(a){CT.dom.addContent(this.node.lastChild,a);},set:function(a){this.clear();this.add(a);},_buildContent:function(){var a=this.opts,b={};["top","bottom","right","left"].forEach(function(c){if(c in a.slide)b[c]=a.slide[c];});this.node=CT.dom.node(CT.dom.node(null,null,a.innerClass),"div",a.className,null,null,b);if(!a.noClose)this.addClose();this.node.modal=this;this.setup[a.transition]();this.build();if(a.content||a.node)this.add(a.content||a.node);},init:function(a){this.opts=CT.merge(a,CT.modal._defaults.Modal);setTimeout(this._buildContent);}});CT.modal.LightBox=CT.Class({init:function(a){this.opts=CT.merge(a,CT.modal._defaults.LightBox,CT.modal._defaults.Modal,{content:CT.dom.div(CT.dom.div(this.opts.caption,"biggest bold padded round translucent full-center white grayback pointer hoverglow"),"backdrop-img filler","",{onclick:this.hide},{backgroundImage:"url("+this.opts.img+")"})});}},CT.modal.Modal);CT.modal.Prompt=CT.Class({CLASSNAME:"CT.modal.Prompt",_input:{string:function(){if(this.opts.autocomplete)return CT.autocomplete.DBGuesser({rows:true,input:CT.dom.field(),tapCb:this.submitAC,property:this.opts.autocomplete.property,modelName:this.opts.autocomplete.modelName}).input;else return CT.dom.smartField({cb:this.submit,isTA:this.opts.isTA,blurs:this.opts.blurs,classname:this.opts.inputClass});},"multiple-string":function(){var a=CT.dom.fieldList();this.node.appendChild(a.empty);this.node.appendChild(a.addButton);return a;},password:function(){return CT.dom.smartField(this.submit,null,null,null,"password");},"single-choice":function(a){return CT.dom.choices(this._nodify(a));},"multiple-choice":function(a){return CT.dom.choices(this._nodify(a),true);},"file":function(){this.continueButton.disabled=true;return CT.file.getter(function(a){if(a.opts.path)this.continueButton.disabled=false;}.bind(this));}},on:{show:function(){this.input&&!this.opts.blurs&&this.input.focus();if(this.opts.clear)this.input.value="";},hide:function(){}},submitAC:function(a){this.opts.cb(a);this.hide();},submit:function(){this.opts.cb(this.input&&(this.input.ctfile||((typeof this.input.value=="function")&&this.input.value())||this.opts.data[this.input.value]||this.input.value));this.hide();},_nodify:function(a){if(typeof a[0]=="string")return a.map(function(a){return CT.dom.node(a);});return a;},build:function(){this.continueButton=CT.dom.button("Continue",this.submit);this.node.appendChild(CT.dom.node(this.opts.prompt));if(this.opts.style!="confirm"){this.input=this._input[this.opts.style](this.opts.data);this.node.appendChild(this.input);}this.node.appendChild(this.continueButton);this.node.appendChild(CT.dom.button("Cancel",this.hide));},init:function(a){this.opts=CT.merge(this.opts,a,CT.modal._defaults.Prompt,CT.modal._defaults.Modal);}},CT.modal.Modal);;window.CT.panel=window.CT.panel||{};CT.panel={"view1":{},"lastClicked":{},"accordion":function(a,b,c,d,e,f,g,h,i){var j=CT.dom.node(null,null,"tabbed","ac"+a.name);j.add=function(a,f,k){var l,m,n=CT.panel.trigger(a,b,c,d,e,g,h,i);if(f)j.insertBefore(n,j.firstChild);else if(k){for(l=0;l<j.childNodes.length;l++)if(j.childNodes[l].data.name>n.data.name){j.insertBefore(n,j.childNodes[l]);m=true;break;}if(!m)j.appendChild(n);}else j.appendChild(n);return n;};j._drops=[];j.expand=function(){j._drops.forEach(function(a){a.expand();});};j.retract=function(){j._drops.forEach(function(a){a.retract();});};a.forEach(function(a){if(a.children){var k=CT.dom.node(">","div","inline-block"+(f&&" hidden"||"")),l=CT.dom.node(),m=[k,CT.dom.link(d?d(a):a.name,null,null,"inline-block pointer acheader")];if(h)m.unshift(CT.dom.node(h(a),"div","right rpaddedsmall"));CT.dom.setContent(l,m);l.content=CT.panel.accordion(a.children,b,c,d,e,f,g,h,i);j.appendChild(l);j._drops.push(new CT.Drop({anchor:l,parent:j,relative:true,constrained:false,setNodeClick:false,content:l.content,onShow:function(){CT.trans.rotate(k,{duration:100,degrees:90});},onHide:function(){CT.trans.rotate(k,{duration:100,degrees:0});}}));}else j.add(a);});return j;},"trigger":function(a,b,c,d,e,f,g,h){var i=a.label||a.title||a.name||a.topic||a,j=a.key||i,k=CT.dom.node(null,"div","tlitem",j&&("tl"+j.replace(/ /g,"")));c=c||"activetab";k.data=a;a.node=k;k.select=function(){!h&&CT.dom.each(k.parentNode,function(a){if(a==k)a.classList.add(c);else a.classList.remove(c);a.className=(a==k)?c:"";});};k.trigger=function(){if(e&&!e())return;k.select();b(a);};k.remove=function(){CT.dom.remove(k);k.onRemove&&k.onRemove();};k.nameNode=CT.dom.link(d?d(a):i,k.trigger);k.rename=function(b){a.label=b;k.id="tl"+b.replace(/ /g,"");CT.dom.setContent(k.nameNode,b);};if(g)k.appendChild(CT.dom.node(g(a),"div","right rpaddedsmall"));if(f)k.appendChild(CT.dom.link("X",k.remove,null,"right"));k.appendChild(k.nameNode);return k;},"triggerList":function(a,b,c,d,e,f,g,h,i){c=c||CT.dom.node();c.postAdd=function(a,j){var k=CT.panel.trigger(a,b,d,e,f,g,h,i);c.appendChild(k);(j===true)&&k.trigger();};c.preAdd=function(a,j){var k=CT.panel.trigger(a,b,d,e,f,g,h,i);if(c.childNodes.length)c.insertBefore(k,c.firstChild);else c.appendChild(k);j&&k.trigger();};a.forEach(c.postAdd);return c;},"slider":function(a,b,c,d){var e=CT.dom.div(null,"abs w1 hmin1 t0 l0 r0");if(typeof b=="string")b=CT.dom.id(b);if(typeof c=="string")c=CT.dom.id(c);(c||document.body).appendChild(e);e._subs=[];e.slide=function(a){CT.trans.translate(e,{y:-e.clientHeight*e._subs.indexOf(a)});};e.add=function(a,c){var f=CT.dom.div(null,"abs full l0 r0"),g=CT.panel.trigger(a,e.slide,null,null,null,null,d);f.style.top=(e.clientHeight*e._subs.length)+"px";if(d)g.appendChild(CT.dom.div(null,"clearnode"));e._subs.push(a);e.appendChild(f);b.appendChild(g);(c===true)&&g.trigger();return f;};a.forEach(e.add);return e;},"swap":function(a,b,c,d){c=c||"sb";a=a.replace(/ /g,"");var e=CT.dom.className(c+"panel");for(var f=0;f<e.length;f++)e[f].className=c+"panel hidden";CT.dom.id(c+"panel"+a,true).className=c+"panel";if(b){var g=CT.dom.id(c+"panel"+a+"Side");if(g)g.className=c+"panel";var h=CT.dom.id(c+"panel"+a+"Side2");if(h)h.className=c+"panel";}if(!d)CT.panel.select(a,c);var i=c+a;if(CT.panel.view1[i]){CT.panel.view1[i](a);delete CT.panel.view1[i];}},"drill":function(a){for(var b in a)CT.panel.swap(a[b],false,b);},"select":function(a,b){b=b||"sb";var c=CT.dom.className(b+"item");for(var d=0;d<c.length;d++)c[d].className=c[d].className.replace(" activetab","");if(a){CT.dom.id(b+"item"+a,true).className+=" activetab";CT.panel.lastClicked[b]=a;}CT.mobile&&CT.mobile.mobileSnap();},"selectLister":function(a,b,c){if(b)CT.dom.id("ll"+b).className="pointer";var d=CT.dom.id("ll"+a);d.className="pointer activetab";if(c)d.firstChild.innerHTML=c;CT.mobile&&CT.mobile.mobileSnap();},"add":function(a,b,c,d,e,f,g,h,i,j){f=f||a.replace(/ /g,"");c=c||"sb";if(!CT.dom.id(c+"panel"+f)){var k=CT.dom.node("","div",c+"panel hidden",c+"panel"+f);k.appendChild(CT.dom.node(a,"div","bigger blue bold bottompadded"));k.appendChild(CT.dom.node("","div","",c+"content"+f));(e||CT.dom.id(c+"panels")).appendChild(k);}var l=CT.dom.id(c+"item"+f);if(l)l.style.display="block";else{d=d||CT.dom.id(c+"items");var m=function(){if(i&&!i())return;CT.panel.swap(f,b,c);h&&h();};if(g)d.appendChild(CT.dom.node(CT.dom.img(g,null,m),"div","lfloat shiftleft"));d.appendChild(CT.dom.node(CT.dom.link(a,m),"div",c+"item pointer",c+"item"+f));if(g)d.appendChild(CT.dom.node("","div","clearnode"));}if(j)CT.panel.view1[c+a]=j;},"rename":function(a,b,c,d){c=c||"sb";var e=a.replace(/ /g,""),f=b.replace(/ /g,""),g=CT.dom.id(c+"item"+e),h=CT.dom.id(c+"panel"+e),i=CT.dom.id(c+"content"+e);g.id=c+"item"+f;h.id=c+"panel"+f;if(i)i.id=c+"content"+f;g.firstChild.innerHTML=h.firstChild.innerHTML=b;var j=d&&CT.dom.id(d+"item"+e);if(j){j.id=f;j.firstChild.innerHTML=b;}},"remove":function(a,b){var c=a.replace(/ /g,"");var d=CT.dom.id(b+"panel"+c);if(d)d.style.display="none";var e=CT.dom.id(b+"item"+c);if(e)e.style.display="none";},"load":function(a,b,c,d,e,f,g,h,i,j,k,l){c=c||"sb";if(!h)(d||CT.dom.id(c+"items")).innerHTML="";for(var m=0;m<a.length;m++)CT.panel.add(a[m],b,c,d,e,f&&f[m]||null,g&&g[m]||null,j&&j[m]||null,k,l);if(a.length&&(i||(!d&&!h)))CT.panel.swap(a[0],b,c);},"simple":function(a,b,c,d,e,f,g,h,i,j,k,l){if(arguments.length==1&&typeof arguments[0]!="string"){var m=arguments[0];a=m.pnames;b=m.keystring;c=m.itemnode;d=m.panelnode;e=m.cbs;f=m.condition;g=m.trysidepanel;h=m.nospaces;i=m.icons;j=m.noclear;k=m.stillswap;l=m.view1;}CT.panel.load(a,g,b,c,d,h,i,j,k!=false,e,f,l);},"pager":function(a,b,c,d,e,f){var g=f||("p"+CT.Pager._id),h=CT.dom.node(null,null,e,g+"panels"),i=CT.dom.node(),j=new CT.Pager(function(b){var c=b.map(function(a){return a.label;});CT.panel.simple(c,g,i,h);b.forEach(function(b){CT.dom.setContent(CT.dom.id(g+"content"+b.label.replace(/ /g,""),true),a(b));});return i;},b,c,d,g+"items"),k=CT.dom.node([j.node,h]);k.pager=j;return k;},"alternatebg":function(a,b,c){a=a||document.getElementById("sbitems");if(b){var d=1;for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(f.className.indexOf("lfloat")==-1&&f.className.indexOf("clearnode")==-1){if(c&&f.nodeName=="BR"){d=1;continue;}if(d==1)f.style.background="#899fb0";d*=-1;}}}else for(var e=0;e<a.childNodes.length;e+=2)a.childNodes[e].style.background="#899fb0";}};;window.CT.parse=window.CT.parse||{};CT.parse={"_linkProcessor":null,"_NUMS":'0123456789',"imgTypes":[".gif",".GIF",".png",".PNG",".jpg",".JPG","jpeg","JPEG"],"setLinkProcessor":function(a){CT.parse._linkProcessor=a;},"breakurl":function(a){return a.replace(/&/g,"&&#8203;").replace(/\//g,"/&#8203;").replace(/_/g,"_&#8203;");},"url2link":function(a,b){var c=a;if(c.slice(0,7)=="http://")a=a.slice(7);else if(c.slice(0,8)=="https://")a=a.slice(8);else c="http://"+c;return '<a target="_blank" href='+c+'>'+(b||CT.parse.breakurl(a))+"</a>";},"processLink":function(a,b){var c=a.slice(-4);if(CT.parse.imgTypes.indexOf(c)!=-1)return '<img src='+a+'>';return CT.parse._linkProcessor&&CT.parse._linkProcessor(a,b)||CT.parse.url2link(a);},"validEmail":function(a){var b=a.indexOf('@',1);var c=a.indexOf('.',b);if(b==-1||c==-1||c==a.length-1||b+2>c)return false;return true;},"validPassword":function(a){return a&&a.length>5;},"numOnly":function(a,b,c){a.onkeyup=function(){var d,e,f="",g=false;for(d=0;d<a.value.length;d++){e=a.value.charAt(d);if(b&&!g&&e==".")g=true;else if(!(!c&&!d&&e=="-")&&(CT.parse._NUMS.indexOf(e)==-1))continue;f+=e;}a.value=f;};return a;},"capitalize":function(a){return a.slice(0,1).toUpperCase()+a.slice(1);},"toCaps":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(CT.parse.capitalize(a[c]));return b;},"key2title":function(a){return CT.parse.toCaps(a.split("_")).join(" ");},"words2title":function(a){return CT.parse.toCaps(a.split(" ")).join(" ");},"keys2titles":function(a){var b=[];for(var c=0;c<a.length;c++)b.push(CT.parse.key2title(a[c]));return b;},"month2num":function(a){return CT.dom._monthnames.indexOf(a)+1;},"stripLast":function(a){var b="",c=a.charAt(a.length-1);while(['.',',',':',';',')',']'].indexOf(c)!=-1){a=a.slice(0,a.length-1);b=c+b;c=a.charAt(a.length-1);}return [b,a];},"stripToNums":function(a){a=a||"";var b='';for(var c=0;c<a.length;c++)if(CT.parse._NUMS.indexOf(a.charAt(c))!=-1)b+=a.charAt(c);return b;},"stripToZip":function(a){var b=CT.parse.stripToNums(a);if(b.length<5)return "";return b.slice(0,5);},"stripToPhone":function(a){var b=CT.parse.stripToNums(a);if(b.length<10)return "";return b.slice(0,10);},"formatPhone":function(a){var b=CT.parse.stripToPhone(a);return b.slice(0,3)+"-"+b.slice(3,6)+"-"+b.slice(6);},"formatPhoneLink":function(a){var b=CT.parse.formatPhone(a);return "<a href='tel:+1"+b+"'>"+b+"</a>";},"shortened":function(a,b){b=b||500;if(a.length<b)return a;return a.slice(0,b)+' ...';},"sanitize":function(a){var b="<scr"+"ipt";var c="</sc"+"ript>";var d=a.indexOf(b);while(d!=-1){var e=a.indexOf(c,d);if(e==-1)e=a.length;a=a.slice(0,d)+a.slice(e+9,a.length);d=a.indexOf(b);}return a.replace(/^\s+|\s+$/g,"");},"niceNum":function(a){if(a<999)return a;var b=a.toString(),c=b.length-3;while(c>0){b=b.slice(0,c)+","+b.slice(c);c-=3;}return b;},"_countdown":function(a){var b,c,d,e=[];b=~~(a/60);a-=b*60;c=~~(b/60);b-=c*60;d=~~(c/24);c-=d*24;if(d)e.push(d+" days");if(c)e.push(c+" hours");if(b)e.push(b+" minutes");if(a)e.push(~~a+" seconds");return e.join(", ");},"countdown":function(a){var b=CT.dom.span(CT.parse._countdown(a));setInterval(function(){a-=1;CT.dom.setContent(b,CT.parse._countdown(a));},1000);return b;},"date2string":function(a,b){a=a||new Date();var c=a.getMonth()+1,d=a.getDate();if(c<10)c='0'+c;if(d<10)d='0'+d;return a.getFullYear()+'-'+c+'-'+d+(b?' ':'T')+a.getHours()+':'+a.getMinutes()+':'+a.getSeconds()+(b?'':'Z');},"string2date":function(a){var b,c,d,e,f,g,h;[b,c,d]=a.split("-");e=d.slice(0,2);if(d.indexOf(":")!=-1){[f,g,h]=d.slice(3).split(":");h=parseInt(h);}return new Date(b,parseInt(c)-1,e,f,g,h);},"_stampString":function(a,b){if(!a)return false;return a+" "+b+(a==1?"":"s");},"_ts_server_offset":0,"set_ts_server_offset":function(a){CT.parse._ts_server_offset=a;},"timeStamp":function(a){var b=new Date();b.setHours(b.getHours()+(b.getTimezoneOffset()/60)-CT.parse._ts_server_offset);var c=new Date(a.replace('T',' ').replace(/-/g,'/')),d=(b-c)/1000,e=~~(d/60),f=~~(e/60),g=~~(f/24);return(CT.parse._stampString(g,"day")||CT.parse._stampString(f,"hour")||CT.parse._stampString(e,"min")||"moments")+" ago";},"process":function(a,b,c){if(!a)return "";var d=a.replace(new RegExp(String.fromCharCode(10),'g'),' ').replace(new RegExp(String.fromCharCode(13),'g'),' ').replace(/</g," <").replace(/>/g,"> ").replace(/&nbsp;/g," ").replace(/  /g,' ');var e=d.match(/\d{3}-\d{3}-\d{4}/g);if(e)e.forEach(function(a){var b=d.indexOf(a);var c=d.charAt(b-1);if(c!=">"&&c!=":"&&d.slice(b-2,b)!="+1")d=d.replace(a,CT.parse.formatPhoneLink(a));});var f=d.trim().split(" ");for(var g=0;g<f.length;g++){var h=f[g];if(h.indexOf(":")==-1&&CT.parse.validEmail(h)){f[g]="<a href='mailto:"+h+"'>"+h+"</a>";continue;}var i=h.indexOf("https://");if(i==-1)i=h.indexOf("http://");if(i!=-1&&h[i-1]!='"'){var j=h.slice(0,i);h=h.slice(i);var k="";var l=h.indexOf('<');if(l!=-1){k=h.slice(l);h=h.slice(0,l);}var m=CT.parse.stripLast(h),n=m[0],h=m[1];f[g]=j+(b?CT.parse.url2link:CT.parse.processLink)(h,c)+n+k;}}return f.join(" ").replace(/ <\//g,"</");}};;window.CT.pubsub=window.CT.pubsub||{};CT.pubsub={"_":{"ws":null,"args":null,"open":false,"initialized":false,"autohistory":false,"autohistory_exemptions":[],"reconnect":true,"reconnect_interval":250,"protocol":location.protocol=="http:"&&"ws"||"wss","log":CT.log.getLogger("CT.pubsub"),"queue":[],"channels":{},"cb":{"snapshot":CT.log.getLogger("CT.pubsub|snapshot"),"pm":CT.log.getLogger("CT.pubsub|pm"),"message":CT.log.getLogger("CT.pubsub|message"),"subscribe":CT.log.getLogger("CT.pubsub|subscribe"),"join":CT.log.getLogger("CT.pubsub|join"),"leave":CT.log.getLogger("CT.pubsub|leave"),"presence":CT.log.getLogger("CT.pubsub|presence"),"open":CT.log.getLogger("CT.pubsub|open"),"close":CT.log.getLogger("CT.pubsub|close"),"wserror":CT.log.getLogger("CT.pubsub|wserror"),"error":CT.log.getLogger("CT.pubsub|error")},"process":{"channel":function(a){var b=CT.pubsub._;b.channels[a.channel]=a;b.cb.subscribe(a);if(b.autohistory&&(b.autohistory_exemptions.indexOf(a.channel)==-1))a.history.forEach(CT.pubsub._.process.publish);CT.pubsub._.cb.presence(a.presence.length);},"publish":function(a){CT.pubsub._.cb.message(a);},"subscribe":function(a){CT.pubsub._.cb.join(a.channel,a.user);var b=CT.pubsub._.channels[a.channel];if(b){CT.data.append(b.presence,a.user);CT.pubsub._.cb.presence(b.presence.length);}},"unsubscribe":function(a){CT.pubsub._.cb.leave(a.channel,a.user);var b=CT.pubsub._.channels[a.channel];if(b){CT.data.remove(b.presence,a.user);CT.pubsub._.cb.presence(b.presence.length);}},"pm":function(a){CT.pubsub._.cb.pm(a.message,a.user);},"error":function(a){CT.pubsub._.cb.error(a.message);},"snapshot":function(a){CT.pubsub._.cb.snapshot(a);a.channels.forEach(function(a){var b=CT.pubsub._.channels[a.name]={channel:a.name,presence:a.users};CT.pubsub._.cb.subscribe(b);});}},"on":{"open":function(){CT.pubsub._.open=true;CT.pubsub._.reconnect_interval=250;CT.pubsub._.write({"action":"register","data":CT.pubsub._.args[2]});for(var a in CT.pubsub._.channels)CT.pubsub.subscribe(a);CT.pubsub._.queue.forEach(CT.pubsub._.write);CT.pubsub._.queue.length=0;CT.pubsub._.cb.open();},"close":function(){CT.pubsub._.open=false;CT.pubsub._.cb.close();if(CT.pubsub._.reconnect)CT.pubsub._.try_reconnect();},"error":function(){CT.pubsub._.cb.wserror();},"message":function(a){var b=JSON.parse(atob(a.data));CT.pubsub._.process[b.action](b.data);}},"write":function(a){if(CT.pubsub._.open){var b=JSON.stringify(a),c=btoa(b);CT.pubsub._.ws.send(c);}else CT.pubsub._.queue.push(a);},"try_reconnect":function(){var a=CT.pubsub._.reconnect_interval;CT.pubsub._.log("RECONNECT",a);setTimeout(function(){CT.pubsub.connect.apply(null,CT.pubsub._.args);},a);CT.pubsub._.reconnect_interval=Math.min(2*a,30000);}},"isInitialized":function(){return CT.pubsub._.initialized;},"set_protocol":function(a){CT.pubsub._.protocol=a;},"set_reconnect":function(a){CT.pubsub._.reconnect=a;},"set_autohistory":function(a,b,c){CT.pubsub._.autohistory=a;if(b)if(c)b.forEach(function(a){CT.pubsub._.autohistory_exemptions.push(a);});else CT.pubsub._.autohistory_exemptions=b;},"set_cb":function(a,b){CT.pubsub._.cb[a]=b;},"pm":function(a,b){CT.pubsub._.write({"action":"pm","data":{"user":a,"message":b}});},"publish":function(a,b){CT.pubsub._.write({"action":"publish","data":{"channel":a,"message":b}});},"subscribe":function(a){CT.pubsub._.write({"action":"subscribe","data":a});},"unsubscribe":function(a){CT.pubsub._.write({"action":"unsubscribe","data":a});},"connect":function(a,b,c,d){CT.pubsub._.args=arguments;CT.pubsub._.initialized=true;CT.pubsub._.ws=new WebSocket(CT.pubsub._.protocol+"://"+a+":"+b);for(var e in CT.pubsub._.on)CT.pubsub._.ws["on"+e]=CT.pubsub._.on[e];window.addEventListener("beforeunload",function(){d&&d();CT.pubsub._.write({"action":"close"});});}};;window.CT.recaptcha=window.CT.recaptcha||{};CT.recaptcha={"build":function(a,b,c,d,e){CT.require("CT.lib.recaptcha_ajax",true);try{Recaptcha.create(a,b);d&&setTimeout(function(){var a=document.getElementById(e||"recaptcha_response_field");a&&CT.dom.inputEnterCallback(a,d);},1000);}catch(f){c&&c(f)||alert(f);}},"submit":function(a,b,c,d){var e=Recaptcha.get_response();if(e.length<3)alert("don't forget to fill in the CAPTCHA! you are human, right?");else{d=d||{};d.cresponse=e;d.cchallenge=Recaptcha.get_challenge();CT.net.post(c||"/recaptcha",d,null,a,function(a){if(a.trim()=="incorrect-captcha-sol")a="That's not quite right! Please try again.";alert(a);Recaptcha.reload();});b&&b();}}};;window.CT.slider=window.CT.slider||{};CT.slider={other_dim:{height:"width",width:"height"},other_orientation:{vertical:"horizontal",horizontal:"vertical"},orientation2dim:{vertical:"height",horizontal:"width"},orientation2abs:{vertical:{forward:"up",backward:"down"},horizontal:{forward:"left",backward:"right"}}};CT.slider.Slider=CT.Class({CLASSNAME:"CT.slider.Slider",init:function(a){this.opts=a=CT.merge(a,{frames:[],keys:true,autoSlideInterval:5000,autoSlide:true,visible:true,navButtons:true,startFrame:null,circular:false,pan:true,noStyle:false,translucentTeaser:true,arrow:null,parent:document.body,frameCb:null,mode:"peekaboo",subMode:"peekaboo",orientation:"horizontal",arrowPosition:"middle",bubblePosition:"bottom"});if(typeof a.parent=="string")a.parent=CT.dom.id(a.parent);if(a.frameCb)a.mode='custom';this.jumpers={};this.dimension=CT.slider.orientation2dim[a.orientation];this.circlesContainer=CT.dom.node("","div","carousel-order-indicator "+a.bubblePosition);var b="slider-btn hoverglow pointer sb-"+this.opts.arrowPosition+" sb-"+a.orientation;if(!a.navButtons){b+=" hider";this.circlesContainer.classList.add("hider");}var c=function(b){if(a.arrow){var c=CT.dom.img(a.arrow);return b?c:CT.trans.invert(c);}return CT.dom.span(b?">":"<");};this.prevButton=CT.dom.div(CT.dom.div(c()),b+" prv hidden");this.nextButton=CT.dom.div(CT.dom.div(c(true)),b+" nxt"+(a.frames.length<2?" hidden":""));this.index=this.pos=0;this.container=CT.dom.div("","carousel-container full"+CT.slider.other_dim[this.dimension]);var d=[this.container,this.circlesContainer,this.prevButton,this.nextButton];if(a.img){var e=CT.dom.div(CT.dom.img(a.img,"abs"),"abs all0 noflow");if(a.pan)this.imgBackController=CT.trans.pan(e.firstChild,{duration:a.panDuration||a.autoSlideInterval},true);else CT.onload(function(){CT.dom.cover(e.firstChild);},e.firstChild);d.unshift(e);}this.node=CT.dom.div(d,"carousel fullwidth fullheight"+(a.visible?"":" hider")+(a.noStyle?" carousel-nostyle":""));this.opts.parent.appendChild(this.node);this.opts.frames.forEach(this.addFrame);CT.gesture.listen("tap",this.prevButton,this.prevButtonCallback);CT.gesture.listen("tap",this.nextButton,this.nextButtonCallback);if(a.keys){CT.key.on(a.orientation=="horizontal"?"LEFT":"UP",this.prevButtonCallback);CT.key.on(a.orientation=="horizontal"?"RIGHT":"DOWN",this.nextButtonCallback);}if(a.orientation=="vertical")CT.gesture.listen("wheel",this.container,this.onWheel);this.dragOpts={constraint:CT.slider.other_orientation[a.orientation],up:this.updatePosition,interval:"auto"};CT.drag.makeDraggable(this.container,this.dragOpts);if(a.autoSlideInterval&&a.autoSlide&&!a.startFrame)this.resume();CT.gesture.listen("down",this.container,this.pause);CT.onresize(this.trans,this.opts.parent);this._reflow();if(a.startFrame in this.jumpers)setTimeout(this.jumpers[a.startFrame]);},on:{hide:function(){this.imgBackController&&this.imgBackController.pause();this.container.childNodes[this.index].frame.on.hide();},show:function(){this.imgBackController&&this.imgBackController.resume();this.container.childNodes[this.index].frame.on.show();}},onWheel:function(a,b){if(b>0)this.nextButtonCallback();else this.prevButtonCallback();},showNav:function(){if(this.opts.navButtons){CT.trans.translate(this.prevButton,{x:0});CT.trans.translate(this.nextButton,{x:0});CT.trans.translate(this.circlesContainer,{y:0});}if(this.opts.parent.slider)this.opts.parent.slider.showNav();},hideNav:function(){if(this.opts.navButtons){CT.trans.translate(this.prevButton,{x:-200});CT.trans.translate(this.nextButton,{x:200});CT.trans.translate(this.circlesContainer,{y:(this.opts.bubblePosition=="top")&&-100||100});}if(this.opts.parent.slider)this.opts.parent.slider.hideNav();},show:function(){this.node.classList.remove("hider");this.on.show();},hide:function(){this.node.classList.add("hider");this.on.hide();},_reflow:function(){CT.dom.mod({targets:this.container.childNodes,property:this.dimension,value:(100/this.container.childNodes.length)+"%"});this.container.style[this.dimension]=(this.opts.frames.length*100)+"%";},resume:function(){if(!this._autoSlide)this._autoSlide=setInterval(this.autoSlideCallback,this.opts.autoSlideInterval);},pause:function(){if(this._autoSlide){clearInterval(this._autoSlide);this._autoSlide=null;}this.opts.parent.slider&&this.opts.parent.slider.pause();},addFrame:function(a,b){if(typeof a=="string")a={img:a};var c=CT.dom.node(a.label,"div","hoverglow pointer indicator-circle "+(a.label?"labeled":"unlabeled")+"-circle"),d=this.jumpers[a.label||b]=this.circleJump(b);CT.gesture.listen("tap",c,d);this.circlesContainer.appendChild(c);this.container.appendChild(new CT.slider.Frame(a,this).node);if(b==0){c.className+=" active-circle";this.activeCircle=c;if(!this.opts.parent.slider)setTimeout(this.container.firstChild.frame.on.show,500);}if(b==undefined)this._reflow();},circleJump:function(a){var b=function(){this.pause();this.updateIndicator(a);this.trans();}.bind(this);return b;},updateIndicator:function(a){this.container.childNodes[this.index].frame.on.hide();this.index=a;this.container.childNodes[this.index].frame.on.show();this.activeCircle.classList.remove('active-circle');this.activeCircle=this.circlesContainer.childNodes[a];this.activeCircle.classList.add('active-circle');CT.dom[this.activeCircle.nextSibling?"show":"hide"](this.nextButton);CT.dom[this.activeCircle.previousSibling?"show":"hide"](this.prevButton);},updatePosition:function(a,b){var c=this.index,d=CT.drag._.dir2abs[a],e=this.circlesContainer.childNodes.length;if(CT.drag._.direction2orientation[a]==this.opts.orientation){if(d=="forward"&&(b||this.activeCircle.nextSibling))c+=1;else if(d=="backward"&&(b||this.activeCircle.previousSibling))c-=1;if(e)this.updateIndicator((c+e)%e);}else if(this.opts.parent.slider)this.opts.parent.slider.shift(a,b);},trans:function(){var a={},b=CT.drag._.orientation2axis[this.opts.orientation];a[b]=this.container[b+"Drag"]=-this.index*CT.align[this.dimension](this.container)/this.container.childNodes.length;CT.trans.translate(this.container,a);},shift:function(a,b){this.updatePosition(a,b||this.opts.circular);this.trans();},autoSlideCallback:function(){this.shift(CT.slider.orientation2abs[this.opts.orientation].forward,true);},prevButtonCallback:function(){this.pause();this.shift(CT.slider.orientation2abs[this.opts.orientation].backward);},nextButtonCallback:function(){this.pause();this.shift(CT.slider.orientation2abs[this.opts.orientation].forward);}});CT.slider.Frame=CT.Class({CLASSNAME:"CT.slider.Frame",on:{show:function(){},hide:function(){}},peekaboo:function(){var a=this.opts,b=this.node,c=this.slider,d,e=CT.dom.node(a.content,"div","big carousel-content-full"),f=CT.dom.node(CT.dom.img(a.img||c.opts.defaultImg,"abs"),"div","w1 h1 noflow carousel-content-image"),g=[f,e];var h=function(){c.pause();b._retracted=!b._retracted;if(b._retracted){CT.trans.resize(f,{width:"40%",height:"30%",cb:function(){if(d)d.style.zIndex=200;}});CT.trans.trans({node:j,property:"left",value:"10px"});CT.trans.trans({node:j,property:"top",value:"0px"});c.hideNav();this.tab&&this.tab.hide();}else{if(d)d.style.zIndex=0;CT.trans.resize(f,{width:"100%",height:"100%"});CT.trans.trans({node:j,property:"left",value:"22.5%"});CT.trans.trans({node:j,property:"top",value:"100px"});c.showNav();this.tab&&this.tab.show(c.opts.parent);}};if(c.opts.pan)f.controller=CT.trans.pan(f.firstChild,{duration:a.panDuration||c.opts.panDuration||c.opts.autoSlideInterval});else CT.onload(function(){CT.dom.cover(f.firstChild);},f.firstChild);if(a.title||a.blurb){var i=CT.dom.div(a.blurb,"bigger"),j=CT.dom.div([CT.dom.div(a.title,"biggest"),i],"carousel-content-teaser transparent hoverglow pointer cc-teaser-"+(c.opts.translucentTeaser?"trans":"opaque"));CT.dom.fit(i);g.push(j);}if(a.pulse){d=CT.dom.img(a.pulse,"carousel-pulse pointer");d.controller=CT.trans.pulse(d);CT.gesture.listen("tap",d,h);g.push(d);}this.on.show=function(){if(a.title||a.blurb){CT.trans.fadeIn(j);i.style.maxHeight=(j.parentNode.clientHeight-200)+"px";i.fit();}if(c.opts.keys&&j)CT.key.on("ENTER",h);if(c.opts.pan)f.controller.resume();if(a.pulse)d.controller.resume();if(this.tab)this.tab.show(c.opts.parent);};this.on.hide=function(){if(a.title||a.blurb)CT.trans.fadeOut(j);if(b._retracted)h();if(c.opts.pan)f.controller.pause();if(a.pulse)d.controller.pause();if(this.tab)this.tab.hide();};CT.dom.addEach(b,g);if(a.content)CT.gesture.listen("tap",j,h);else if(a.onclick)CT.gesture.listen("tap",j,a.onclick);},chunk:function(){var a=new CT.slider.Slider({parent:this.node,frames:this.opts.frames,mode:this.opts.mode||this.slider.opts.subMode,autoSlide:false,img:this.opts.img,pan:this.slider.opts.pan,arrow:this.slider.opts.arrow,defaultImg:this.slider.opts.defaultImg,translucentTeaser:this.slider.opts.translucentTeaser,orientation:CT.slider.other_orientation[this.slider.opts.orientation],arrowPosition:"bottom"}),b=this.slider;this.on.hide=a.on.hide;this.on.show=function(){a.on.show();if(b.opts.keys){CT.key.on(a.opts.orientation=="horizontal"?"LEFT":"UP",a.prevButtonCallback);CT.key.on(a.opts.orientation=="horizontal"?"RIGHT":"DOWN",a.nextButtonCallback);}};},menu:function(){var a=new CT.modal.Modal({transition:"slide",noClose:true,className:"round centered basicpopup above",content:this.opts.buttons.map(function(a){var b=CT.dom.node([CT.dom.node(a.label||a.page,"div","biggest bold bottombordered"),CT.dom.node(a.content)],"div","margined padded bordered round hoverglow pointer inline-block");b.onclick=function(){location=a.url||("/"+a.page+".html");};return b;})});var b=function(a){var b=[];for(var c=0;c<5;c++)b.push(CT.dom.img(a||this.slider.opts.defaultImg));return b;};this.node.appendChild(CT.dom.marquee(b(this.opts.logo),"abs top0 h20p fullwidth"));this.node.appendChild(CT.dom.marquee(b(this.opts.logo),"abs bottom0 h20p fullwidth","right"));this.on.hide=a.hide;this.on.show=a.show;},profile:function(){var a=CT.merge(this.opts,this.slider.opts,{panDuration:this.slider.opts.autoSlideInterval,controllerHook:this.on});a.img=a.img||this.slider.opts.defaultImg;CT.dom.addContent(this.node,CT.layout.profile(a));},track:function(){var a=CT.dom.audio(this.opts.src,true,false,false,null,this.slider.autoSlideCallback),b=function(){a.playing=false;a.pause();},c=function(){a.playing=true;a.play();},d=function(){a.playing?b():c();};this.on.hide=b;this.on.show=function(){c();CT.key.on("SPACE",d);};CT.dom.addContent(this.node,CT.dom.div([CT.dom.div(this.opts.song,"gigantic"),CT.dom.div(this.opts.album,"biggerest"),a],"full-center outlined"));},custom:function(){CT.dom.addContent(this.node,this.slider.opts.frameCb(this.opts));},init:function(a,b){var c=a.mode||b.opts.mode;this.opts=a;this.node=CT.dom.div("","carousel-content-container full"+CT.slider.other_dim[b.dimension]+((c=="custom")?" scroller":""));this.node.frame=this;this.slider=this.node.slider=b;if(b.dimension=="width")this.node.style.display="inline-block";var d=a.tab||b.opts.tab;if(d){var e=this.tab=new CT.modal.Modal({content:d.content,center:false,noClose:true,className:"basicpopup abs rounder translucent above shiftall",transition:"slide",slide:{origin:d.origin}});this.on.show=function(){if(e.isClear())e.set(d.content);e.show(b.opts.parent);};this.on.hide=e.hide;}this[c]();}});;window.CT.stream=window.CT.stream||{};window.CT.stream.util=window.CT.stream.util||{};var _sutil=CT.stream.util={blob_to_b64:function(a,b){a?_sutil.read(a,b):b();},b64_to_blob:function(a,b){a?fetch(a.video||a).then(function(a){return a.blob();}).then(b):b();},blob_to_buffer:function(a,b){a?_sutil.read(a,b,true):b();},b64_to_buffer:function(a,b){_sutil.b64_to_blob(a,function(a){_sutil.blob_to_buffer(a,b);});},blobs_to_b64s:function(a,b){_sutil.blob_to_b64(a.video,function(c){_sutil.blob_to_b64(a.audio,function(a){b({video:c,audio:a});});});},b64s_to_blobs:function(a,b){_sutil.b64_to_blob(a.video,function(c){_sutil.b64_to_blob(a.audio,function(a){b({video:c,audio:a});});});},blobs_to_buffers:function(a,b){_sutil.blob_to_buffer(a.video,function(c){_sutil.blob_to_buffer(a.audio,function(a){b({video:c,audio:a});});});},b64s_to_buffers:function(a,b){_sutil.b64s_to_blobs(a,function(a){_sutil.blobs_to_buffers(a,b);});},read:function(a,b,c){var d="read"+(c?"buffer":"url"),e=new FileReader();CT.log.startTimer(d);e.onloadend=function(){CT.log.endTimer(d,e.result.length||e.result.byteLength);b(e.result);};c?e.readAsArrayBuffer(a):e.readAsDataURL(a);},_recorder:function(a,b){return function(c){var d=0,e=new MediaRecorder(c,CT.stream.opts.mropts);e.ondataavailable=function(b){CT.log("ondataavailable!! "+b.data.size);d=(d+1)%CT.stream.opts.segments;!e._stopped&&a&&a({video:b.data},d);};e.onerror=function(a){CT.log("error! "+a.message);};e.start(CT.stream.opts.chunk);b&&b(e,c);};},record:function(a,b,c){CT.log.startTimer("record","(attempt)");navigator.mediaDevices.getUserMedia({video:true,audio:true}).then(_sutil._recorder(a,b))["catch"](c||function(a){CT.log.endTimer("record","got error: "+a);});}};;window.CT.stream.Audio=window.CT.stream.Audio||{};CT.stream.Audio=CT.Class({CLASSNAME:"CT.stream.Audio",_buffers:[],_flip:function(){if(this.disabled)return;this.active=!this.active;this.video.video.muted=!this.active;this.button.firstChild.classList[this.active?"add":"remove"]("buttonActive");},push:function(a){this._buffers.push(a);},build:function(){this.node=CT.dom.audio({className:"hidden",onpause:this.play});document.body.appendChild(this.node);},remove:function(){CT.dom.remove(this.node);},disable:function(){this.active=false;this.disabled=true;this.video.video.muted=true;},play:function(){var a=this;this.node.play()["catch"](function(b){a.log("play error (but we don't carerror!)",b.msg);});},init:function(a,b){this.active=a;this.video=b;this.button=CT.dom.img("/img/audio.png","w80p"+(a&&" buttonActive"||""),this._flip);if(!a)b.video.muted=true;}});;window.CT.stream.Video=window.CT.stream.Video||{};CT.stream.Video=CT.Class({CLASSNAME:"CT.stream.Video",_buffers:[],_nextChunk:0,_sourceOpen:function(){this.log("sourceopen");this.setSourceBuffer();},_sourceUpdate:function(){this.log("_sourceUpdate",this._buffers.length,this.sourceBuffer.updating,this.mediaSource.readyState);if(this.video.error){this.log("ERROR - resetting video");this.reset();}else if(!this.sourceBuffer.updating)if(this._buffers.length)this.sourceBuffer.appendBuffer(this._buffers.shift());else if(this.mediaSource.readyState=="open")this.mediaSource.endOfStream();},_error:function(a){this.log("ERROR",a.message,a.target.error);},setSourceBuffer:function(){this.log("setSourceBuffer - exists:",!!this.sourceBuffer);if(!this.sourceBuffer){var a=CT.stream.opts;this.sourceBuffer=this.mediaSource.addSourceBuffer(a.codecs.av);this.sourceBuffer.mode='sequence';this.sourceBuffer.addEventListener("updateend",this._sourceUpdate);this.sourceBuffer.addEventListener("error",this._error);}},process:function(a){this.log("process",a.length);var b=this,c=this.video;CT.stream.util.b64_to_blob(a,function(a){b.recorder&&b.recorder.remember(a);CT.stream.util.blob_to_buffer(a,function(a){b._buffers.push(a);b._sourceUpdate();var d=c.duration-(CT.stream.opts.chunk/1000);if(!c.paused&&c.currentTime<d)c.currentTime=d;});});},start:function(){this.log("start (attempting) - paused:",this.video.paused);var a=this,b=this.video.play();b&&b.then(function(){a.log("started!!! streaming!");})["catch"](function(b){a.log("play failed! awaiting user input (android)",b.message);if(CT.stream.opts.requiresInput&&!CT.stream.opts.requestedInput){a.audio.node&&CT.stream.opts.waiting.push(a.audio.node);CT.stream.opts.requestedInput=true;new CT.modal.Prompt({cb:CT.stream.opts.startWaiting,transition:"fade",style:"single-choice",data:["Play Stream"],prompt:"Ready to stream?"}).show();}CT.stream.opts.waiting.push(a.video);});},_miniRecorder:function(){var a={blobs:[],remember:function(b){if(a.recording)a.blobs.push(b);},start:function(){a.recording=true;},stop:function(){a.recording=false;},_save:function(a){var b=new Date().toString().split("-")[0].replace(/\W/g,"")+".webm",c=CT.file.make(a);new CT.modal.Modal({content:[CT.dom.div("Your file is ready for download!","bigger pb10"),c.download(b,"click me!","bold centered block")]}).show();},save:function(){if(CT.stream.opts.transcoder)CT.stream.opts.transcoder(a._save)(new Blob(a.blobs));else a._save(a.blobs);a.blobs=[];}};return a;},save:function(){if(this.recorder){this._saveButton.firstChild.classList.remove("buttonActive");this.recorder.stop();this.recorder.save();clearTimeout(this._saveTimer);delete this._saveTimer;delete this.recorder;}else{this._saveButton.firstChild.classList.add("buttonActive");this.recorder=this._miniRecorder();this.recorder.start();this._saveTimer=setTimeout(this.save,CT.stream.opts.cutoff);}},remove:function(){this.video.src="";CT.dom.remove(this.node);this.audio.remove();},_wakeup:function(){if(this.video._lastct==this.video.currentTime)this.video.currentTime+=1;this.video._lastct=this.video.currentTime;},setVideo:function(){this.video=this.opts.video||CT.dom.video(this.opts.stream&&URL.createObjectURL(this.opts.stream),this.opts.videoClass,this.opts.videoId,this.opts.attrs);this.video.on("canplay",this.start);this.video.on("pause",this.start);this.video.on("error",this._error);},setMediaSource:function(){this.mediaSource=new MediaSource();this.video.src=URL.createObjectURL(this.mediaSource);this.mediaSource.addEventListener("sourceopen",this._sourceOpen);this.mediaSource.addEventListener("error",this._error);},fullscreen:function(){var a=this.video;if(a.requestFullscreen)a.requestFullscreen();else if(a.webkitRequestFullscreen)a.webkitRequestFullscreen();},reset:function(){var a=Date.now();if(this._lastReset){var b=a-this._lastReset;this.log("RESET",b);if(this.opts.onreset&&b<CT.stream.opts.reset)this.opts.onreset();}this._lastReset=a;this.video.removeEventListener("canplay",this.start);this.video.removeEventListener("pause",this.start);this.video.removeEventListener("error",this._error);this.setVideo();this.video.muted=!this.audio.active;this.node.insertBefore(this.video,this.node.video);CT.dom.remove(this.node.video);this.node.video=this.video;this.sourceBuffer.removeEventListener("updateend",this._sourceUpdate);this.sourceBuffer.removeEventListener("error",this._error);delete this.sourceBuffer;this.mediaSource.removeEventListener("sourceopen",this._sourceOpen);this.mediaSource.removeEventListener("error",this._error);this.setMediaSource();this._buffers.shift();this.requiredInitChunk=this.receivedInitChunk;},init:function(a){this.opts=a=CT.merge(a,{video:null,stream:null,className:null,id:null,frame:true,videoClass:null,videoId:null,watermark:null,activeAudio:false,onreset:null,buttons:[],record:{streamer:false,lurker:false,auto:false},fullscreen:{streamer:false,lurker:true},attrs:{autoplay:true}});if(a.stream)a.attrs.mozSrcObject=a.stream;this.setVideo();this.audio=new CT.stream.Audio(a.activeAudio,this);this._fullscreenButton=CT.dom.img("/img/fullscreen.png","defpointer hoverglow w80p",this.fullscreen);this._saveButton=CT.dom.img("/img/save.png","defpointer hoverglow w80p",this.save);this.node=a.frame?CT.dom.div([this.video,CT.dom.div([this.audio.button,CT.dom.pad(2),this._fullscreenButton,CT.dom.pad(2),this._saveButton],"centered")],a.className,a.id):CT.dom.div(this.video,a.className||"fulldef",a.id);this.node.video=this.video;var b=a.record[a.stream?"streamer":"lurker"],c=a.fullscreen[a.stream?"streamer":"lurker"];if(!a.frame){var d=CT.dom.div(null,"abs cbl");if(b)d.appendChild(this._saveButton);if(c){if(d.childNodes.length)d.appendChild(CT.dom.pad());d.appendChild(this._fullscreenButton);}a.buttons.forEach(function(a){if(d.childNodes.length)d.appendChild(CT.dom.pad());d.appendChild(a);});if(d.childNodes.length)this.node.appendChild(d);}b&&a.record.auto&&this.save();if(a.watermark)this.node.appendChild(CT.dom.img(a.watermark,"abs ctr w1-4 mosthigh nofilt"));if(a.stream)this.audio.disable();else{this.setMediaSource();this.audio.build();setInterval(this._wakeup,1000);}}});;window.CT.stream.Streamer=window.CT.stream.Streamer||{};CT.stream.Streamer=CT.Class({CLASSNAME:"CT.stream.Streamer",bounce:function(a,b){var c=this.opts.video;CT.stream.util.read(b,function(b){CT.memcache.set(a,b,function(){CT.memcache.get(a,c.process,true);},true);});},chunk:function(a,b){this.bounce(this.opts.channel+b,a);},echo:function(a,b){CT.stream.util.blobs_to_b64s(a,this.opts.video.process);},getNode:function(){return this.opts.video.node;},init:function(a){this.opts=CT.merge(a,{channel:"test",video:new CT.stream.Video()});}});;window.CT.stream.Multiplexer=window.CT.stream.Multiplexer||{};CT.stream.Multiplexer=CT.Class({CLASSNAME:"CT.stream.Multiplexer",initChunk:false,_push:function(a,b,c){CT.memcache.set(c,a,function(){CT.pubsub.publish(b,{action:"clip",data:c});});},_update:function(a,b,c){if(c&&!a.data.endsWith("init"))CT.memcache.get(c,function(c){b(c);CT.memcache.get(a.data,b);});else CT.memcache.get(a.data,b);},join:function(a){if(this.opts.singlechannel){var b=Object.keys(this.channels);if(b.length)this.leave(b[0]);this.channel=a;}if(!(a in this.channels)){CT.pubsub.subscribe(a);this.channels[a]={};}},leave:function(a){if(a in this.channels){CT.pubsub.unsubscribe(a);Object.values(this.channels[a]).forEach(function(a){a.remove();});delete this.channels[a];}},unsub:function(a,b){var c=this.channels[a];if(c&&c[b]){c[b].remove();delete c[b];if(!Object.keys(c).length&&this.opts.onstop)this.opts.onstop();}},stop:function(){for(var a in this.channels)this.leave(a);},push:function(a,b,c,d){CT.log.startTimer("push",c+b);var e=this,f=c+this.opts.user,g=this.getVideo(c,this.opts.user,d);if(!this.initChunk){this.initChunk=true;f+="init";}else f+=b;g.recorder&&g.recorder.remember(a.video);if(g.audio.active)CT.stream.util.blobs_to_b64s(a,function(a){CT.log.endTimer("push",f);e._push(a,c,f);});else CT.stream.util.blob_to_b64(a.video,function(a){CT.log.endTimer("push",f);e._push({audio:null,video:a},c,f);});return g;},chat:function(a,b){if(this.opts.chat){b=b||this.opts.user;var c=parseInt(b.slice(4)),d=CT.dom.div(this.opts.chatnames?[CT.dom.span(b,"bold"),CT.dom.pad(),CT.dom.span(a.data)]:a.data);if(isNaN(c))c=b.length;d.style.color=this.opts.chatcolors[c%this.opts.chatcolors.length];this.chatOut.appendChild(d);d.scrollIntoViewIfNeeded();}},say:function(a){this.chatIn.value="";CT.pubsub.publish(this.channel,{action:"chat",data:a});this.chat({data:a});},resetcb:function(a,b){return function(){CT.pubsub.publish(a,{action:"error",data:b});};},update:function(a){CT.log.startTimer("update",a.channel);if(a.message.action=="clip"){var b=this.getVideo(a.channel,a.user);this._update(a.message,b.process,b.requiredInitChunk);if(b.requiredInitChunk){b.receivedInitChunk=b.requiredInitChunk;delete b.requiredInitChunk;}}else if(a.message.action=="chat")this.chat(a.message,a.user);else if(a.message.action=="error"&&this.opts.onerror)this.opts.onerror(a.message.data);CT.log.endTimer("update",a.message.data.length+" "+a.channel+" "+a.user);},getVideo:function(a,b,c){var d=this.channels[a],e=d[b];if(!e){if(!Object.keys(d).length&&this.opts.onstart)this.opts.onstart();e=d[b]=new CT.stream.Video(CT.merge(this.opts.vidopts,{stream:c,onreset:this.resetcb(a,this.opts.user)}));CT.dom.addContent(this.opts.node,e.node);e.requiredInitChunk=!c&&(a+b+"init");}return e;},connect:function(){CT.pubsub.connect(this.opts.host,this.opts.port,this.opts.user);},init:function(a){this.opts=a=CT.merge(a,{host:"localhost",port:8888,user:"user"+Math.floor(100*Math.random()),node:document.body,autoconnect:true,singlechannel:false,onstart:null,onstop:null,onerror:null,wserror:null,chat:true,title:null,vidopts:{},closeunsubs:true,chatnames:false,chatclass:"green",chatcolors:["pink","purple","blue","green","red","orange","yellow"],chatblurs:["say what?","any questions?","what's up?"]});if(a.chat){a.singlechannel=true;this.chatOut=CT.dom.div(null,"abs l0 t50 r0 b15 scrolly pointer "+a.chatclass);var b=this.chatIn=CT.dom.smartField({cb:this.say,blurs:a.chatblurs,classname:"abs l0 b0 r0 h15p w1 p0 m0 noborder"});this.chatOut.onclick=function(){b.focus();};a.title.classList.remove("biggest");a.title.classList.add("bigger");CT.dom.setContent(a.chat,[a.title,this.chatOut,this.chatIn]);}this.channels={};CT.pubsub.set_cb("message",this.update);if(a.closeunsubs)CT.pubsub.set_cb("leave",this.unsub);a.wserror&&CT.pubsub.set_cb("wserror",a.wserror);a.autoconnect&&this.connect();}});;CT.stream.opts={requiresInput:CT.info.android,requestedInput:false,segments:10,chunk:1000,reset:3000,cutoff:30000,width:320,height:240,waiting:[],transcoder:null,setTranscoder:function(a){CT.stream.opts.transcoder=a;},codecs:{av:'video/webm; codecs="vp8,opus"',video:'video/webm; codecs="vp8"',audio:'audio/webm; codecs="opus"'},startWaiting:function(){CT.stream.opts.waiting.forEach(function(a){a.play();});}};CT.stream.opts.mropts={mimeType:CT.stream.opts.codecs.video};;window.CT.storage=window.CT.storage||{};CT.storage={"init":function(a){if(!CT.storage.opts){CT.storage.opts=CT.merge(a,{"backend":localStorage,"json":true,"compress":true});if(CT.storage.opts.compress)CT.require("CT.lib.lz-string",true);}return CT.storage.opts;},"_jsp":function(a){try{return JSON.parse(a);}catch(b){return null;}},"get":function(a){var b=CT.storage.init(),c=b.backend.getItem(a);if(b.compress)c=LZString.decompress(c);return b.json?CT.storage._jsp(c):c;},"set":function(a,b){var c=CT.storage.init();if(c.json)b=JSON.stringify(b);if(c.compress)b=LZString.compress(b);c.backend.setItem(a,b);},"clear":function(){CT.storage.init().backend.clear();}};;window.CT.trans=window.CT.trans||{};CT.trans={_:{vender_prefixes:["-webkit-","-moz-","-ms-","-o-",""],enames:["webkitTransitionEnd","mozTransitionEnd","oTransitionEnd","transitionend"],defaults:{trans:{duration:500,property:"*",ease:"ease-in-out"},rotate:{degrees:180,duration:1000,property:"transform",ease:"linear",prefix:true},translate:{duration:300,property:"transform",ease:"linear",prefix:true,x:0,y:0,z:0},wobble:{axis:"x",radius:50,duration:100},pan:{duration:5000,ease:"linear",x:0,y:0},resize:{duration:300,ease:"linear"},fadeIn:{duration:1600,property:"opacity",value:1},fadeOut:{duration:1600,property:"opacity",value:0},pulse:{wait:1000},invert:{direction:"horizontal",property:"transform",prefix:true}}},setVenderPrefixed:function(a,b,c){for(var d=0;d<CT.trans._.vender_prefixes.length;d++)a.style[CT.trans._.vender_prefixes[d]+b]=c;},trans:function(a){a=CT.merge(a,CT.trans._.defaults.trans);if(typeof a.node=="string")a.node=CT.dom.id(a.node);if(a.node){var b=a.node.style.transition||"",c=a.property+" "+a.duration+"ms "+a.ease,d=(b&&b.indexOf(c)==-1)?(b+", "+c):c;CT.trans.setVenderPrefixed(a.node,"transition",d);}if(a.cb){var e,f=function(){a.node&&CT.trans.setVenderPrefixed(a.node,"transition",b);clearTimeout(e);e=null;if(a.node)CT.trans._.enames.forEach(function(b){a.node.removeEventListener(b,f,false);});a.cb();};if(a.node)CT.trans._.enames.forEach(function(b){a.node.addEventListener(b,f,false);});e=setTimeout(f,a.duration);}if(a.node&&a.property&&a.property!="*")if(a.prefix)CT.trans.setVenderPrefixed(a.node,a.property,a.value);else a.node.style[a.property]=a.value;},invert:function(a,b){b=CT.merge(b,CT.trans._.defaults.invert);b.node=a;b.value="scale"+(b.direction=="horizontal"?"X":"Y")+"(-1)";CT.trans.trans(b);return a;},rotate:function(a,b){b=CT.merge(b,CT.trans._.defaults.rotate);b.node=a;b.value="rotate("+b.degrees+"deg)";if(b.forever)b.cb=function(){b.degrees+=CT.trans._.defaults.rotate.degrees;CT.trans.rotate(a,b);};CT.trans.trans(b);return a;},translate:function(a,b){b=CT.merge(b,CT.trans._.defaults.translate);b.node=a;if(b.axis)b[b.axis]=b.value;b.value="translate3d("+b.x+"px,"+b.y+"px,"+b.z+"px)",CT.trans.trans(b);},wobble:function(a,b){b=CT.merge(b,CT.trans._.defaults.wobble);CT.trans.translate(a,{axis:b.axis,ease:"ease-out",value:b.radius,duration:b.duration,cb:function(){CT.trans.translate(a,{axis:b.axis,ease:"ease-in-out",value:-b.radius,duration:b.duration*2,cb:function(){CT.trans.translate(a,{axis:b.axis,ease:"ease-in",value:0,duration:b.duration});}});}});},pan:function(a,b){b=CT.merge(b,CT.trans._.defaults.pan);var c=function(b){a._vertical=CT.dom.cover(a);b&&setTimeout(b);},d=function(){if(a._vertical==undefined)return c(d);var e=a._vertical?"y":"x",f=a._vertical?"clientHeight":"clientWidth";if(b[e])b[e]=0;else b[e]=a.parentNode[f]-a[f];CT.trans.translate(a,b);},e=new CT.trans.Controller(d);a.onload=function(){setTimeout(e.resume);};CT.onresize(a.onload);b.cb=e.tick;return e;},resize:function(a,b){var c=b.width,d=b.height,e=b.cb;delete b.width;delete b.height;delete b.cb;b.node=a;b=CT.merge(b,CT.trans._.defaults.resize);if(c)CT.trans.trans(CT.merge({property:"width",value:c},b));if(d)CT.trans.trans(CT.merge({property:"height",value:d},b));if(e)CT.trans.trans(CT.merge({cb:e},b));},fadeIn:function(a,b){b=CT.merge(b,CT.trans._.defaults.fadeIn);b.node=a;CT.trans.trans(b);},fadeOut:function(a,b){b=CT.merge(b,CT.trans._.defaults.fadeOut);b.node=a;CT.trans.trans(b);},pulse:function(a,b,c){b=CT.merge(b,CT.trans._.defaults.pulse);var d,e=new CT.trans.Controller(function(){d=!d;if(d)setTimeout(function(){CT.trans.fadeIn(a,b);},b.wait);else CT.trans.fadeOut(a,b);});b.cb=e.tick;if(!c)e.tick();return e;}};CT.trans.Controller=CT.Class({CLASSNAME:"CT.trans.Controller",pause:function(){this._paused=true;},resume:function(){if(this._paused!=false){this._paused=false;this.cb();}},active:function(){return !this._paused;},tick:function(){this.active()&&this.cb();},init:function(a){this.cb=a;}});;window.CT.upload=window.CT.upload||{};CT.upload={"form":function(a,b,c,d){var e=CT.dom.node("","form");e.action="/upload";e.enctype="multipart/form-data";e.method="post";var f=CT.dom.field();f.type="hidden";f.name="uid";f.value=a;var g=CT.dom.field();g.type="hidden";g.name="key";if(b)g.value=b;var h=CT.dom.field();h.type="file";h.name="data";e.appendChild(f);e.appendChild(g);e.appendChild(h);if(c){h.size="10";e.appendChild(c);}if(d)h.size=d;return e;},"submit":function(a,b,c,d){CT.require("CT.lib.aim",true);AIM.submit(a,{'onComplete':function(a){var e=a.charAt(0);if(e=='0')(c||alert)(a.slice(1));else if(d)b(a.slice(2,-2));else b(a.slice(1));}});a.submit();}};;window.CT.video=window.CT.video||{};CT.video={"rawVidTypes":["mp4","ogg","webm"],"player2url":{"google":"video.google.com?docid=","youtube":"www.youtube.com/watch?v=","vimeo":"vimeo.com/","ustream":"www.ustream.tv/recorded/","mp4":"","ogg":"","webm":""},"embed_url":{"youtube":"http://www.youtube.com/embed/","vimeo":"//player.vimeo.com/video/"},"urlFromData":function(a,b){return a?("http://"+CT.video.player2url[a]+b):"";},"getQSParam":function(a,b){var c=a.indexOf(b+"=")+b.length+1,d=a.indexOf("&",c);if(d==-1)d=a.indexOf("#",c);if(d==-1)return a.slice(c);return a.slice(c,d);},"docidFromUrl":function(a){if(a.indexOf("video.google.com")!=-1)return CT.video.getQSParam(a,"docid");else if(a.indexOf("youtube.com")!=-1)return CT.video.getQSParam(a,"v");else if(a.indexOf("vimeo.com")!=-1)return a.slice(a.lastIndexOf('/')+1);else if(a.indexOf("ustream.tv/recorded/")!=-1)return a.split("recorded/")[1].split("?")[0];var b=a.split('.'),c=b[b.length-1];if(CT.video.rawVidTypes.indexOf(c)!=-1)return a.replace("http://","").replace("https://","");return "";},"playerFromUrl":function(a){if(a.indexOf("video.google.com")!=-1)return "google";if(a.indexOf("youtube.com")!=-1)return "youtube";if(a.indexOf("vimeo.com")!=-1)return "vimeo";if(a.indexOf("ustream.tv")!=-1)return "ustream";var b=a.split('.'),c=b[b.length-1];if(CT.video.rawVidTypes.indexOf(c)!=-1)return c;return "";},"videoData":function(a){var b=CT.video.playerFromUrl(a);return b?{player:b,docid:CT.video.docidFromUrl(a)}:null;},"_embed":function(a,b,c){var d="width="+b;if(c)d+=" height="+c;if(a.player=="google")return "<embed "+d+" id=VideoPlayback src=http://video.google.com/googleplayer.swf?docid="+a.docid+"&hl=en&fs=true allowFullScreen=true allowScriptAccess=always type=application/x-shockwave-flash> </embed>";else if(a.player=="youtube"||a.player=="vimeo")return "<iframe src=\""+CT.video.embed_url[a.player]+a.docid+"?html5=1\" "+d+" frameborder=0 webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>";else if(a.player=="ustream")return "<object type=application/x-shockwave-flash data=http://static-cdn1.ustream.tv/swf/live/viewerqos:21.swf "+d+"id=utv"+a.docid+" name=utv"+a.docid+"><param name=flashvars value=autoplay=true&locale=en_US&referrer=http%3A%2F%2Fwww.ustream.tv%2Frecorded%2F"+a.docid+"%3Futm_campaign%3Dustre.am%26utm_source%3Dustre.am%2F%3A44gEy%26utm_medium%3Dsocial%26utm_content%3D20150324210416&autoResize=false&enablejsapi=true&sv=6&volume=1&ts=1427256261325&vid="+a.docid+"&loc="+a.docid+"&hasticket=false><param name=allowfullscreen value=true><param name=allowscriptaccess value=always><param name=bgcolor value=000000><param name=wmode value=transparent></object>";else if(CT.video.rawVidTypes.indexOf(a.player)!=-1)return "<video "+d+" controls><source src=http://"+a.docid+" type=video/"+a.player+"></video>";else alert("unknown video player: "+a.player);},"embed":function(a,b){var c=b?375:400;var d=b?315:335;return CT.video._embed(a,c,d);},"fit":function(a){return CT.video._embed(a,"90%","90%");}};;;window.core=window.core||{};window.core.config=window.core.config||{};core.config={"mobile":{"scale":false},"header":{"logo":"Your Logo","right":[]},"ctmap":{"city":"san francisco","center":{"lat":37.75,"lng":-122.45},"geokeys":["AIzaSyCgnoy4AYjX5qblebjf8HASGyHhnCZYMkQ","AIzaSyDW-yuqN1MeX06PDburFj76rf6LhUoSuOc"],"custom_kinds":["eviction","fire","lord","murder"],"types":["building","owner","eviction","fire"],"queries":[{modelName:"owner",order:"-building.owner"},{modelName:"building",order:"-parcel.building"},{modelName:"building",order:"-eviction.building"},{modelName:"fire",order:"-persons"},{modelName:"policemurder"}],"live":{"port":8888,"zoom":18,"interval":5000,"resolution":1000,"scouts":["default"],"obstacles":["default"],"objectives":["default","red"]}},"log":{"exclude":[],"include":[]},"css":[]};;window.core.util=window.core.util||{};core.util={};CT.log.grep(core.config.log.include,core.config.log.exclude);;;window.map=window.map||{};window.map.live=window.map.live||{};window.map.live.core=window.map.live.core||{};map.live.core={_:{host:location.hostname,port:core.config.ctmap.live.port,zoom:core.config.ctmap.live.zoom,interval:core.config.ctmap.live.interval,resolution:core.config.ctmap.live.resolution,scoutz:core.config.ctmap.live.scouts,obstaclez:core.config.ctmap.live.obstacles,objectivez:core.config.ctmap.live.objectives,pulse:{interval:1000,iterations:10},rotation:{retry:5,interval:200,duration:100},arrow:{degs:[-45,0,45,-90,"default",90,-135,180,135],mod:{red:null,green:null}}},diff:function(a,b){return a.coords.latitude!=b.coords.latitude||a.coords.longitude!=b.coords.longitude;},bigDiff:function(a,b){var c=a.coords,d=b.coords,e=core.util._.resolution;return(Math.floor(c.latitude*e)/e)!=(Math.floor(d.latitude*e)/e)||(Math.floor(c.longitude*e)/e)!=(Math.floor(d.longitude*e)/e);},strip:function(a){return a.coords&&{lat:a.coords.latitude,lng:a.coords.longitude}||{lat:a.lat(),lng:a.lng()};},rotate:function(a,b){var c=map.live.core._.rotation.retry;var d=function(){var e=CT.dom.attr("src",a.url||a,true);if(e)CT.trans.rotate(e,{degrees:b,duration:map.live.core._.rotation.duration});else if(c){c-=1;CT.log("rotate(): failed to find node; retrying; "+c+" retries left");setTimeout(d,map.live.core._.rotation.interval);}};d();}};;CT.setVal("mapkey",CT.data.choice(core.config.ctmap.geokeys));CT.require("CT.map",true);window.map.live.Map=window.map.live.Map||{};map.live.Map=CT.Class({CLASSNAME:"map.live.Map",_:{obstacles:0,objectives:0,panics:{},buttons:{},arrows:function(a){var b=map.live.core._,c=this,d=b.arrow.mod[a];if(!d){var e=CT.dom.div(),f=[];b.arrow.degs.forEach(function(b,g){var h,i,j=(b!="default")?b:0;if(b=="default")h=(a=="green")?"default":"red";else h=a+"_arrow";i=CT.dom.img("/img/map/live/objective/"+h+".png",null,function(){var a=c._.buttons.objective;a.src="/img/map/live/objective/"+h+".png";CT.trans.rotate(a,{degrees:j});c.objective(h,j);d.hide();});e.appendChild(i);if(g==2||g==5)e.appendChild(CT.dom.br());if(j){i._rot=j;f.push(i);}});d=b.arrow.mod[a]=new CT.modal.Modal({center:false,noClose:true,content:e,innerClass:"full noflow",transition:"slide",slide:{origin:"topright"}});d.on.show=function(){f.forEach(function(a){CT.trans.rotate(a.firstChild,{degrees:a._rot});});};}d.show();},select:function(a){var b=this._,c=b.buttons,d=c[a],e=this[a],f=b[a+"Drop"]=b[a+"Drop"]||new CT.Drop({shiftV:4,translucent:true,constrained:false,anchor:d,parent:this.opts.node,content:map.live.core._[a+"z"].map(function(f){var g="/img/map/live/"+a+"/"+f+".png";return CT.dom.img(g,"hoverglow roundest block",function(){if(a=="scout"){CT.dom.hide(c.scout);CT.dom.show(c.obstacle,"inline");CT.dom.show(c.objective,"inline");CT.dom.show(c.peep,"inline");}else{d.src=g;if(a=="objective"){var h=f=="default";if(h||f=="red")return b.arrows(h?"green":"red");else{b.objRotation=null;CT.trans.rotate(d,{degrees:0});}}}e(f);});})});f.slide();},drop:function(a){var b=this._;if(b.mode){var c={action:"add",data:{position:a.latLng,icon:b[b.mode]}},d=b.mode+"s";c.data.id=b[d];b[d]+=1;if(b.mode=="objective"&&b.objRotation)c.data.rotation=b.objRotation;CT.pubsub.publish(this.name+"_"+b.mode,c);}},remove:function(a,b){var c="remove";if(a.split("_")[1]=="scout")c=this._.panics[b]?"unpanic":"panic";CT.pubsub.publish(a,{action:c,data:{key:b}});},resize:function(){this._.map.resizeMarkers(CT.align.height()*14/100);}},update:function(a){var b,c,d=a.message,e,f=this._,g=f.panics,h=a.channel.split("_")[1],i=a.user+a.channel+(d.data.id||"");if(d.action=="panic"){e=g[d.data.key]=f.map.getMarker(d.data.key);e._normal=e.getIcon();e.setIcon("/img/map/live/scout/panic.png");}else if(d.action=="unpanic"){g[d.data.key].setIcon(g[d.data.key]._normal);delete g[d.data.key];}else if(d.action=="remove")f.map.removeMarker(d.data.key);else if(d.action=="move"){f.map.setMarker(d.data);if(d.data.rotation)map.live.core.rotate(f.map.getMarker(d.data.key).getIcon(),d.data.rotation);}else if(d.action=="add"){c=CT.align.height()*14/100;b={key:i,optimized:false,icon:{url:"/img/map/live/"+h+(d.data.icon?("/"+d.data.icon):"")+".png",size:new google.maps.Size(c,c)},position:d.data.position,animation:google.maps.Animation.DROP,listeners:{dblclick:function(b){f.map.getMarker(i).cancelInfo();f.remove(a.channel,i);}}};if(h=="scout"){b.infoDelay=500;b.info=CT.dom.div([CT.dom.img("/img/map/live/zap.png","pointer hoverglow",function(){if(!g[d.data.key])f.remove(a.channel,i);CT.pubsub.pm(a.user,"zap");f.map.getMarker(i).hideInfo();}),"really zap???"]);}else{if(h=="objective"&&d.data.rotation){b.icon.url+="#"+a.user+"|"+d.data.id;map.live.core.rotate(b.icon.url,d.data.rotation);}b.draggable=true;b.listeners.dragend=function(b){var c={key:i,position:b.latLng};if(d.data.rotation)c.rotation=d.data.rotation;CT.pubsub.publish(a.channel,{action:"move",data:c});};}f.map.setMarker(b);}},leave:function(a,b){var c=b+a;if(c in this._.panics)this.pulse(c);else this._.map.removeMarker(c);},pulse:function(a){var b,c=0,d=map.live.core._.pulse,e=this._,f=e.panics[a],g=function(){c+=1;if(c<d.iterations){b=(c%2)?"default":"panic";f.setIcon("/img/map/live/scout/"+b+".png");setTimeout(g,d.interval);}else e.map.removeMarker(a);};delete e.panics[a];g();},peep:function(){this._.peeper=this._.peeper||new CT.modal.Modal({center:false,className:"basicpopup bigger vslide h3-10",transition:"slide",slide:{origin:"bottom"},content:CT.dom.div(["Who else is lurking around?",CT.dom.iframe("https://fzn.party/stream/widget.html#"+this.name+"_zoom_chat","w1 bw0")],"h1 noflow")});this._.peeper.showHide();},selectScout:function(){this._.select("scout");},selectObstacle:function(){this._.select("obstacle");},selectObjective:function(){this._.select("objective");},tick:function(a){this._.map.panTo(a);CT.pubsub.publish(this.name+"_scout",{action:"add",data:{icon:this._.scout,position:a}});},scout:function(a){this._.scout=a;this.opts.controller.tick(this);setInterval(this._.tick,map.live.core._.interval);},obstacle:function(a){this._.obstacle=a;this._.mode="obstacle";},objective:function(a,b){this._.objective=a;this._.objRotation=b;this._.mode="objective";},initStream:function(){var a=this.name+"_scout";CT.pubsub.set_autohistory(true,[a],true);CT.pubsub.subscribe(a);CT.pubsub.subscribe(this.name+"_obstacle");CT.pubsub.subscribe(this.name+"_objective");},initContent:function(){this.map=CT.dom.div(null,"abs full",this.name+"map");this._.buttons.scout=CT.dom.img({noanchor:true,onclick:this.selectScout,src:"/img/map/live/scout/default.png",imgid:name+"scout",imgclass:"hoverglow roundest"});this._.buttons.objective=CT.dom.img({noanchor:true,onclick:this.selectObjective,src:"/img/map/live/objective/default.png",imgid:name+"objective",imgclass:"hoverglow roundest hidden"});this._.buttons.obstacle=CT.dom.img({noanchor:true,onclick:this.selectObstacle,src:"/img/map/live/obstacle/default.png",imgid:name+"obstacle",imgclass:"hoverglow roundest hidden"});this._.buttons.peep=CT.dom.img({noanchor:true,onclick:this.peep,src:"/img/map/live/peep.png",imgid:name+"peep",imgclass:"hoverglow roundest hidden"});this.buttons=CT.dom.div([this._.buttons.scout,this._.buttons.objective,this._.buttons.obstacle,this._.buttons.peep],"abs ctl whitebacktrans",name+"buttons");CT.dom.setContent(this.opts.node,[this.map,this.buttons]);this._.map=new CT.map.Map({zoom:map.live.core._.zoom,node:this.map,listeners:{click:this._.drop}});CT.onresize(this._.resize);},init:function(a){this.opts=a;this.name=a.name;this.initContent();this.initStream();}});;window.map.live.Controller=window.map.live.Controller||{};map.live.Controller=CT.Class({CLASSNAME:"map.live.Controller",_:{maps:{},tickers:[],tick:function(){var a,b=this._;navigator.geolocation.getCurrentPosition(function(c){if(!b.position||map.live.core.diff(b.position,c)){b.position=c;a=map.live.core.strip(b.position);b.tickers.forEach(function(b){b.tick(a);});}},null,{enableHighAccuracy:true});},url:function(a){var b=CT.dom.id("secretinput");b.value=location.protocol+"//"+location.host+location.pathname+"#"+a;b.select();document.execCommand("copy")&&alert("link saved");},clip:function(a){var b=this._.url;return CT.dom.img("/img/map/live/clip.png",null,function(){b(a);});}},tick:function(a){if(this._.tickers.length)this._.position=null;else setInterval(this._.tick,map.live.core._.interval);this._.tickers.push(a);},pm:function(a){location="http://maps.google.com";},leave:function(a,b){var c=a.split("_"),d=c[0],e=c[1];if(e=="scout")this._.maps[d].leave(a,b);},update:function(a){this._.maps[a.channel.split("_")[0]].update(a);},join:function(a){CT.trans.translate("parties",{x:-155});this._.maps[a]=new map.live.Map({name:a,controller:this,node:this.slider.add(a,true)});},initStream:function(){CT.pubsub.set_cb("pm",this.pm);CT.pubsub.set_cb("leave",this.leave);CT.pubsub.set_cb("message",this.update);CT.pubsub.connect(map.live.core._.host,map.live.core._.port);},initRemote:function(){var a=this;CT.dom.id("remote").onclick=function(){var b=a.remote=a.remote||new CT.modal.Prompt({clear:true,noClose:true,cb:a.join,transition:"slide"});b.showHide();};},init:function(a){this.slider=CT.panel.slider([],"parties","maps",this._.clip);this.initStream();this.initRemote();var b=location.hash.slice(1);if(b){location.hash="";this.join(b);}}});;CT.onload(function(){new map.live.Controller();});;</script> </head><body><input id="secretinput" class="transparent"><div id="maps" class="abs full t0"></div><img src="/img/map/live/remote.png" id="remote" class="abs ctr hoverglow roundest"><div id="parties" class="abs bigger"></div><noscript><div style="position: absolute; left:0px; top:0px;"> This site requires Javascript to function properly. To enable Javascript in your browser, please follow <a href="http://www.google.com/support/bin/answer.py?answer=23852">these instructions</a>. Thank you, and have a nice day. </div></noscript></body></html>